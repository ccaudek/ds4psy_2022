[["index.html", "Data Science per psicologi Prefazione", " Data Science per psicologi Corrado Caudek 2022-01-17 Prefazione Data Science per psicologi contiene il materiale delle lezioni dell’insegnamento di Psicometria B000286 (A.A. 2021/2022) rivolto agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze. Psicometria si propone di fornire agli studenti un’introduzione all’analisi dei dati in psicologia. Le conoscenze/competenze che verranno sviluppate in questo insegnamento sono quelle della Data science, ovvero un insieme di conoscenze/competenze che si pongono all’intersezione tra statistica (ovvero, richiedono la capacità di comprendere teoremi statistici) e informatica (ovvero, richiedono la capacità di sapere utilizzare un software). "],["la-psicologia-e-la-data-science.html", "La psicologia e la Data science", " La psicologia e la Data science Sembra sensato spendere due parole su un tema che è importante per gli studenti: quello indicato dal titolo di questo Capitolo. È ovvio che agli studenti di psicologia la statistica non piace. Se piacesse, forse studierebbero Data science e non psicologia; ma non lo fanno. Di conseguenza, gli studenti di psicologia si chiedono: “perché dobbiamo perdere tanto tempo a studiare queste cose quando in realtà quello che ci interessa è tutt’altro?” Questa è una bella domanda. C’è una ragione molto semplice che dovrebbe farci capire perché la Data science è così importante per la psicologia. Infatti, a ben pensarci, la psicologia è una disciplina intrinsecamente statistica, se per statistica intendiamo quella disciplina che studia la variazione delle caratteristiche degli individui nella popolazione. La psicologia studia gli individui ed è proprio la variabilità inter- e intra-individuale ciò che vogliamo descrivere e, in certi casi, predire. In questo senso, la psicologia è molto diversa dall’ingegneria, per esempio. Le proprietà di un determinato ponte sotto certe condizioni, ad esempio, sono molto simili a quelle di un altro ponte, sotto le medesime condizioni. Quindi, per un ingegnere la statistica è poco importante: le proprietà dei materiali sono unicamente dipendenti dalla loro composizione e restano costanti. Ma lo stesso non può dirsi degli individui: ogni individuo è unico e cambia nel tempo. E le variazioni tra gli individui, e di un individuo nel tempo, sono l’oggetto di studio proprio della psicologia: è dunque chiaro che i problemi che la psicologia si pone sono molto diversi da quelli affrontati, per esempio, dagli ingegneri. Questa è la ragione per cui abbiamo tanto bisogno della Data science in psicologia: perché la Data science ci consente di descrivere la variazione e il cambiamento. E queste sono appunto le caratteristiche di base dei fenomeni psicologici. Sono sicuro che, leggendo queste righe, a molti studenti sarà venuta in mente la seguente domanda: perché non chiediamo a qualche esperto di fare il “lavoro sporco” (ovvero le analisi statistiche) per noi, mentre noi (gli psicologi) ci occupiamo solo di ciò che ci interessa, ovvero dei problemi psicologici slegati dai dettagli “tecnici” della Data science? La risposta a questa domanda è che non è possibile progettare uno studio psicologico sensato senza avere almeno una comprensione rudimentale della Data science. Le tematiche della Data science non possono essere ignorate né dai ricercatori in psicologia né da coloro che svolgono la professione di psicologo al di fuori dell’Università. Infatti, anche i professionisti al di fuori dall’università non possono fare a meno di leggere la letteratura psicologica più recente: il continuo aggiornamento delle conoscenze è infatti richiesto dalla deontologia della professione. Ma per potere fare questo è necessario conoscere un bel po’ di Data science! Basta aprire a caso una rivista specialistica di psicologia per rendersi conto di quanto ciò sia vero: gli articoli che riportano i risultati delle ricerche psicologiche sono zeppi di analisi statistiche e di modelli formali. E la comprensione della letteratura psicologica rappresenta un requisito minimo nel bagaglio professionale dello psicologo. Le considerazioni precedenti cercano di chiarire il seguente punto: la Data science non è qualcosa da studiare a malincuore, in un singolo insegnamento universitario, per poi poterla tranquillamente dimenticare. Nel bene e nel male, gli psicologi usano gli strumenti della Data science in tantissimi ambiti della loro attività professionale: in particolare quando costruiscono, somministrano e interpretano i test psicometrici. È dunque chiaro che possedere delle solide basi di Data science è un tassello imprescindibile del bagaglio professionale dello psicologo. In questo insegnamento verrano trattati i temi base della Data science e verrà adottato un punto di vista bayesiano, che corrisponde all’approccio più recente e sempre più diffuso in psicologia. "],["come-studiare.html", "Come studiare", " Come studiare Il giusto metodo di studio per prepararsi all’esame di Psicometria è quello di seguire attivamente le lezioni, assimilare i concetti via via che essi vengono presentati e verificare in autonomia le procedure presentate a lezione. Incoraggio gli studenti a farmi domande per chiarire ciò che non è stato capito appieno. Incoraggio gli studenti a utilizzare i forum attivi su Moodle e, soprattutto, a svolgere gli esercizi proposti su Moodle. I problemi forniti su Moodle rappresentano il livello di difficoltà richiesto per superare l’esame e consentono allo studente di comprendere se le competenze sviluppate fino a quel punto sono sufficienti rispetto alle richieste dell’esame. La prima fase dello studio, che è sicuramente individuale, è quella in cui è necessario acquisire le conoscenze teoriche relative ai problemi che saranno presentati all’esame. La seconda fase di studio, che può essere facilitata da scambi con altri e da incontri di gruppo, porta ad acquisire la capacità di applicare le conoscenze: è necessario capire come usare un software (\\(\\textsf{R}\\)) per applicare i concetti statistici alla specifica situazione del problema che si vuole risolvere. Le due fasi non sono però separate: il saper fare molto spesso ci aiuta a capire meglio. "],["sviluppare-un-metodo-di-studio-efficace.html", "Sviluppare un metodo di studio efficace", " Sviluppare un metodo di studio efficace Avendo insegnato molte volte in passato un corso introduttivo di analisi dei dati ho notato nel corso degli anni che gli studenti con l’atteggiamento mentale che descriverò qui sotto generalmente ottengono ottimi risultati. Alcuni studenti sviluppano naturalmente questo approccio allo studio, ma altri hanno bisogno di fare uno sforzo per maturarlo. Fornisco qui sotto una breve descrizione del “metodo di studio” che, nella mia esperienza, è il più efficace per affrontare le richieste di questo insegnamento. Dedicate un tempo sufficiente al materiale di base, apparentemente facile; assicuratevi di averlo capito bene. Cercate le lacune nella vostra comprensione. Leggere presentazioni diverse dello stesso materiale (in libri o articoli diversi) può fornire nuove intuizioni. Gli errori che facciamo sono i nostri migliori maestri. Istintivamente cerchiamo di dimenticare subito i nostri errori. Ma il miglior modo di imparare è apprendere dagli errori che commettiamo. In questo senso, una soluzione corretta è meno utile di una soluzione sbagliata. Quando commettiamo un errore questo ci fornisce un’informazione importante: ci fa capire qual è il materiale di studio sul quale dobbiamo ritornare e che dobbiamo capire meglio. C’è ovviamente un aspetto “psicologico” nello studio. Quando un esercizio o problema ci sembra incomprensibile, la cosa migliore da fare è dire: “mi arrendo”, “non ho idea di cosa fare!”. Questo ci rilassa: ci siamo già arresi, quindi non abbiamo niente da perdere, non dobbiamo più preoccuparci. Ma non dobbiamo fermarci qui. Le cose “migliori” che faccio (se ci sono) le faccio quando non ho voglia di lavorare. Alle volte, quando c’è qualcosa che non so fare e non ho idea di come affontare, mi dico: “oggi non ho proprio voglia di fare fatica”, non ho voglia di mettermi nello stato mentale per cui “in 10 minuti devo risolvere il problema perché dopo devo fare altre cose”. Però ho voglia di divertirmi con quel problema e allora mi dedico a qualche aspetto “marginale” del problema, che so come affrontare, oppure considero l’aspetto più difficile del problema, quello che non so come risolvere, ma invece di cercare di risolverlo, guardo come altre persone hanno affrontato problemi simili, opppure lo stesso problema in un altro contesto. Non mi pongo l’obiettivo “risolvi il problema in 10 minuti”, ma invece quello di farmi un’idea “generale” del problema, o quello di capire un caso più specifico e più semplice del problema. Senza nessuna pressione. Infatti, in quel momento ho deciso di non lavorare (ovvero, di non fare fatica). Va benissimo se “parto per la tangente”, ovvero se mi metto a leggere del materiale che sembra avere poco a che fare con il problema centrale (le nostre intuizioni e la nostra curiosità solitamente ci indirizzano sulla strada giusta). Quando faccio così, molto spesso trovo la soluzione del problema che mi ero posto e, paradossalmente, la trovo in un tempo minore di quello che, in precedenza, avevo dedicato a “lavorare” al problema. Allora perché non faccio sempre così? C’è ovviamente l’aspetto dei “10 minuti” che non è sempre facile da dimenticare. Sotto pressione, possiamo solo agire in maniera automatica, ovvero possiamo solo applicare qualcosa che già sappiamo fare. Ma se dobbiamo imparare qualcosa di nuovo, la pressione è un impedimento. È utile farsi da soli delle domande sugli argomenti trattati, senza limitarsi a cercare di risolvere gli esercizi che vengono assegnati. Quando studio qualcosa mi viene in mente: “se questo è vero, allora deve succedere quest’altra cosa”. Allora verifico se questo è vero, di solito con una simulazione. Se i risultati della simulazione sono quelli che mi aspetto, allora vuol dire che ho capito. Se i risultati sono diversi da quelli che mi aspettavo, allora mi rendo conto di non avere capito e ritorno indietro a studiare con più attenzione la teoria che pensavo di avere capito – e ovviamente mi rendo conto che c’era un aspetto che avevo frainteso. Questo tipo di verifica è qualcosa che dobbiamo fare da soli, in prima persona: nessun altro può fare questo al posto nostro. Non aspettatevi di capire tutto la prima volta che incontrate un argomento nuovo.1 È utile farsi una nota mentalmente delle lacune nella vostra comprensione e tornare su di esse in seguito per carcare di colmarle. L’atteggiamento naturale, quando non capiamo i dettagli di qualcosa, è quello di pensare: “non importa, ho capito in maniera approssimativa questo punto, non devo preoccuparmi del resto”. Ma in realtà non è vero: se la nostra comprensione è superficiale, quando il problema verrà presentato in una nuova forma, non riusciremo a risolverlo. Per cui i dubbi che ci vengono quando studiamo qualcosa sono il nostro alleato più prezioso: ci dicono esattamente quali sono gli aspetti che dobbiamo approfondire per potere migliorare la nostra preparazione. È utile sviluppare una visione d’insieme degli argomenti trattati, capire l’obiettivo generale che si vuole raggiungere e avere chiaro il contributo che i vari pezzi di informazione forniscono al raggiungimento di tale obiettivo. Questa organizzazione mentale del materiale di studio facilita la comprensione. È estremamente utile creare degli schemi di ciò che si sta studiando. Non aspettate che sia io a fornirvi un riepilogo di ciò che dovete imparare: sviluppate da soli tali schemi e tali riassunti. Tutti noi dobbiamo imparare l’arte di trovare le informazioni, non solo nel caso di questo insegnamento. Quando vi trovate di fronte a qualcosa che non capite, o ottenete un oscuro messaggio di errore da un software, ricordatevi: “Google is your friend”! Corrado Caudek Marzo 2022 References "],["concetti-chiave.html", "Capitolo 1 Concetti chiave", " Capitolo 1 Concetti chiave La data science si pone all’intersezione tra statistica e informatica. La statistica è un insieme di metodi ugilizzati per estrarre informazioni dai dati; l’informatica implementa tali procedure in un software. In questo Capitolo vengono introdotti i concetti fondamentali. "],["popolazioni-e-campioni.html", "1.1 Popolazioni e campioni", " 1.1 Popolazioni e campioni Popolazione. L’analisi dei dati inizia con l’individuazione delle unità portatrici di informazioni circa il fenomeno di interesse. Si dice popolazione (o universo) l’insieme \\(\\Omega\\) delle entità capaci di fornire informazioni sul fenomeno oggetto dell’indagine statistica. Possiamo scrivere \\(\\Omega = \\{\\omega_i\\}_{i=1, \\dots, n}= \\{\\omega_1, \\omega_2, \\dots, \\omega_n\\}\\), oppure \\(\\Omega = \\{\\omega_1, \\omega_2, \\dots \\}\\) nel caso di popolazioni finite o infinite, rispettivamente. L’obiettivo principale della ricerca psicologica è conoscere gli esiti psicologici e i loro fattori trainanti nella popolazione. Questo è l’obiettivo delle sperimentazioni psicologiche e della maggior parte degli studi osservazionali in psicologia. È quindi necessario essere molto chiari sulla popolazione a cui si applicano i risultati della ricerca. La popolazione può essere ben definita, ad esempio, tutte le persone che si trovavano nella città di Hiroshima al momento dei bombardamenti atomici e sono sopravvissute al primo anno, o può essere ipotetica, ad esempio, tutte le persone depresse che hanno subito o saranno sottoporsi ad un intervento di psicoterapia. Il ricercatore deve sempre essere in grado di determinare se un soggetto appartiene alla popolazione oggetto di interesse. Una sottopopolazione è una popolazione in sé e per sé che soddisfa proprietà ben definite. Negli esempi precedenti, potremmo essere interessati alla sottopopolazione di uomini di età inferiore ai 20 anni o di pazienti depressi sottoposti ad uno specifico intervento psicologico. Molte questioni scientifiche riguardano le differenze tra sottopopolazioni; ad esempio, confrontando i gruppi con o senza psicoterapia per determinare se il trattamento è vantaggioso. I modelli di regressione, introdotti nel Capitolo 15 riguardano le sottopopolazioni, in quanto stimano il risultato medio per diversi gruppi (sottopopolazioni) definiti dalle covariate. Campione. Gli elementi \\(\\omega_i\\) dell’insieme \\(\\Omega\\) sono detti unità statistiche. Un sottoinsieme della popolazione, ovvero un insieme di elementi \\(\\omega_i\\), viene chiamato campione. Ciascuna unità statistica \\(\\omega_i\\) (abbreviata con u.s.) è portatrice dell’informazione che verrà rilevata mediante un’operazione di misurazione. Un campione è dunque un sottoinsieme della popolazione utilizzato per conoscere tale popolazione. A differenza di una sottopopolazione definita in base a chiari criteri, un campione viene generalmente selezionato tramite un procedura casuale. Il campionamento casuale consente allo scienziato di trarre conclusioni sulla popolazione e, soprattutto, di quantificare l’incertezza sui risultati. I campioni di un sondaggio sono esempi di campioni casuali, ma molti studi osservazionali non sono campionati casualmente. Possono essere campioni di convenienza, come coorti di studenti in un unico istituto, che consistono di tutti gli studenti sottoposti ad un certo intervento psicologico in quell’istituto. Indipendentemente da come vengono ottenuti i campioni, il loro uso al fine di conoscere una popolazione target significa che i problemi di rappresentatività sono inevitabili e devono essere affrontati. "],["variabili-e-costanti.html", "1.2 Variabili e costanti", " 1.2 Variabili e costanti Definiamo variabile statistica la proprietà (o grandezza) che è oggetto di studio nell’analisi dei dati. Una variabile è una proprietà di un fenomeno che può essere espressa in più valori sia numerici sia categoriali. Il termine “variabile” si contrappone al termine “costante” che descrive una proprietà invariante di tutte le unità statistiche. Si dice modalità ciascuna delle varianti con cui una variabile statistica può presentarsi. Definiamo insieme delle modalità di una variabile statistica l’insieme \\(M\\) di tutte le possibili espressioni con cui la variabile può manifestarsi. Le modalità osservate e facenti parte del campione si chiamano dati (si veda la Tabella 1.1). Esempio 1.1 Supponiamo che il fenomeno studiato sia l’intelligenza. In uno studio, la popolazione potrebbe corrispondere all’insieme di tutti gli italiani adulti. La variabile considerata potrebbe essere il punteggio del test standardizzato WAIS-IV. Le modalità di tale variabile potrebbero essere \\(112, 92, 121, \\dots\\). Tale variabile è di tipo quantitativo discreto. Esempio 1.2 Supponiamo che il fenomeno studiato sia il compito Stroop. La popolazione potrebbe corrispondere all’insieme dei bambini dai 6 agli 8 anni. La variabile considerata potrebbe essere il reciproco dei tempi di reazione in secondi. Le modalità di tale variabile potrebbero essere \\(1 / 2.35, 1/ 1.49, 1/2.93, \\dots\\). La variabile è di tipo quantitativo continuo. Esempio 1.3 Supponiamo che il fenomeno studiato sia il disturbo di personalità. La popolazione potrebbe corrispondere all’insieme dei detenuti nelle carceri italiane. La variabile considerata potrebbe essere l’assessment del disturbo di personalità tramite interviste cliniche strutturate. Le modalità di tale variabile potrebbero essere i Cluster A, Cluster B, Cluster C descritti dal DSM-V. Tale variabile è di tipo qualitativo. 1.2.1 Variabili casuali Il termine variabile usato nella statistica è equivalente al termine variabile casuale usato nella teoria delle probabilità. Lo studio dei risultati degli interventi psicologici è lo studio delle variabili casuali che misurano questi risultati. Una variabile casuale cattura una caratteristica specifica degli individui nella popolazione e i suoi valori variano tipicamente tra gli individui. Ogni variabile casuale può assumere in teoria una gamma di valori sebbene, in pratica, osserviamo un valore specifico per ogni individuo. Quando faremo riferiremo alle variabili casuali considerate in termini generali useremo lettere maiuscole come \\(X\\) e \\(Y\\); quando faremo riferimento ai valori che una variabile casuale assume in determinate circostanze useremo lettere minuscole come \\(x\\) e \\(y\\). 1.2.2 Variabili indipendenti e variabili dipendenti Un primo compito fondamentale in qualsiasi analisi dei dati è l’identificazione delle variabili dipendenti (\\(Y\\)) e delle variabili indipendenti (\\(X\\)). Le variabili dipendenti sono anche chiamate variabili di esito o di risposta e le variabili indipendenti sono anche chiamate predittori o covariate. Ad esempio, nell’analisi di regressione, che esamineremo in seguito, la domanda centrale è quella di capire come \\(Y\\) cambia al variare di \\(X\\). Più precisamente, la domanda che viene posta è: se il valore della variabile indipendente \\(X\\) cambia, qual è la conseguenza per la variabile dipendente \\(Y\\)? In parole povere, le variabili indipendenti e dipendenti sono analoghe a “cause” ed “effetti”, laddove le virgolette usate qui sottolineano che questa è solo un’analogia e che la determinazione delle cause può avvenire soltanto mediante l’utilizzo di un appropriato disegno sperimentale e di un’adeguata analisi statistica. Se una variabile è una variabile indipendente o dipendente dipende dalla domanda di ricerca. A volte può essere difficile decidere quale variabile è dipendente e quale è indipendente, in particolare quando siamo specificamente interessati ai rapporti di causa/effetto. Ad esempio, supponiamo di indagare l’associazione tra esercizio fisico e insonnia. Vi sono evidenze che l’esercizio fisico (fatto al momento giusto della giornata) può ridurre l’insonnia. Ma l’insonnia può anche ridurre la capacità di una persona di fare esercizio fisico. In questo caso, dunque, non è facile capire quale sia la causa e quale l’effetto, quale sia la variabile dipendente e quale la variabile indipendente. La possibilità di identificare il ruolo delle variabili (dipendente/indipendente) dipende dalla nostra comprensione del fenomeno in esame. Esempio 1.4 Uno psicologo convoca 120 studenti universitari per un test di memoria. Prima di iniziare l’esperimento, a metà dei soggetti viene detto che si tratta di un compito particolarmente difficile; agli altri soggetti non viene data alcuna indicazione. Lo psicologo misura il punteggio nella prova di memoria di ciascun soggetto. In questo esperimento, la variabile indipendente è l’informazione sulla difficoltà della prova. La variabile indipendente viene manipolata dallo sperimentatore assegnando i soggetti (di solito in maniera causale) o alla condizione (modalità) “informazione assegnata” o “informazione non data”. La variabile dipendente è ciò che viene misurato nell’esperimento, ovvero il punteggio nella prova di memoria di ciascun soggetto. 1.2.3 La matrice dei dati Le realizzazioni delle variabili esaminate in una rilevazione statistica vengono organizzate in una matrice dei dati. Le colonne della matrice dei dati contengono gli insiemi dei dati individuali di ciascuna variabile statistica considerata. Ogni riga della matrice contiene tutte le informazioni relative alla stessa unità statistica. Una generica matrice dei dati ha l’aspetto seguente: \\[ D_{m,n} = \\begin{pmatrix} \\omega_1 &amp; a_{1} &amp; b_{1} &amp; \\cdots &amp; x_{1} &amp; y_{1}\\\\ \\omega_2 &amp; a_{2} &amp; b_{2} &amp; \\cdots &amp; x_{2} &amp; y_{2}\\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\\\ \\omega_n &amp; a_{n} &amp; b_{n} &amp; \\cdots &amp; x_{n} &amp; y_{n} \\end{pmatrix} \\] dove, nel caso presente, la prima colonna contiene il nome delle unità statistiche, la seconda e la terza colonna si riferiscono a due mutabili statistiche (variabili categoriali; \\(A\\) e \\(B\\)) e ne presentano le modalità osservate nel campione mentre le ultime due colonne si riferiscono a due variabili statistiche (\\(X\\) e \\(Y\\)) e ne presentano le modalità osservate nel campione. Generalmente, tra le unità statistiche \\(\\omega_i\\) non esiste un ordine progressivo; l’indice attribuito alle unità statistiche nella matrice dei dati si riferisce semplicemente alla riga che esse occupano. "],["parametri-e-modelli.html", "1.3 Parametri e modelli", " 1.3 Parametri e modelli Ogni variabile casuale ha una distribuzione che descrive la probabilità che la variabile assuma qualsiasi valore in un dato intervallo.2 Senza ulteriori specificazioni, una distribuzione può fare riferimento a un’intera famiglia di distribuzioni. I parametri, tipicamente indicati con lettere greche come \\(\\mu\\) e \\(\\alpha\\), ci permettono di specificare di quale membro della famiglia stiamo parlando. Quindi, si può parlare di una variabile casuale con una distribuzione Normale, ma se viene specificata la media \\(\\mu\\) = 100 e la varianza \\(\\sigma^2\\) = 15, viene individuata una specifica distribuzione Normale – nell’esempio, la distribuzione del quoziente di intelligenza. I metodi statistici parametrici specificano la famiglia delle distribuzioni e quindi utilizzano i dati per individuare, stimando i parametri, una specifica distribuzione all’interno della famiglia di distribuzioni ipotizzata. Se \\(f\\) è la PDF di una variabile casuale \\(Y\\), l’interesse può concentrarsi sulla sua media e varianza. Nell’analisi di regressione, ad esempio, cerchiamo di spiegare come i parametri di \\(f\\) dipendano dalle covariate \\(X\\). Nella regressione lineare classica, assumiamo che \\(Y\\) abbia una distribuzione normale con media \\(\\mu = \\E(Y)\\), e stimiamo come \\(\\E(Y)\\) dipenda da \\(X\\). Poiché molti esiti psicologici non seguono una distribuzione normale, verranno introdotte distribuzioni più appropriate per questi risultati. I metodi non parametrici, invece, non specificano una famiglia di distribuzioni per \\(f\\). In queste dispense faremo riferimento a metodi non parametrici quando discuteremo della statistica descrittiva. Il termine modello è onnipresente in statistica e nella data science. Il modello statistico include le ipotesi e le specifiche matematiche relative alla distribuzione della variabile casuale di interesse. Il modello dipende dai dati e dalla domanda di ricerca, ma raramente è unico; nella maggior parte dei casi, esiste più di un modello che potrebbe ragionevolmente usato per affrontare la stessa domanda di ricerca e avendo a disposizione i dati osservati. Nella previsione delle aspettative future dei pazienti depressi che discuteremo in seguito (Zetsche, Bürkner, and Renneberg 2019), ad esempio, la specifica del modello include l’insieme delle covariate candidate, l’espressione matematica che collega i predittori con le aspattative future e qualsiasi ipotesi sulla distribuzione della variabile dipendente. La domanda di cosa costituisca un buon modello è una domanda su cui torneremo ripetutamente in questo insegnamento. References "],["effetto.html", "1.4 Effetto", " 1.4 Effetto L’effetto è una qualche misura dei dati. Dipende dal tipo di dati e dal tipo di test statistico che si vuole utilizzare. Ad esempio, se viene lanciata una moneta 100 volte e esce testa 66 volte, l’effetto sarà 66/100. Diventa poi possibile confrontare l’effetto ottenuto con l’effetto nullo che ci si aspetterebbe da una moneta bilanciata (50/100), o con qualsiasi altro effetto che può essere scelto. La dimensione dell’effetto si riferisce alla differenza tra l’effetto misurato nei dati e l’effetto nullo (di solito un valore che ci si aspetta di ottenere in base al caso soltanto). "],["stima-e-inferenza.html", "1.5 Stima e inferenza", " 1.5 Stima e inferenza La stima è il processo mediante il quale il campione viene utilizzato per conoscere le proprietà di interesse della popolazione. La media campionaria è una stima naturale della media della popolazione e la mediana campionaria è una stima naturale della mediana della popolazione. Quando parliamo di stimare una proprietà della popolazione (a volte indicata come parametro della popolazione) o di stimare la distribuzione di una variabile casuale, stiamo parlando dell’utilizzo dei dati osservati per conoscere le proprietà di interesse della popolazione. L’inferenza statistica è il processo mediante il quale le stime campionarie vengono utilizzate per rispondere a domande di ricerca e per valutare specifiche ipotesi relative alla popolazione. Discuteremo le procedure bayesiane dell’inferenza nell’ultima parte di queste dispense. "],["metodi-e-procedure-della-psicologia.html", "1.6 Metodi e procedure della psicologia", " 1.6 Metodi e procedure della psicologia Un modello psicologico di un qualche aspetto del comportamento umano o della mente ha le seguenti proprietà: descrive le caratteristiche del comportamento in questione, formula predizioni sulle caratteristiche future del comportamento, è sostenuto da evidenze empiriche, deve essere falsificabile (ovvero, in linea di principio, deve potere fare delle predizioni su aspetti del fenomeno considerato che non sono ancora noti e che, se venissero indagati, potrebbero portare a rigettare il modello, se si dimostrassero incompatibili con esso). L’analisi dei dati valuta un modello psicologico utilizzando strumenti statistici. Questa dispensa è strutturata in maniera tale da rispecchiare la suddivisione tra i temi della misurazione, dell’analisi descrittiva e dell’inferenza. Nel prossimo Capitolo sarà affrontato il tema della misurazione e, nell’ultima parte della dispensa verrà discusso l’argomento più difficile, quello dell’inferenza. Prima di affrontare il secondo tema, l’analisi descrittiva dei dati, sarà necessario introdurre il linguaggio di programmazione statistica R (un’introduzione a R è fornita in Appendice). Inoltre, prima di potere discutere l’inferenza, dovranno essere introdotti i concetti di base della teoria delle probabilità, in quanto l’inferenza non è che l’applicazione della teoria delle probabilità all’analisi dei dati. "],["chapter-misurazione.html", "Capitolo 2 La misurazione in psicologia", " Capitolo 2 La misurazione in psicologia Introduco il problema della misurazione in psicologia parlando dell’intelligenza. In quanto psicologi, siamo abituati a pensare alla misurazione dell’intelligenza, ma anche le persone che non sono psicologi sono ben familiari con la misurazione dell’intelligenza: tra le misurazioni delle caratteristiche psicologiche, infatti, la misurazione dell’intelligenza è forse la più conosciuta. I test di intelligenza consistono in una serie di problemi di carattere verbale, numerico o simbolico. Come ci si può aspettare, alcune persone riescono a risolvere correttamente un numero maggiore di problemi di altre. Possiamo contare il numero di risposte corrette e osservare le differenze individuali nei punteggi calcolati. Scopriamo in questo modo che le differenze individuali nell’abilità di risolvere tali problemi risultano sorprendentemente stabili nell’età adulta. Inoltre, diversi test di intelligenza tendono ad essere correlati positivamente: le persone che risolvono un maggior numero di problemi verbali, in media, tenderanno anche a risolvere correttamente un numero più grande di numerici e simbolici. Esiste quindi una notevole coerenza delle differenze osservate tra le persone, sia nel tempo sia considerando diverse procedure di test e valutazione. Avendo stabilito che ci sono differenze individuali tra le persone, è possibile esaminare le associazioni tra i punteggi dei test di intelligenza e altre variabili. Possiamo indagare se le persone con punteggi più alti nei test di intelligenza, rispetto a persone che ottengono punteggi più bassi, hanno più successo sul lavoro; se guadagnano di più; se votano in modo diverso; o se hanno un’aspettativa di vita più alta. Possiamo esaminare le differenze nei punteggi dei test di intelligenza in funzione di variabili come il genere, il gruppo etnico-razziale o lo stato socio-economico. Possiamo fare ricerche sull’associazione tra i punteggi dei test di intelligenza e l’efficienza dell’elaborazione neuronale, i tempi di reazione o la quantità di materia grigia all’interno della scatola cranica. Tutte queste ricerche sono state condotte e gli psicologi hanno scoperto una vasta gamma di associazioni tra le misure dell’intelligenza e altre variabili. Alcune di queste associazioni sono grandi e stabili, altre sono piccole e difficili da replicare. In riferimento all’intelligenza, dunque, gli psicologi hanno condotto un enorme numero di ricerche ponendosi domande diverse. In quali condizioni si verificano determinati effetti? Quali variabili mediano o moderano le relazioni tra i punteggi dei test di intelligenza e altre variabili? Queste relazioni si mantengono stabili in diversi gruppi di persone? Le ricerche sull’intelligenza umana sono un campo in continuo sviluppo. Tuttavia, tuttavia una domanda sorge spontanea: i test di intelligenza misurano davvero qualcosa e, in caso affermativo, che cos’è questo qualcosa? Infatti, dopo un secolo di teoria e ricerca sui punteggi dei test di intelligenza e, in generale, sui test psicologici, non sappiamo ancora con precisione cosa effettivamente questi test misurano. Queste considerazioni relative ai test di intelligenza ci conducono dunque alla domanda che ha motivato le precedenti considerazioni: cosa significa misurare un attributo psicologico? Questa è una domanda a cui è difficile rispondere, una domanda a cui è dedicata un’intera area di ricerca, quella della teoria della misurazione psicologica. Non possiamo qui entrare nel merito delle complessità formali della teoria della misurazione psicologica – questo argomento verrà approfondito nei successivi insegnamenti sulla testistica psicologica. Ci limiteremo invece a presentare alcune nozioni di base su un tema centrale della teoria della misurazione psicologica: il tema delle scale delle misure psicologiche. "],["le-scale-di-misura.html", "2.1 Le scale di misura", " 2.1 Le scale di misura In generale possiamo dire che la teoria della misurazione si occupa dello studio delle relazioni esistenti tra due domini: il “mondo fisico” e il “mondo psicologico”. Secondo la teoria della misurazione, la misurazione è un’attività rappresentativa, cioè è un processo di assegnazione di numeri in modo tale da preservare, all’interno del dominio numerico, le relazioni qualitative che sono state osservate nel mondo empirico. La teoria della misurazione ha lo scopo di specificare le condizioni necessarie per la costruzione di una rappresentazione adeguata delle relazioni empiriche all’interno di un sistema numerico. Da una prospettiva formale, le operazioni descritte dalla teoria della misurazione possono essere concettualizzate in termini di mappatura tra le relazioni esistenti all’interno di due insiemi (quello empirico e quello numerico). Il risultato di questa attività è chiamato “scala di misurazione”. Una famosa teoria delle scale di misura è stata proposta da Stevens (1946). Stevens ci fa notare che, in linea di principio, le variabili psicologiche sono in grado di rappresentare (preservare) con diversi gradi di accuratezza le relazioni qualitative che sono state osservate nei fenomeni psicologici. Secondo la teoria di Stevens, possiamo distinguere tra quattro scale di misura: le scale nominali (nominal scales), ordinali (ordinal scales), a intervalli (interval scales), di rapporti (ratio scales). Tali scale di misura consentono operazioni aritmetiche diverse, come indicato nella tabella successiva, in quanto ciasuna di esse è in grado di “catturare” soltanto alcune delle proprietà dei fenomeni psicologici che intende misurare. 2.1.1 Scala nominale Il livello di misurazione più semplice è quello della scala nominale. Questa scala di misurazione corrisponde ad una tassonomia. I simoboli o numeri che costituiscono questa scala non sono altro che i nomi delle categorie che utilizziamo per classificare i fenomeni psicologici. In base alle misure fornite da una scala nominale, l’unica cosa che siamo in grado di dire a proposito di una caratteristica psicologica è se essa è uguale o no ad un’altra caratteristica psicologica. La scala nominale raggruppa dunque i dati in categorie qualitative mutuamente esclusive (cioè nessun dato si può collocare in più di una categoria). Esiste la sola relazione di equivalenza tra le misure delle u.s., cioè nella scala nominale gli elementi del campione appartenenti a classi diverse sono differenti, mentre tutti quelli della stessa classe sono tra loro equivalenti: \\(x_i = x_j\\) oppure \\(x_i \\neq x_j\\). L’unica operazione algebrica che possiamo compiere sulle modalità della scala nominale è quella di contare le u.s. che appartengono ad ogni modalità e contare il numero delle modalità (classi di equivalenza). Dunque la descrizione dei dati avviene tramite le frequenze assolute e le frequenze relative. A partire da una scala nominale è possibile costruire altre scale nominali che sono equivalenti alla prima trasformando i valori della scala di partenza in modo tale da cambiare i nomi delle modalità, ma lasciando però inalterata la suddivisione u.s. nelle medesime classi di equivalenza. Questo significa che prendendo una variabile misurata su scala nominale e cambiando i nomi delle sue categorie otteniamo una nuova variabile esattamente corrispondente alla prima. 2.1.2 Scala ordinale La scala ordinale conserva la proprietà della scala nominale di classificare ciascuna u.s. all’interno di una e una sola categoria, ma alla relazione di equivalenza tra elementi di una stessa classe aggiunge la relazione di ordinamento tra le classi di equivalenza. Essendo basata su una relazione d’ordine, una scala ordinale descrive soltanto l’ordine di rango tra le modalità, ma non ci dà alcuna informazione su quanto una modalità sia più grande di un’altra. Non ci dice, per esempio, se la distanza tra le modalità \\(a\\) e \\(b\\) sia uguale, maggiore o minore della distanza tra le modalità \\(b\\) e \\(c\\). Esempio 2.1 Un esempio classico di scala ordinale è quello della scala Mohs per la determinazione della durezza dei minerali. Per stabilire la durezza dei minerali si usa il criterio empirico della scalfittura. Vengono stabiliti livelli di durezza crescente da 1 a 10 con riferimento a dieci minerali: talco, gesso, calcite, fluorite, apatite, ortoclasio, quarzo, topazio, corindone e diamante. Un minerale appartenente ad uno di questi livelli se scalfisce quello di livello inferiore ed è scalfito da quello di livello superiore. 2.1.3 Scala ad intervalli La scala ad intervalli include le proprietà di quella nominale e di quella ordinale, e in più consente di misurare le distanze tra le coppie di u.s. nei termini di un intervallo costante, chiamato unità di misura, a cui viene attribuito il valore “1”. La posizione dell’origine della scala, cioè il punto zero, è scelta arbitrariamente, nel senso che non indica l’assenza della quantità che si sta misurando. Avendo uno zero arbitrario, questa scala di misura consente valori negativi. Lo zero, infatti, non viene attribuito all’u.s. in cui la proprietà misurata risulta assente. La scala a intervalli equivalenti ci consente di effettuare operazioni algebriche basate sulla differenza tra i numeri associati ai diversi punti della scala, operazioni algebriche non era possibile eseguire nel caso di misure a livello di scala ordinale o nominale. Il limite della scala ad intervalli è quello di non consentire il calcolo del rapporto tra coppie di misure. Possiamo dire, per esempio, che la distanza tra \\(a\\) e \\(b\\) è la metà della distanza tra \\(c\\) e \\(d\\). Oppure che la distanza tra \\(a\\) e \\(b\\) è uguale alla distanza tra \\(c\\) e \\(d\\). Non possiamo dire, però, che \\(a\\) possiede la proprietà misurata in quantità doppia rispetto \\(b\\). Non possiamo cioè stabilire dei rapporti diretti tra le misure ottenute. Solo per le differenze tra le modalità sono dunque permesse tutte le operazioni aritmetiche: le differenze possono essere tra loro sommate, elevate a potenza oppure divise, determinando così le quantità che stanno alla base della statistica inferenziale. Nelle scale ad intervalli equivalenti, l’unità di misura è arbitraria, ovvero può essere cambiata attraverso una dilatazione, operazione che consiste nel moltiplicare tutti i valori della scala per una costante positiva. Poiché l’aggiunta di una costante non altera le differenze tra i valori della scala, è anche ammessa la traslazione, operazione che consiste nel sommare una costante a tutti i valori della scala. Essendo la scala invariate rispetto alla traslazione e alla dilatazione, le trasformazioni ammissibili sono le trasformazioni lineari: \\[ y&#39; = a + by, \\quad b &gt; 0. \\] L’aspetto che rimane invariante a seguito di una trasformazione lineare è l’uguaglianza dei rapporti fra intervalli. Esempio 2.2 Esempio di scala ad intervalli è la temperatura misurata in gradi Celsius o Fahrenheit, ma non Kelvin. Come per la scala nominale, è possibile stabilire se due modalità sono uguali o diverse: 30\\(^\\circ\\)C \\(\\neq\\) 20\\(^\\circ\\)C. Come per la scala ordinale è possibile mettere due modalità in una relazione d’ordine: 30\\(^\\circ\\)C \\(&gt;\\) 20\\(^\\circ\\)C. In aggiunta ai casi precedenti, però, è possibile definire una unità di misura per cui è possibile dire che tra 30\\(^\\circ\\)C e 20\\(^\\circ\\)C c’è una differenza di 30\\(^\\circ\\) - 20\\(^\\circ\\) = 10\\(^\\circ\\)C. I valori di temperatura, oltre a poter essere ordinati secondo l’intensità del fenomeno, godono della proprietà che le differenze tra loro sono direttamente confrontabili e quantificabili. Il limite della scala ad intervalli è quello di non consentire il calcolo del rapporto tra coppie di misure. Ad esempio, una temperatura di 80\\(^\\circ\\)C non è il doppio di una di 40\\(^\\circ\\)C. Se infatti esprimiamo le stesse temperature nei termini della scala Fahrenheit, allora i due valori non saranno in rapporto di 1 a 2 tra loro. Infatti, 20\\(^\\circ\\)C = 68\\(^\\circ\\)F e 40\\(^\\circ\\)C = 104\\(^\\circ\\)F. Questo significa che la relazione “il doppio di” che avevamo individuato in precedenza si applicava ai numeri della scala centigrada, ma non alla proprietà misurata (cioè la temperatura). La decisione di che scala usare (Centigrada vs. Fahrenheit) è arbitraria. Ma questa arbitrarietà non deve influenzare le inferenze che traiamo dai dati. Queste inferenze, infatti, devono dirci qualcosa a proposito della realtà empirica e non possono in nessun modo essere condizionate dalle nostre scelte arbitrarie che ci portano a scegliere la scala Centigrada piuttosto che quella Fahrenheit. Consideriamo ora l’aspetto invariante di una trasformazione lineare, ovvero l’uguaglianza dei rapporti fra intervalli. Prendiamo in esame, ad esempio, tre temperature: \\(20^\\circ C = 68^\\circ F\\), \\(15^\\circ C = 59^\\circ F\\), \\(10^\\circ C = 50 ^\\circ F\\). È facile rendersi conto del fatto che i rapporti fra intervalli restano costanti indipendentemente dall’unità di misura che è stata scelta: \\[ \\frac{20^\\circ C - 10^\\circ C}{20^\\circ C - 15^\\circ C} = \\frac{68^\\circ F - 50^\\circ F}{68^\\circ F-59^\\circ F} = 2. \\] 2.1.4 Scala di rapporti Nella scala a rapporti equivalenti la posizione dello zero non è arbitraria, ma corrisponde all’elemento dotato di intensità nulla rispetto alla proprietà misurata. Una scala a rapporti equivalenti si costruisce associando il numero 0 all’elemento con intensità nulla; viene poi scelta un’unità di misura \\(u\\) e, ad ogni elemento, si assegna un numero \\(a\\) definito come: \\[a = \\frac{d}{u}\\] dove \\(d\\) rappresenta la distanza dall’origine. Alle u.s. vengono dunque assegnati dei numeri tali per cui le differenze e i rapporti tra i numeri riflettono le differenze e i rapporti tra le intensità della proprietà misurata. Operazioni aritmetiche sono possibili non solo sulle differenze tra i valori della scala (come per la scala a intervalli equivalenti), ma anche sui valori stessi della scala. L’unica arbitrarietà riguarda l’unità di misura che si utilizza. L’unità di misura può cambiare, ma qualsiasi unità di misura si scelga, lo zero deve sempre indicare l’intensità nulla della proprietà considerata. Le trasformazioni ammissibili a questo livello di scala sono dette trasformazioni di similarità: \\[y&#39; = by, \\quad b &gt; 0.\\] A questo livello di scala, a seguito delle trasformazioni ammissibili, rimangono invariati anche i rapporti: \\[\\frac{y_i}{y_j} = \\frac{y&#39;_i}{y&#39;_j}.\\] References "],["gerarchia-dei-livelli-di-scala-di-misura.html", "2.2 Gerarchia dei livelli di scala di misura", " 2.2 Gerarchia dei livelli di scala di misura Stevens (1946) parla di livelli di scala poiché i quattro tipi di scala di misura stanno in una precisa gerarchia: la scala nominale rappresenta il livello più basso della misurazione, la scala a rapporti equivalenti è invece il livello più alto. Scale di modalità Operazioni aritmetiche nominali enumerare le classi di equivalenza e/o le frequenze per ciascuna classe di equivalenza ordinali enumerare le classi di equivalenza e/o le frequenze per ciascuna classe di equivalenza intervallari differenze (rapporti tra differenze) di rapporti rapporti diretti tra le misure Passando da un livello di misurazione ad uno più alto aumenta il numero di operazioni aritmetiche che possono essere compiute sui valori della scala, come indicato nella figura seguente. Per ciò che riguarda le trasformazioni ammissibili, più il livello di scala è basso, più le funzioni sono generali (sono minori cioè i vincoli per passare da una rappresentazione numerica ad un’altra equivalente). Salendo la gerarchia, la natura delle funzioni di trasformazione si fa più restrittiva. References "],["variabili-discrete-o-continue.html", "2.3 Variabili discrete o continue", " 2.3 Variabili discrete o continue Le variabili a livello di intervalli e di rapporti possono essere discrete o continue. Le variabili discrete possono assumere alcuni valori ma non altri. Una volta che l’elenco di valori accettabili è stato specificato, non ci sono casi che cadono tra questi valori. Le variabili discrete di solito assumono valori interi. Quando una variabile può assumere qualsiasi valore entro un intervallo specificato, allora si dice che la variabile è continua. In teoria, ciò significa che frazioni e decimali possono essere utilizzati per raggiungere un livello di precisione qualsiasi. In pratica, a un certo punto dobbiamo arrotondare i numeri, rendendo tecnicamente la variabile discreta. In variabili veramente discrete, tuttavia, non è possibile aumentare a piacimento il livello di precisione della misurazione. Esempio 2.3 Il numero di biciclette possedute da una persona è una variabile discreta poiché tale variabile può assumere come modalità solo i numeri interi non negativi. Frazioni di bicicletta non hanno senso. "],["alcune-misure-sono-migliori-di-altre.html", "2.4 Alcune misure sono migliori di altre", " 2.4 Alcune misure sono migliori di altre In psicologia, ciò che vogliamo misurare non è una caratteristica fisica, ma invece è un concetto teorico inosservabile, ovvero un costrutto. Un costrutto rappresenta il risultato di una fondata riflessione scientifica, non è per definizione accessibile all’osservazione diretta, ma viene inferito dall’osservazione di opportuni indicatori (Sartori, 2005). Ad esempio, supponiamo che un docente voglia valutare quanto bene uno studente comprenda la distinzione tra le quattro diverse scale di misura che sono state descritte sopra. Il docente potrebbe predisporre un test costituito da un insieme di domande e potrebbe contare a quante domande lo studente risponde correttamente. Questo test, però, può o può non essere una buona misura del costrutto relativo alla conoscenza effettiva delle quattro scale di misura. Per esempio, se il docente scrive le domande del test in modo ambiguo o se usa una linguaggio troppo tecnico che lo studente non conosce, allora i risultati del test potrebbero suggerire che lo studente non conosce la materia in questione anche se in realtà questo non è vero. D’altra parte, se il docente prepara un test a scelta multipla con risposte errate molto ovvie, allora lo studente può ottenere dei buoni risultati al test anche senza essere in grado di comprendere adeguatamente le proprietà delle quattro scale di misura. In generale non è possibile misurare un costrutto senza una certa quantità di errore. Poniamoci dunque il problema di determinare in che modo una misurazione possa dirsi adeguata. 2.4.1 Tipologie di errori L’errore è, per definizione, la differenza tra il valore vero e il valore misurato della grandezza in esame. Gli errori sono classificati come sistematici (o determinati) e casuali (o indeterminati). Gli errori casuali sono fluttuazioni, in eccesso o in difetto rispetto al valore reale, delle singole determinazioni e sono dovuti alle molte variabili incontrollabili che influenzano ogni misura psicologica. Gli errori sistematici, invece, influiscono sulla misurazione sempre nello stesso senso e, solitamente, per una stessa quantità (possono essere additivi o proporzionali). Le differenze tra le due tipologie di errori, sistematici e casuali, introducono i concetti di accuratezza e di precisione della misura. Una misura viene definita: accurata, quando vi è un accordo tra la misura effettuata ed il valore reale; precisa quando, ripetendo più volte la misura, i risultati ottenuti sono concordanti, cioè differiscono in maniera irrilevante tra loro. La metafora del tiro a bersaglio illustra la relazione tra precisione e accuratezza. FIGURA 2.1: Metafora del tiro al bersaglio. Per tenere sotto controllo l’incidenza degli errori, sono stati introdotti in psicologia i concetti di attendibilità e validità. Uno strumento si dice attendibile quando valuta in modo coerente e stabile la stessa variabile: i risultati ottenuti si mantengono costanti dopo ripetute somministrazione ed in assenza di variazioni psicologiche e fisiche dei soggetti sottoposti al test o cambiamenti dell’ambiente in cui ha luogo la somministrazione. L’attendibilità di uno strumento, però, non è sufficiente: in primo luogo uno strumento di misura deve essere valido, laddove la validità rappresenta il grado in cui uno strumento misura effettivamente ciò che dovrebbe misurare. In genere, si fa riferimento ad almeno quattro tipi di validità. La validità di costrutto riguarda il grado in cui un test misura ciò per cui è stato costruito. Essa si suddivide in: validità convergente e validità divergente. La validità convergente fa riferimento alla concordanza tra uno strumento e un altro che misura lo stesso costrutto. La validità divergente, al contrario, valuta il grado di discriminazione tra strumenti che misurano costrutti differenti. Senza validità di costrutto le altre forme di validità non hanno senso. In base alla validità di contenuto, un test fornisce una misura valida di un attributo psicologico se il dominio dell’attributo è rappresentato in maniera adeguata dagli item del test. Un requisito di base della validità di contenuto è la rilevanza e la rappresentatività del contenuto degli item in riferimento all’attributo che il test intende misurare. La validità di criterio valuta il grado di concordanza tra i risultati dello strumento considerato e i risultati ottenuti da altri strumenti che misurano lo stesso costrutto, o tra i risultati dello strumento considerato e un criterio esterno. Nella validità concorrente, costrutto e criterio vengono misurati contestualmente, consentendo un confronto immediato. Nella validità predittiva, il costrutto viene misurato prima e il criterio in un momento successivo, consentendo la valutazione della capacità dello strumento di predire un evento futuro. Infine, la validità di facciata fa riferimento al grado in cui il test appare valido ai soggetti a cui esso è diretto. La validità di facciata è importante in ambiti particolari, quali ad esempio la selezione del personale per una determinata occupazione. In questo caso è ovviamente importante che chi si sottopone al test ritenga che il test vada a misurare quegli aspetti che sono importanti per le mansioni lavorative che dovranno essere svolte, piuttosto che altre cose. In generale, la validità di facciata non è utile, tranne in casi particolari. "],["conclusioni.html", "Conclusioni", " Conclusioni Una domanda che uno psicologo spesso si pone è: “sulla base delle evidenze osservate, possiamo concludere dicendo che l’intervento psicologico è efficace nel trattamento e nella cura del disturbo?” Le considerazioni svolte in questo capitolo dovrebbero farci capire che, prima di cercare di rispondere a questa domanda con l’analisi statistica dei dati, devono essere affrontati i problemi della validità e dell’attendibilità delle misure (oltre a stabilire l’appropriato livello di scala di misura delle osservazioni). L’attendibilità è un prerequisito della validità. Se gli errori di misurazione sono troppo grandi, i dati sono inutili. Inoltre, uno strumento di misurazione può essere preciso ma non valido. La validità e l’attendibilità delle misurazioni sono dunque entrambe necessarie. In generale, l’attendibilità e la validità delle misure devono essere valutate per capire se i dati raccolti da un ricercatore siano adeguati (1) per fornire una risposta alla domanda della ricerca, e (2) per giungere alla conclusione proposta dal ricercatore alla luce dei risultati dell’analisi statistica che è stata eseguita. È chiaro che le informazioni fornite in questo capitolo si limitano a scalfire la superficie di questi problemi. I concetti qui introdotti, però, devono sempre essere tenuti a mente e costituiscono il fondamento di quanto verrà esposto nei capitoli successivi. "],["descriptive-stats.html", "Capitolo 3 Statistica descrittiva", " Capitolo 3 Statistica descrittiva Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad individuare le osservazioni anomale e gli errori di tabulazione. Consentono di visualizzare e di studiare le relazioni tra le variabili. "],["chapter-descript.html", "3.1 Introduzione all’esplorazione dei dati", " 3.1 Introduzione all’esplorazione dei dati Le analisi esplorative dei datisono indispensabili per condurre in modo corretto una qualsiasi analisi statistica, dal livello base a quello avanzato. Si parla di analisi descrittiva se l’obiettivo è quello di descrivere le caratteristiche di un campione. Si parla di analisi esplorativa dei dati (Exploratory Data Analysis o EDA) se l’obiettivo è quello di esplorare i dati alla ricerca di nuove informazioni e relazioni tra variabili. Questa distinzione, seppur importante a livello teorico, nella pratica è più fumosa perché spesso entrambe le situazioni si verificano contemporaneamente nella stessa indagine statistica e le metodologie di analisi che si utilizzano sono molto simili. Né il calcolo delle statistiche descrittive né l’analisi esplorativa dei dati possono essere condotte senza utilizzare un software. Le descrizioni dei concetti di base della EDA saranno dunque fornite di pari passo alla spiegazione di come le quantità discusse possono essere calcolate in pratica utilizzando . "],["un-excursus-storico.html", "3.2 Un excursus storico", " 3.2 Un excursus storico Nel 1907 Francis Galton, cugino di Charles Darwin, matematico e statistico autodidatta, geografo, esploratore, teorico della dattiloscopia (ovvero, dell’uso delle impronte digitali a fini identificativi) e dell’eugenetica, scrisse una lettera alla rivista scientifica Nature sulla sua visita alla Fat Stock and Poultry Exhibition di Plymouth. Lì vide alcuni membri del pubblico partecipare ad un gioco il cui scopo era quello di indovinare il peso della carcassa di un grande bue che era appena stato scuoiato. Galton si procurò i 787 dei biglietti che erano stati compilati dal pubblico e considerò il valore medio di 547 kg come la “scelta democratica” dei partecipanti, in quanto “ogni altra stima era stata giudicata troppo alta o troppo bassa dalla maggioranza dei votanti”. Il punto interessante è che il peso corretto di 543 kg si dimostrò essere molto simile alla “scelta democratica” basata sulle stime dei 787 partecipanti. Galton intitolò la sua lettera a Nature Vox Populi (voce del popolo), ma questo processo decisionale è ora meglio conosciuto come la “saggezza delle folle” (wisdom of crowds). Possiamo dire che, nel suo articolo del 1907, Galton effettuò quello che ora chiamiamo un riepilogo dei dati, ovvero calcolò un indice sintetico a partire da un insieme di dati. In questo capitolo esamineremo le tecniche che sono state sviluppate nel secolo successivo per riassumere le grandi masse di dati con cui sempre più spesso ci dobbiamo confrontare. Vedremo come calcolare e interpretare gli indici di posizione e di dispersione, discuteremo le distribuzioni di frequenze e le relazioni tra variabili. Vedremo inoltre quali sono le tecniche di visualizzazione che ci consentono di rappresentare questi sommari dei dati mediante dei grafici. Ma prima di entrare nei dettagli, prendiamoci un momento per capire perché abbiamo bisogno della statistica e, per ciò che stiamo discutendo qui, della statistica descrittiva. In generale, che cos’è la statistica? Ci sono molte definizioni. Fondamentalmente, la statistica è un insieme di tecniche che ci consentono di dare un senso al mondo attraverso i dati. Ciò avviene tramite il processo di analisi statistica. L’analisi statistica traduce le domande che abbiamo a proposito del mondo in modelli matematici, utilizza i dati per scegliere i modelli matematici che sono apppropriati per descrivere il mondo e, infine, applica tali modelli per trovare una risposta alle domande che ci siamo posti. La statistica consente quindi di collegare le nostre domande a proposito del mondo ai dati, di utilizzare i dati per trovare le risposte alle domande che ci siamo posti e di valutare l’impatto delle risposte che abbiamo trovato. "],["riassumere-i-dati.html", "3.3 Riassumere i dati", " 3.3 Riassumere i dati Iniziamo a porci una domanda. Quando riassumiamo i dati, necessariamente buttiamo via delle informazioni; ma è una buona idea procedere in questo modo? Non sarebbe meglio conservare le informazioni specifiche di ciascun soggetto che partecipa ad un esperimento psicologico, al di là di ciò che viene trasmesso dagli indici riassuntivi della statistica descrittiva? Che dire delle informazioni che descrivono come sono stati raccolti i dati, come l’ora del giorno o l’umore del partecipante? Tutte queste informazioni vengono perdute quando riassumiamo i dati. La risposta alla domanda che ci siamo posti è che, in generale, non è una buona idea conservare tutti i dettagli di ciò che sappiamo. È molto più utile riassumere le informazioni perché la semplificazione risultante consente i processi di generalizzazione. In un contesto letterario, l’importanza della generalizzazione è stata sottolineata da Jorge Luis Borges nel suo racconto “Funes o della memoria”, che descrive un individuo che perde la capacità di dimenticare. Borges si concentra sulla relazione tra generalizzazione e pensiero: “Pensare è dimenticare una differenza, generalizzare, astrarre. Nel mondo troppo pieno di Funes, c’erano solo dettagli.” Come possiamo ben capire, la vita di Funes non è facile. Se facciamo riferimento alla psicologia possiamo dire che gli psicologi hanno studiato a lungo l’utilità della generalizzazione per il pensiero. Un esempio è fornito dal fenomeno della formazione dei concetti e lo psicologo che viene in mente a questo proposito è sicuramente Eleanor Rosch, la quale ha studiato i principi di base della categorizzazione. I concetti ci forniscono uno strumento potente per organizzare le conoscenze. Noi siamo in grado di riconoscere facilmente i diversi esemplare di un concetto – per esempio, “gli uccelli” – anche se i singoli esemplari che fanno parte di una categoria sono molto diversi tra loro (l’aquila, il gabbiano, il pettirosso). L’uso dei concetti, cioè la generalizzazione, è utile perché ci consente di fare previsioni sulle proprietà dei singoli esemplari che appartengono ad una categoria, anche se non abbiamo mai avuto esperienza diretta con essi – per esempio, possiamo fare la predizione che tutti gli uccelli possono volare e mangiare vermi, ma non possono guidare un’automobile o parlare in inglese. Queste previsioni non sono sempre corrette, ma sono utili. Le statistiche descrittive, in un certo senso, ci fornisco l’analogo dei “prototipi” che, secondo Eleanor Rosch, stanno alla base del processo psicologico di creazione dei concetti. Un prototipo è l’esemplare più rappresentativo di una categoria. In maniera simile, una statistica descrittiva come la media, ad esempio, potrebbe essere intesa come l’osservazione “tipica”. La statistica descrittiva ci fornisce gli strumenti per riassumere i dati che abbiamo a disposizione in una forma visiva o numerica. Le rappresentazioni grafiche più usate della statistica descrittiva sono gli istogrammi, i diagrammi a dispersione o i box-plot, e gli indici sintetici più comuni sono la media, la mediana, la varianza e la deviazione standard. "],["i-dati-grezzi.html", "3.4 I dati grezzi", " 3.4 I dati grezzi Per introdurre i principali strumenti della statistica descrittiva considereremo qui i dati raccolti da Zetsche, Bürkner, and Renneberg (2019). Questi ricercatori hanno studiato le aspettative negative quale meccanismo chiave nel mantenimento e nella reiterazione della depressione. Nello studio, Zetsche, Bürkner, and Renneberg (2019) si sono chiesti se individui depressi maturino delle aspettative accurate sul loro umore futuro, oppure se tali aspettative sono distorte negativamente.3. In uno studio viene esaminato un campione costituito da 30 soggetti con almeno un episodio depressivo maggiore e da 37 controlli sani. Gli autori hanno misurato il livello depressivo con il Beck Depression Inventory (BDI-II). Questi sono i dati che considereremo qui. Esercizio 3.1 Qual è la la gravità della depressione riportata dai soggetti nel campione esaminato da Zetsche, Bürkner, and Renneberg (2019)? Per rispondere a questa domanda, iniziamo a leggere in \\(\\R\\) i dati, assumendo che il file data.mood.csv si trovi nella cartella data contenuta nella working directory. library(&quot;rio&quot;) df &lt;- rio::import( here(&quot;data&quot;, &quot;data.mood.csv&quot;), header = TRUE ) C’è un solo valore BDI-II per ciascun soggetto ma tale valore viene ripetuto tante volte quante volte sono le righe del data.frame associate ad ogni soggetto (ciascuna riga corrispondente ad una prova diversa). È dunque necessario trasformare il data.frame in modo tale da avere un’unica riga per ciascun soggetto, ovvero un unico valore BDI-II per soggetto. bysubj &lt;- df %&gt;% group_by(esm_id) %&gt;% summarise( bdi = mean(bdi) ) %&gt;% na.omit() Ci sono dunque 66 soggetti i quali hanno ottenuto i valori sulla scala del BDI-II stampati di seguito. Per semplicità, li presentiamo ordinati dal più piccolo al più grande. sort(bysubj$bdi) #&gt; [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 #&gt; [18] 1 1 1 1 1 1 1 1 2 2 2 2 3 3 3 5 7 #&gt; [35] 9 12 19 22 22 24 25 25 26 26 26 27 27 28 28 30 30 #&gt; [52] 30 31 31 33 33 34 35 35 35 36 39 41 43 43 44 References "],["distribuzioni-di-frequenze.html", "3.5 Distribuzioni di frequenze", " 3.5 Distribuzioni di frequenze È chiaro che i dati grezzi sono di difficile lettura. Poniamoci dunque il problema di creare una rappresentazione sintetica e comprensibile di questo insieme di valori. Uno dei modi che ci consentono di effettuare una sintesi dei dati è quello di generare una distribuzione di frequenze. Definizione 3.1 Una distribuzione di frequenze è un riepilogo del conteggio della frequenza con cui le modalità osservate in un insieme di dati si verificano in un intervallo di valori. Per creare una distribuzione di frequenze possiamo procedere effettuando una partizione delle modalità della variabile di interesse in \\(m\\) classi (denotate con \\(\\Delta_i\\)) tra loro disgiunte. In tale partizione, la classe \\(i\\)-esima coincide con un intervallo di valori aperto a destra \\([a_i, b_i)\\) o aperto a sinistra \\((a_i, b_i]\\). Ad ogni classe \\(\\Delta_i\\) avente \\(a_i\\) e \\(b_i\\) come limite inferiore e superiore associamo l’ampiezza \\(b_i - a_i\\) (non necessariamente uguale per ogni classe) e il valore centrale \\(\\bar{x}_i\\). La scelta delle classi è arbitraria, ma è buona norma non definire classi con un numero troppo piccolo (&lt; 5) di osservazioni. Poiché ogni elemento dell’insieme \\(\\{x_i\\}_{i=1}^n\\) appartiene ad una ed una sola classe \\(\\Delta_i\\), possiamo calcolare le quantità elencate di seguito. La frequenza assoluta \\(n_i\\) di ciascuna classe, ovvero il numero di osservazioni che ricadono nella classe \\(\\Delta_i\\). Proprietà: \\(n_1 + n_2 + \\dots + n_m = n\\). La frequenza relativa \\(f_i = n_i/n\\) di ciascuna classe. Proprietà: \\(f_1+f_2+\\dots+f_m =1\\). La frequenza cumulata \\(N_i\\), ovvero il numero totale delle osservazioni che ricadono nelle classi fino alla \\(i\\)-esima compresa: \\(N_i = \\sum_{i=1}^m n_i.\\) La frequenza cumulata relativa \\(F_i\\), ovvero \\(F_i = f_1+f_2+\\dots+f_m = \\frac{N_i}{n} = \\frac{1}{n} \\sum_{i=1}^m f_i.\\) Esercizio 3.2 Si calcoli la distribuzione di frequenza assoluta e la distribuzione di frequenza relativa per i valori del BDI-II del campione clinico di Zetsche, Bürkner, and Renneberg (2019). Per costruire una distribuzione di frequenza è innanzitutto necessario scegliere gli intervalli delle classi. Facendo riferimento ai cut-off usati per l’interpretazione del BDI-II, definiamo i seguenti intervalli aperti a destra: depressione minima: [0, 13.5), depressione lieve: [13.5, 19.5), depressione moderata: [19.5, 28.5), depressione severa: [28.5, 63). Esaminando i dati, possiamo notare che 36 soggetti cadono nella prima classe, uno nella seconda classe, e così via. La distribuzione di frequenza della variabile bdi2 è riportata nella tabella seguente. Questa distribuzione di frequenza ci aiuta a capire meglio cosa sta succedendo. Se consideriamo la frequenza relativa, ad esempio, possiamo notare che ci sono due valori maggiormente ricorrenti e tali valori corrispondono alle due classi più estreme. Questo ha senso nel caso presente, in quanto il campione esaminato da Zetsche, Bürkner, and Renneberg (2019) includeva due gruppi di soggetti: soggetti sani (con valori BDI-II bassi) e soggetti depressi (con valori BDI-II alti).4 In una distribuzione di frequenza tali valori tipici vanno sotto il nome di mode della distribuzione. Lim. classi Fr. ass. Fr. rel. Fr. ass. cum. Fr. rel. cum. \\([0, 13.5)\\) 36 36/66 36 36/66 \\([13.5, 19.5)\\) 1 1/66 37 37/66 \\([19.5, 28.5)\\) 12 12/66 49 49/66 \\([28.5, 63)\\) 17 17/66 66 66/66 Poniamoci ora il problema di costruire la tabella precedente utilizzando . Usando la funzione cut(), dividiamo il campo di variazione (ovvero, la differenza tra il valore massimo di una distribuzione ed il valore minimo) di una variabile continua x in intervalli e codifica ciascun valore x nei termini dell’intervallo a cui appartiene. Così facendo otteniamo: bysubj$bdi_level &lt;- cut( bysubj$bdi, breaks = c(0, 13.5, 19.5, 28.5, 63), include.lowest = TRUE, labels = c( &quot;minimal&quot;, &quot;mild&quot;, &quot;moderate&quot;, &quot;severe&quot; ) ) bysubj$bdi_level #&gt; [1] moderate severe severe moderate severe #&gt; [6] severe severe severe moderate severe #&gt; [11] moderate mild severe minimal minimal #&gt; [16] minimal severe moderate minimal minimal #&gt; [21] minimal minimal minimal moderate minimal #&gt; [26] minimal minimal minimal minimal minimal #&gt; [31] minimal severe minimal minimal severe #&gt; [36] minimal moderate minimal minimal minimal #&gt; [41] severe minimal minimal severe severe #&gt; [46] moderate severe severe minimal moderate #&gt; [51] minimal moderate severe moderate moderate #&gt; [56] minimal minimal minimal minimal minimal #&gt; [61] minimal minimal minimal minimal minimal #&gt; [66] minimal #&gt; Levels: minimal mild moderate severe Possiamo ora usare la funzione table() la quale ritorna un elenco che associa la frequenza assoluta a ciascuna modalità della variabile – ovvero, ritorna la distribuzione di frequenza assoluta. table(bysubj$bdi_level) #&gt; #&gt; minimal mild moderate severe #&gt; 36 1 12 17 La distribuzione di frequenza relativa si ottiene dividendo ciascuna frequenza assoluta per il numero totale di osservazioni: table(bysubj$bdi_level) / sum(table(bysubj$bdi_level)) #&gt; #&gt; minimal mild moderate severe #&gt; 0.54545 0.01515 0.18182 0.25758 Limiti delle classi Frequenza assoluta Frequenza relativa [0, 13.5) 36 36/66 [13.5, 19.5) 1 1/66 [19.5, 28.5) 12 12/66 [28.5, 63] 17 17/66 References "],["istogramma.html", "3.6 Istogramma", " 3.6 Istogramma I dati che sono stati sintetizzati in una distribuzione di frequenze possono essere rappresentati graficamente in un istogramma. Un istogramma si costruisce riportando sulle ascisse i limiti delle classi \\(\\Delta_i\\) e sulle ordinate i valori della funzione costante a tratti \\[ \\varphi_n(x)= \\frac{f_i}{b_i-a_i}, \\quad x\\in \\Delta_i,\\, i=1, \\dots, m \\] che misura la densità della frequenza relativa della variabile \\(X\\) nella classe \\(\\Delta_i\\), ovvero il rapporto fra la frequenza relativa \\(f_i\\) e l’ampiezza (\\(b_i - a_i\\)) della classe. In questo modo il rettangolo dell’istogramma associato alla classe \\(\\Delta_i\\) avrà un’area proporzionale alla frequenza relativa \\(f_i\\). Si noti che l’area totale dell’istogramma delle frequenze relative è data della somma delle aree dei singoli rettangoli e quindi vale 1.0. Esercizio 3.3 Si utilizzi \\(\\R\\) per costruire un istogramma per i valori BDI-II riportati da Zetsche, Bürkner, and Renneberg (2019). Con i quattro intervalli individuati dai cut-off del BDI-II otteniamo la rappresentazione riportata nella figura 3.1. Per chiarezza, precisiamo che ggplot() utilizza intervalli aperti a destra. Nel caso della prima barra dell’istogramma, l’ampiezza dell’intervallo è pari a 13.5 e l’area della barra (ovvero, la frequenza relativa) è uguale a 36/66. Dunque l’altezza della barra è uguale a \\((36 / 66) / 13.5 = 0.040\\). Lo stesso procedimento si applica per il calcolo dell’altezza degli altri rettangoli. bysubj %&gt;% ggplot(aes(x = bdi)) + geom_histogram( aes(y = ..density..), breaks = c(0, 13.5, 19.5, 28.5, 44.1) # il valore BDI-II massimo è 44 ) + scale_x_continuous( breaks = c(0, 13.5, 19.5, 28.5, 44.1) ) + labs( x = &quot;BDI-II&quot;, y = &quot;Densità di frequenza&quot; ) FIGURA 3.1: Istogramma per i valori BDI-II riportati da Zetsche et al. (2019). Anche se nel caso presente è sensato usare ampiezze diverse per gli intervalli delle classi, in generale gli istogrammi si costruiscono utilizzando intervalli riportati sulle ascisse con un’ampiezza uguale. Questo è il caso dell’istogramma della figura 3.2. bysubj %&gt;% ggplot(aes(x = bdi)) + geom_histogram( aes(y = ..density..), breaks = seq(0, 44.1, length.out = 7) ) + scale_x_continuous( breaks = c(0.00, 7.35, 14.70, 22.05, 29.40, 36.75, 44.10) ) + labs( x = &quot;BDI-II&quot;, y = &quot;Densità di frequanza&quot; ) FIGURA 3.2: Una rappresentazione più comune per l’istogramma dei valori BDI-II nella quale gli intervalli delle classi hanno ampiezze uguali. References "],["kernel-density-plot.html", "3.7 Kernel density plot", " 3.7 Kernel density plot Il confronto tra le figure 3.1 e 3.2 rende chiaro il limite dell’istogramma: il profilo dell’istogramma è arbitrario, in quanto dipende dal numero e dall’ampiezza delle classi. Questo rende difficile l’interpretazione. Il problema precedente può essere alleviato utilizzando una rappresentazione alternativa della distribuzione di frequenza, ovvero la stima della densità della frequenza dei dati (detta anche stima kernel di densità). Un modo semplice per pensare a tale rappresentazione, che in inglese va sotto il nome di kernel density plot (cioè i grafici basati sulla stima kernel di densità), è quello di immaginare un grande campione di dati, in modo che diventi possibile definire un enorme numero di classi di equivalenza di ampiezza molto piccola, le quali non risultino vuote. In tali circostanze, la funzione di densità empirica non è altro che il profilo lisciato dell’istogramma. La stessa idea si applica anche quando il campione è piccolo. In tali circostanze, invece di raccogliere le osservazioni in barre come negli istogrammi, lo stimatore di densità kernel colloca una piccola “gobba” (bump), determinata da un fattore \\(K\\) (kernel) e da un parametro \\(h\\) di smussamento detto ampiezza di banda (bandwidth), in corrispondenza di ogni osservazione, quindi somma le gobbe risultanti generando una curva smussata. L’interpretazione che possiamo attribuire al kernel density plot è simile a quella che viene assegnata agli istogrammi: l’area sottesa al kernel density plot in un certo intervallo rappresenta la proporzione di casi della distribuzione che hanno valori compresi in quell’intervallo. Esercizio 3.4 All’istogramma dei valori BDI-II di Zetsche, Bürkner, and Renneberg (2019) si sovrapponga un kernel density plot. bysubj %&gt;% ggplot(aes(x = bdi)) + geom_histogram( aes(y = ..density..), breaks = seq(0, 44.1, length.out = 7) ) + geom_density( aes(x = bdi), adjust = 0.5, size = 0.8, #fill = colors[2], alpha = 0.5 ) + labs( x = &quot;BDI-II&quot;, y = &quot;Densità di frequenza&quot; ) FIGURA 3.3: Kernel density plot e corrispondente istogramma per i valori BDI-II. References "],["forma-di-una-distribuzione.html", "3.8 Forma di una distribuzione", " 3.8 Forma di una distribuzione In generale, la forma di una distribuzione descrive come i dati si distribuiscono intorno ai valori centrali. Distinguiamo tra distribuzioni simmetriche e asimmetriche, e tra distribuzioni unimodali o multimodali. Un’illustrazione grafica è fornita nella figura 3.4. Nel pannello 1 la distribuzione è unimodale con asimmetria negativa; nel pannello 2 la distribuzione è unimodale con asimmetria positiva; nel pannello 3 la distribuzione è simmetrica e unimodale; nel pannello 4 la distribuzione è bimodale. FIGURA 3.4: 1: Asimmetria negativa. 2: Asimmetria positiva. 3: Distribuzione unimodale. 4: Distribuzione bimodale. Esercizio 3.5 Il kernel density plot della figura 3.3 indica che la distribuzione dei valori del BDI-II nel campione di Zetsche, Bürkner, and Renneberg (2019) è bimodale. Ciò indica che le osservazioni della distribuzione si addensano in due cluster ben distinti: un gruppo di osservazioni tende ad avere valori BDI-II bassi, mentre l’altro gruppo tende ad avere BDI-II alti. Questi due cluster di osservazioni corrispondono al gruppo di controllo e al gruppo clinico nel campione di dati esaminato da Zetsche, Bürkner, and Renneberg (2019). References "],["indici-di-posizione.html", "3.9 Indici di posizione", " 3.9 Indici di posizione Nuovamente, se preferite un’introduzione “soft” alla nozione di “tendenza centrale” di una distribuzione statistica, vi rimando nuovamentew al link che ho già suggerito in precedenza. 3.9.1 Quantili La descrizione della distribuzione dei valori BDI-II di Zetsche, Bürkner, and Renneberg (2019) può essere facilitata dalla determinazione di alcuni valori caratteristici che sintetizzano le informazioni contenute nella distribuzione di frequenze. Si dicono quantili (o frattili) quei valori caratteristici che hanno le seguenti proprietà. I quartili sono quei valori che ripartiscono i dati \\(x_i\\) in quattro parti ugualmente numerose (pari ciascuna al 25% del totale). Il primo quartile, \\(q_1\\), lascia alla sua sinistra il 25% del campione pensato come una fila ordinata (a destra quindi il 75%). Il secondo quartile \\(q_2\\) lascia a sinistra il 50% del campione (a destra quindi il 50%). Esso viene anche chiamato mediana. Il terzo quartile lascia a sinistra il 75% del campione (a destra quindi il 25%). Secondo lo stesso criterio, si dicono decili i quantili di ordine \\(p\\) multiplo di 0.10 e percentili i quantili di ordine \\(p\\) multiplo di 0.01. Come si calcolano i quantili? Consideriamo la definizione di quantile non interpolato di ordine \\(p\\) \\((0 &lt; p &lt; 1)\\). Si procede innanzitutto ordinando i dati in ordine crescente, \\(\\{x_1, x_2, \\dots, x_n\\}\\). Ci sono poi due possibilità. Se il valore \\(np\\) non è intero, sia \\(k\\) l’intero tale che \\(k &lt; np &lt; k + 1\\) – ovvero, la parte intera di \\(np\\). Allora \\(q_p = x_{k+1}.\\) Se \\(np = k\\) con \\(k\\) intero, allora \\(q_p = \\frac{1}{2}(x_{k} + x_{k+1}).\\) Se vogliamo calcolare il primo quartile \\(q_1\\), ad esempio, utilizziamo \\(p = 0.25\\). Dovendo calcolare gli altri quantili basta sostituire a \\(p\\) il valore appropriato. Gli indici di posizione, tra le altre cose, hanno un ruolo importante, ovvero vengono utilizzati per creare una rappresentazione grafica di una distribuzione di valori che è molto popolare e può essere usata in alternativa ad un istogramma (in realtà vedremo poi come possa essere combinata con un istogramma). Tale rappresentazione va sotto il nome di box-plot. Esercizio 3.6 Per fare un esempio, consideriamo i nove soggetti del campione clinico di Zetsche, Bürkner, and Renneberg (2019) che hanno riportato un unico episodio di depressione maggiore. Per tali soggetti i valori ordinati del BDI-II (per semplicità li chiameremo \\(x\\)) sono i seguenti: 19, 26, 27, 28, 28, 33, 33, 41, 43. Per il calcolo del secondo quartile (non interpolato), ovvero per il calcolo della mediana, dobbiamo considerare la quantità \\(np = 9 \\cdot 0.5 = 4.5\\), non intero. Quindi, \\(q_1 = x_{4 + 1} = 27\\). Per il calcolo del quantile (non interpolato) di ordine \\(p = 2/3\\) dobbiamo considerare la quantità \\(np = 9 \\cdot 2/3 = 6\\), intero. Quindi, \\(q_{\\frac{2}{3}} = \\frac{1}{2} (x_{6} + x_{7}) = \\frac{1}{2} (33 + 33) = 33\\). 3.9.2 Diagramma a scatola Il diagramma a scatola (o box plot) è uno strumento grafico utile al fine di ottenere informazioni circa la dispersione e l’eventuale simmetria o asimmetria di una distribuzione. Per costruire un box-plot si rappresenta sul piano cartesiano un rettangolo (cioè la “scatola”) di altezza arbitraria la cui base corrisponde alla dist intanza interquartile (IQR = \\(q_{0.75} - q_{0.25}\\)). La linea interna alla scatola rappresenta la mediana \\(q_{0.5}\\). Si tracciano poi ai lati della scatola due segmenti di retta i cui estremi sono detti “valore adiacente” inferiore e superiore. Il valore adiacente inferiore è il valore più piccolo tra le osservazioni che risulta maggiore o uguale al primo quartile meno la distanza corrispondente a 1.5 volte la distanza interquartile. Il valore adiacente superiore è il valore più grande tra le osservazioni che risulta minore o uguale a \\(Q_3+1.5\\) IQR. I valori esterni ai valori adiacenti (chiamati valori anomali) vengono rappresentati individualmente nel box-plot per meglio evidenziarne la presenza e la posizione. FIGURA 3.5: Box-plot: \\(M\\) è la mediana, \\(\\bar{x}\\) è la media aritmetica e IQR è la distanza interquartile (\\(Q_3 - Q_1\\)). Esercizio 3.7 Per i dati di Zetsche, Bürkner, and Renneberg (2019), si utilizzi un box-plot per rappresentare graficamente la distribuzione dei punteggi BDI-II nel gruppo dei pazienti e nel gruppo di controllo. Nella figura 3.6 sinistra sono rappresentati i dati grezzi. La linea curva che circonda (simmetricamente) le osservazioni è l’istogramma lisciato (kernel density plot) che abbiamo descritto in precedenza. Nella figura 3.6 destra sono rappresentanti gli stessi dati: il kernel density plot è lo stesso di prima, ma al suo interno è stato collocato un box-plot. Entrambe le rappresentazioni suggeriscono che la distribuzione dei dati è all’incirca simmetrica nel gruppo clinico. Il gruppo di controllo mostra invece un’asimmetria positiva. bysubj &lt;- df %&gt;% group_by(esm_id, group) %&gt;% summarise( bdi = mean(bdi), nr_of_episodes = mean(nr_of_episodes, na.rm = TRUE) ) %&gt;% na.omit() %&gt;% ungroup() bysubj$group &lt;- forcats::fct_recode( bysubj$group, &quot;Controlli\\n sani&quot; = &quot;ctl&quot;, &quot;Depressione\\n maggiore&quot; = &quot;mdd&quot; ) p1 &lt;- bysubj %&gt;% ggplot(aes(x = group, y = bdi)) + geom_violin(trim = FALSE) + geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;, dotsize = 0.7) + labs( x = &quot;&quot;, y = &quot;BDI-II&quot; ) p2 &lt;- bysubj %&gt;% ggplot(aes(x = group, y = bdi)) + geom_violin(trim = FALSE) + geom_boxplot(width = 0.05) + labs( x = &quot;&quot;, y = &quot;BDI-II&quot; ) p1 + p2 FIGURA 3.6: Due versioni di un violin plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019). 3.9.3 Sina plot Si noti che i box plot non sono necessariamente la rappresentazione migliore della distribuzione di una variabile. Infatti, richiedono la comprensione di concetti complessi (quali i quantili e la differenza interquantile) che non sono necessari se vogliamo presentare in maniera grafica la distribuzione della variabile e, in generale, non sono compresi da un pubblico di non specialisti. Inoltre, i box plot nascondono informazioni che di solito sono cruciali da vedere. È dunque preferibile presentare direttamente i dati. Nella figura 3.7 viene presentato un cosiddetto “sina plot”. In tale rappresentazione grafica vengono mostrate le singole osservazioni divise in classi. Ai punti viene aggiunto un jitter, così da evitare sovrapposizioni. L’ampiezza del jitter lungo l’asse \\(x\\) è determinata dalla distribuzione della densità dei dati all’interno di ciascuna classe; quindi il grafico mostra lo stesso contorno di un violin plot, ma trasmette informazioni sia sul numero di punti dati, sia sulla distribuzione della densità, sui valori anomali e sulla distribuzione dei dati in un formato molto semplice, comprensibile e sintetico. Esercizio 3.8 Si generi un sina plot per i dati della figura 3.6. Si aggiunga alla figura una rappresentazione della mediana. zetsche_summary &lt;- bysubj %&gt;% group_by(group) %&gt;% summarize( bdi_mean = mean(bdi), bdi_sd = sd(bdi), bdi_median = median(bdi) ) %&gt;% ungroup() bysubj %&gt;% ggplot( aes(x = group, y = bdi, color = group) ) + ggforce::geom_sina(aes(color = group, size = 3, alpha = .5)) + geom_errorbar( aes(y = bdi_median, ymin = bdi_median, ymax = bdi_median), data = zetsche_summary, width = 0.3, size = 3 ) + labs( x = &quot;&quot;, y = &quot;BDI-II&quot;, color = &quot;Gruppo&quot; ) + theme(legend.position = &quot;none&quot;) + scale_colour_grey(start = 0.7, end = 0) FIGURA 3.7: Sina plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019) con l’indicazione della mediana per ciascun gruppo. 3.9.4 L’eccellenza grafica Non c’è un unico modo “corretto” per la rappresentazione grafica dei dati. Ciascuno dei grafici che abbiamo discusso in precedenza ha i suoi pregi e i suoi difetti. Un ricercatore che ha molto influenzato il modo in cui viene realizzata la visualizzazione dei dati scientifici è Edward Tufte, soprannominato dal New York Times il “Leonardo da Vinci dei dati.” Secondo Tufte, “l’eccellenza nella grafica consiste nel comunicare idee complesse in modo chiaro, preciso ed efficiente”. Nella visualizzazione delle informazioni, l’“eccellenza grafica” ha l’obiettivo di comunicare al lettore il maggior numero di idee nella maniera più diretta e semplice possibile. Secondo Tufte (2001), le rappresentazioni grafiche dovrebbero: mostrare i dati; indurre l’osservatore a riflettere sulla sostanza piuttosto che sulla progettazione grafica, o qualcos’altro; evitare di distorcere quanto i dati stanno comunicando (“integrità grafica”); presentare molte informazioni in forma succinta; rivelare la coerenza tra le molte dimensioni dei dati; incoraggiare l’osservatore a confrontare differenti sottoinsiemi di dati; rivelare i dati a diversi livelli di dettaglio, da una visione ampia alla struttura di base; servire ad uno scopo preciso (descrizione, esplorazione, o la risposta a qualche domanda); essere fortemente integrate con le descrizioni statistiche e verbali dei dati fornite nel testo. In base a questi principi, figura 3.7 sembra fornire la rappresentazione migliore dei dati di Zetsche, Bürkner, and Renneberg (2019). Il seguente link fornisce diverse interessanti illustrazioni dei principi elencati sopra. References "],["indici-di-tendenza-centrale.html", "3.10 Indici di tendenza centrale", " 3.10 Indici di tendenza centrale L’analisi grafica, esaminata in precedenza, costituisce la base di partenza di qualsivoglia analisi quantitativa dei dati. Tramite l’analisi grafica possiamo capire alcune caratteristiche importanti di una distribuzione: per esempio, se è simmetrica o asimmetrica; oppure se è unimodale o multimodale. Successivamente, possiamo calcolare degli indici numerici che descrivono in modo sintetico le caratteristiche di base dei dati esaminati. Tra le misure di tendenza centrale, ovvero tra gli indici che forniscono un’idea dei valori attorno ai quali sono prevalentemente concentrati i dati di un campione, quella più comunemente usata è la media. 3.10.1 Media Tutti conosciamo la media aritmetica di \\(\\{x_1, x_2, \\dots, x_n\\}\\), ovvero il numero reale \\(\\bar{x}\\) definito da \\[\\begin{equation} \\bar{x}=\\frac{1}{n}\\sum_{i=1}^n x_i. \\tag{3.1} \\end{equation}\\] Nell’eq. (3.1) abbiamo usato la notazione delle sommatorie per descrivere una somma di valori. Questa notazione è molto usata in statistica e viene descritta in Appendice. La media gode della seguente importante proprietà: la somma degli scarti tra ciascuna modalità \\(x_i\\) e la media aritmetica \\(\\bar{x}\\) è nulla, cioè \\[\\begin{equation} \\sum_{i=1}^n (x_i - \\bar{x}) = 0.\\notag \\label{eq:diffmeansumzero} \\end{equation}\\] Infatti, \\[ \\begin{aligned} \\sum_{i=1}^n (x_i - \\bar{x}) &amp;= \\sum_i x_i - \\sum_i \\bar{x}\\notag\\\\ &amp;= \\sum_i x_i - n \\bar{x}\\notag\\\\ &amp;= \\sum_i x_i - \\sum_i x_i = 0.\\notag \\end{aligned} \\] Ciò ci consente di pensare alla media come al baricentro della distribuzione. Un’altra proprietà della media è la seguente. La somma dei quadrati degli scarti tra ciascuna modalità \\(x_i\\) e una costante arbitraria \\(a\\), cioè \\[\\begin{equation} \\varphi(a) = \\sum_{i=1}^n (x_i - a)^2,\\notag \\end{equation}\\] è minima per \\(a = \\bar{x}\\). Remark. Il concetto statistico di media ha suscitato molte battute. Per esempio, il fatto che, in media, ciascuno di noi ha un numero di gambe circa pari a 1.9999999. Oppure, il fatto che, in media, ciascuno di noi ha un testicolo. Ma la media ha altri problemi, oltre al fatto di ispirare battute simili alle precedenti. In particolare, dobbiamo notare che la media non è sempre l’indice che meglio rappresenta la tendenza centrale di una distribuzione. In particolare, ciò non accade quando la distribuzione è asimmetrica, o in presenza di valori anomali (outlier) – si veda il pannello di destra della figura 3.6. In tali circostanze, la tendenza centrale della distribuzione è meglio rappresentata dalla mediana o dalla media spuntata. 3.10.2 Media spuntata La media spuntata \\(\\bar{x}_t\\) (trimmed mean) non è altro che la media dei dati calcolata considerando solo il 90% (o altra percentuale) dei dati centrali. Per calcolare \\(\\bar{x}_t\\) si ordinando i dati secondo una sequenza crescente, \\(x_1 \\leq x_2 \\leq x_3 \\leq \\dots \\leq x_n\\), per poi eliminare il primo 5% e l’ultimo 5% dei dati della serie così ordinata. La media spuntata è data dalla media aritmetica dei dati rimanenti. 3.10.3 Moda e mediana In precedenza abbiamo già incontrato altri due popolari indici di tendenza centrale: la moda (Mo), ovvero il valore centrale della classe con la frequenza massima (può succedere che una distribuzione abbia più mode; in tal caso si dice multimodale e questo operatore perde il suo significato di indice di tendenza centrale) e la mediana \\(\\tilde{x}\\). Remark. Si noti che solitamente i software restituiscono un valore interpolato del \\(p\\)-esimo quantile \\(q_p\\) \\((0 &lt; p &lt; 1)\\), il quale viene calcolato mediante specifiche procedure. Il risultato fornito dai software, dunque, non sarà identico a quello trovato utilizzando la definizione non interpolata di quantile che abbiamo presentato qui. Se, per qualche ragione, vogliamo conoscere l’algoritmo usato per la determinazione dei quantili interpolati, dobbiamo leggere la documentazione del software. "],["indici-di-dispersione.html", "3.11 Indici di dispersione", " 3.11 Indici di dispersione Le medie e gli indici di posizione descritti in precedenza forniscono delle sintesi dei dati che mettono in evidenza la tendenza centrale delle osservazioni. Tali indici, tuttavia, non considerano un aspetto importante della distribuzione dei dati, ovvero la variabilità dei valori numerici della variabile statistica. È dunque necessario sintetizzare la distribuzione di una variabile statistica oltre che con le misure di posizione anche tramite l’utilizzo di indicatori che valutino la dispersione delle unità statistice. Remark. Un’introduzione “soft” al tema degli indici di posizione è fornita nel seguente link. 3.11.1 Indici basati sull’ordinamento dei dati È possibile calcolare degli indici di variabilità basati sull’ordinamento dei dati. L’indice più ovvio è l’intervallo di variazione, ovvero la distanza tra il valore massimo e il valore minimo di una distribuzione di modalità, mentre in precedenza abbiamo già incontrato la differenza interquartile. Questi due indici, però, hanno il limite di essere calcolati sulla base di due soli valori della distribuzione (\\(x_{\\text{max}}\\) e \\(x_{\\text{mini}}\\), oppure \\(x_{0.25}\\) e \\(x_{0.75}\\)). Pertanto non utilizzano tutte le informazioni che sono disponibili. Inoltre, l’intervallo di variazione ha il limite di essere pesantemente influenzato dalla presenza di valori anomali. 3.11.2 Varianza Dati i limiti delle statistiche precedenti è più comune misurare la variabilità di una variabile statistica come la dispersione dei dati attorno ad un indice di tendenza centrale. Infatti, la misura di variabilità di gran lunga più usata per valutare la variabilità di una variabile statistica è senza dubbio la varianza. La varianza \\[\\begin{equation} s^2 = \\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar{x})^2 \\tag{3.2} \\end{equation}\\] è la media dei quadrati degli scarti \\(x_i - \\bar{x}\\) tra ogni valore e la media della distribuzione. La varianza è una misura di dispersione più complessa di quelle esaminate in precedenza. È appropriata solo nel caso di distribuzioni simmetriche e, anch’essa, è fortemente influenzata dai valori anomali. Inoltre, è espressa in un’unità di misura che è il quadrato dell’unità di misura dei dati originari e quindi ad essa non può essere assegnata un’interpretazione intuitiva. Esercizio 3.9 Si calcoli la varianza dei valori BDI-II per i dati di Zetsche, Bürkner, and Renneberg (2019). Applicando la formula precedente, per tutto il campione abbiamo var(bysubj$bdi) #&gt; [1] 241.9 3.11.3 Precisione Si definisce precisione l’inverso della varianza: \\[\\begin{equation} \\tau = \\frac{1}{\\sigma^2}. \\tag{3.3} \\end{equation}\\] Alcuni ritengono che la precisione sia più “intuitiva” della varianza perché dice quanto sono concentrati i valori attorno alla media piuttosto che quanto sono dispersi. In altri termini, si potrebbe argomentare che siamo più interessati a quanto sia precisa una misurazione piuttosto che a quanto sia imprecisa. Più sono dispersi i valori attorno alla media (alta varianza), meno sono precisi (poca precisione); minore è la varianza, maggiore è la precisione. La precisione è uno dei due parametri naturali della distribuzione gaussiana. Nei termini della (3.3), la distribuzione gaussiana (si veda il Capitolo 11) può essere espressa nel modo seguente \\[ {\\displaystyle f(y)=\\sqrt{\\frac{\\tau}{2\\pi}} e^{-{\\frac {1}{2}}\\tau\\left({y-\\mu }\\right)^{2}}}, \\] anziché come \\[ {\\displaystyle f(y)={\\frac {1}{\\sigma {\\sqrt {2\\pi }}}}e^{-{\\frac {1}{2}}\\left({\\frac {y-\\mu }{\\sigma }}\\right)^{2}}}. \\] 3.11.4 Scarto tipo Per le ragioni espresse sopra, la misura più usata della dispersione di una distribuzione di dati è lo scarto quadratico medio (o scarto tipo, o deviazione standard), ovvero la radice quadrata della varianza5. A differenza della varianza, dunque, lo scarto tipo è espresso nella stessa unità di misura dei dati. Come nel caso della varianza, anche lo scarto tipo \\(s\\) dovrebbe essere usato soltanto quando la media è adeguata per misurare il centro della distribuzione, ovvero, nel caso di distribuzioni simmetriche. Come nel caso della media \\(\\bar{x}\\), anche lo scarto tipo è fortemente influenzato dai dati anomali (outlier), ovvero dalla presenza di uno o di pochi dati che sono molto più distanti dalla media rispetto agli altri valori della distribuzione. Quando tutte le osservazioni sono uguali, \\(s = 0\\), altrimenti \\(s &gt; 0\\). Allo scarto tipo può essere assegnata una semplice interpretazione: lo scarto tipo è simile (ma non identico) allo scarto semplice medio campionario, ovvero alla media aritmetica dei valori assoluti degli scarti dalla media. Lo scarto tipo ci dice, dunque, quanto sono distanti, in media, le singole osservazioni dal centro della distribuzione. Un’interpretazione più precisa del significato dello scarto tipo è fornita nel Paragrafo successivo. Esercizio 3.10 Si calcoli lo scarto tipo per i valori BDI-II di dati di Zetsche, Bürkner, and Renneberg (2019). Applicando la formula precedente, per tutto il campione abbiamo sd(bysubj$bdi) #&gt; [1] 15.55 3.11.5 Deviazione mediana assoluta Una misura robusta della dispersione statistica di un campione è la deviazione mediana assoluta (Median Absolute Deviation, MAD) definita come la mediana del valore assoluto delle deviazioni dei dati dalla mediana, ovvero: \\[ {\\displaystyle \\operatorname {MAD} =\\operatorname {median} \\left(\\ \\left|X_{i}-\\operatorname {median} (X)\\right|\\ \\right)} \\] Nel caso di una distribuzione dei dati unimodale simmetrica di forma campanulare (ovvero, normale) si ha che \\[ {\\displaystyle \\text{deviazione standard} \\approx 1.4826\\ \\operatorname {MAD} .\\,} \\] Pertanto, solitamente i software restituiscono il valore MAD moltiplicato per una tale costante. Esercizio 3.11 Si calcoli il valore MAD per i valori BDI-II riportati da Zetsche, Bürkner, and Renneberg (2019). Applicando la formula precedente, per tutto il campione abbiamo 1.4826 * median(abs(bysubj$bdi - median(bysubj$bdi))) #&gt; [1] 15.57 3.11.6 Indici di variabilità relativi A volte può essere interessante effettuare un confronto fra due misure di variabilità di grandezze incommensurabili, ovvero di caratteri rilevati mediante differenti unità di misura. In questi casi, le misure di variabilità precedentemente descritte si rivelano inadeguate in quanto dipendono dall’unità di misura adottata. Diventa dunque necessario ricorrere a particolari numeri adimensionali detti indici relativi di variabilità. Il più importante di tali indici è il coefficiente di variazione, ovvero il numero puro \\[ C_v = \\frac{\\sigma}{\\bar{x}} \\] ottenuto dal rapporto tra la deviazione standard e la media dei dati. Un altro indice relativo di variabilità è la differenza interquartile rapportata al primo quartile oppure al terzo quartile oppure alla mediana, cioè: \\[ \\frac{x_{0.75} - x_{0.25}}{x_{0.25}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.75}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.50}}. \\] References "],["le-relazioni-tra-variabili.html", "3.12 Le relazioni tra variabili", " 3.12 Le relazioni tra variabili Zetsche, Bürkner, and Renneberg (2019) hanno misurato il livello di depressione dei soggetti del loro esperimento utilizzando due scale psicometriche: il Beck Depression Inventory II (BDI-II) e la Center for Epidemiologic Studies Depression Scale (CES-D). Il BDI-II è uno strumento self-report che valutare la presenza e l’intensità di sintomi depressivi in pazienti adulti e adolescenti di almeno 13 anni di età con diagnosi psichiatrica mentre la CES-D è una scala self-report progettata per misurare i sintomi depressivi che sono stati vissuti nella settimana precedente nella popolazione generale, specialmente quella degli adolescenti/giovani adulti. Una domanda ovvia che ci può venire in mente è: quanto sono simili le misure ottenute mediante queste due scale? È chiaro che i numeri prodotti dalle scale BDI-II e CES-D non possono essere identici, e questo per due motivi: (1) la presenza degli errori di misurazione e (2) l’unità di misura delle due variabili. L’errore di misurazione corrompe sempre, almeno in parte, qualunque operazione di misurazione. E questo è vero specialmente in psicologia dove l’attendibilità degli strumenti di misurazione è minore che in altre discipline (quali la fisica, ad esempio). Il secondo motivo per cui i valori delle scale BDI-II e CES-D non possono essere uguali è che l’unità di misura delle due scale è arbitraria. Infatti, qual è l’unità di misura della depressione? Chi può dirlo! Ma, al di là delle differenze derivanti dall’errore di misurazione e dalla differente unità di misura, ci aspettiamo che, se le due scale misurano entrambe lo stesso costrutto, allora i valori prodotti dalle due scale dovranno essere tra loro linearmente associati. Per capire cosa si intende con “associazione lineare” iniziamo a guardare i dati. Per fare questo utilizziamo una rappresentazione grafica che va sotto il nome di diagramma a dispersione. 3.12.1 Diagramma a dispersione Il diagramma di dispersione è la rappresentazione grafica delle coppie di punti individuati da due variabili \\(X\\) e \\(Y\\). Esercizio 3.12 Si costruisca il diagramma di dispersione per le variabili BDI-II e CES-D di Zetsche, Bürkner, and Renneberg (2019). Il diagramma di dispersione per le variabili BDI-II e CES-D si ottiene ponendo, ad esempio, i valori BDI-II sull’asse delle ascisse e quelli del CES-D sull’asse delle ordinate. In tale grafico, fornito dalla figura 3.8, cascun punto corrisponde ad un individuo del quale, nel caso presente, conosciamo il livello di depressione misurato dalle due scale psicometriche. Dalla figura 3.8 possiamo vedere che i dati mostrano una tendenza a disporsi attorno ad una retta – nel gergo statistico, questo fatto viene espresso dicendo che i punteggi CES-Dtendono ad essere linearmente associati ai punteggi BDI-II. È ovvio, tuttavia, che tale relazione lineare è lungi dall’essere perfetta – se fosse perfetta, tutti i punti del diagramma a dispersione si disporrebbero esattamente lungo una retta. bysubj &lt;- df %&gt;% group_by(esm_id, group) %&gt;% summarise( bdi = mean(bdi), cesd = mean(cesd_sum) ) %&gt;% na.omit() %&gt;% ungroup() m_cesd &lt;- bysubj %&gt;% dplyr::pull(cesd) %&gt;% mean() m_bdi &lt;- bysubj %&gt;% dplyr::pull(bdi) %&gt;% mean() FONT_SIZE &lt;- 9 bysubj %&gt;% ggplot( aes(x = bdi, y = cesd, color = group) ) + geom_point(size = 3, alpha = .9) + geom_hline(yintercept = m_cesd, linetype = &quot;dashed&quot;, color = &quot;gray&quot;) + geom_vline(xintercept = m_bdi, linetype = &quot;dashed&quot;, color = &quot;gray&quot;) + geom_text(x = -1, y = 16, label = &quot;I&quot;, color = &quot;gray&quot;, size = FONT_SIZE) + geom_text(x = 0, y = 46, label = &quot;IV&quot;, color = &quot;gray&quot;, size = FONT_SIZE) + geom_text(x = 18, y = 46, label = &quot;III&quot;, color = &quot;gray&quot;, size = FONT_SIZE) + geom_text(x = 18, y = 16, label = &quot;II&quot;, color = &quot;gray&quot;, size = FONT_SIZE) + labs( x = &quot;BDI-II&quot;, y = &quot;CESD&quot; ) + theme(legend.position = &quot;none&quot;) + scale_colour_grey(start = 0.7, end = 0) FIGURA 3.8: Associazione tra le variabili BDI-II e CES-D nello studio di Zetsche et al. (2019). In grigio sono rappresentate le osservazioni del gruppo di controllo; in nero quelle dei pazienti. 3.12.2 Covarianza Il problema che ci poniamo è quello di trovare un indice numerico che descriva di quanto la nube di punti si discosta da una perfetta relazione lineare tra le due variabili. Per risolvere tale problema dobbiamo specificare un indice statistico che descriva la direzione e la forza della relazione lineare tra le due variabili. Ci sono vari indici statistici che possiamo utilizzare a questo scopo. Iniziamo a considerare il più importante di tali indici, chiamato covarianza. In realtà la definizione di questo indice non ci sorprenderà più di tanto in quanto, in una forma solo apparentemente diversa, l’abbiamo già incontrato in precedenza. Ci ricordiamo infatti che la varianza di una generica variabile \\(X\\) è definita come la media degli scarti quadratici di ciascuna osservazione dalla media: \\[\\begin{equation} S_{XX} = \\frac{1}{n} \\sum_{i=1}^n(X_i - \\bar{X}) (X_i - \\bar{X}). \\tag{3.4} \\end{equation}\\] Infatti, la varianza viene talvolta descritta come la “covarianza di una variabile con sé stessa”. Adesso facciamo un passo ulteriore. Invece di valutare la dispersione di una sola variabile, chiediamoci come due variabili \\(X\\) e \\(Y\\) “variano insieme” (co-variano). È facile capire come una risposta a tale domanda possa essere fornita da una semplice trasformazione della formula precedente che diventa: \\[\\begin{equation} S_{XY} = \\frac{1}{n} \\sum_{i=1}^n(X_i - \\bar{X}) (Y_i - \\bar{Y}). \\tag{3.5} \\end{equation}\\] L’eq. (3.5) ci fornisce dunque la definizione della covarianza. Per capire il significato dell’eq. (3.5), supponiamo di dividere il grafico della figura 3.8 in quattro quadranti definiti da una retta verticale passante per la media dei valori BDI-II e da una retta orizzontale passante per la media dei valori CES-D. Numeriamo i quadranti partendo da quello in basso a sinistra e muovendoci in senso antiorario. Se prevalgono punti nel I e III quadrante, allora la nuvola di punti avrà un andamento crescente (per cui a valori bassi di \\(X\\) tendono ad associarsi valori bassi di \\(Y\\) e a valori elevati di \\(X\\) tendono ad associarsi valori elevati di \\(Y\\)) e la covarianza segno positivo. Mentre se prevalgono punti nel II e IV quadrante la nuvola di punti avrà un andamento decrescente (per cui a valori bassi di \\(X\\) tendono ad associarsi valori elevati di \\(Y\\) e a valori elevati di \\(X\\) tendono ad associarsi valori bassi di \\(Y\\)) e la covarianza segno negativo. Dunque, il segno della covarianza ci informa sulla direzione della relazione lineare tra due variabili: l’associazione lineare si dice positiva se la covarianza è positiva, negativa se la covarianza è negativa. Il segno della covarianza ci informa sulla direzione della relazione, ma invece il valore assoluto della covarianza ci dice ben poco. Esso, infatti, dipende dall’unità di misura delle variabili. Nel caso presente questo concetto è difficile da comprendere, dato che le due variabili in esame non hanno un’unità di misura (ovvero, hanno un’unità di misura arbitraria e priva di significato). Ma quest’idea diventa chiara se pensiamo alla relazione lineare tra l’altezza e il peso delle persone, ad esempio. La covarianza tra queste due quantità è certamente positiva, ma il valore assoluto della covarianza diventa più grande se l’altezza viene misurata in millimetri e il peso in grammi, e diventa più piccolo l’altezza viene misurata in metri e il peso in chilogrammi. Dunque, il valore della covarianza cambia al mutare dell’unità di misura delle variabili anche se l’associazione tra le variabili resta costante. 3.12.3 Correlazione Dato che il valore assoluto della covarianza è di difficile interpretazione – in pratica, non viene mai interpretato – è necessario trasformare la covarianza in modo tale da renderla immune alle trasformazioni dell’unità di misura delle variabili. Questa operazione si dice standardizzazione e corrisponde alla divisione della covarianza per le deviazioni standard (\\(s_X\\), \\(s_Y\\)) delle due variabili: \\[\\begin{equation} r_{XY} = \\frac{S_{XY}}{s_X s_Y}. \\tag{3.6} \\end{equation}\\] La quantià che si ottiene in questo modo viene chiamata correlazione di Bravais-Pearson (dal nome degli autori che, indipendentemente l’uno dall’altro, la hanno introdotta). Il coefficiente di correlazione ha le seguenti proprietà: ha lo stesso segno della covarianza, dato che si ottiene dividendo la covarianza per due numeri positivi; è un numero puro, cioè non dipende dall’unità di misura delle variabili; assume valori compresi tra -1 e +1. Ad esso possiamo assegnare la seguente interpretazione: \\(r_{XY} = -1\\) \\(\\rightarrow\\) perfetta relazione negativa: tutti i punti si trovano esattamente su una retta con pendenza negativa (dal quadrante in alto a sinistra al quadrante in basso a destra); \\(r_{XY} = +1\\) \\(\\rightarrow\\) perfetta relazione positiva: tutti i punti si trovano esattamente su una retta con pendenza positiva (dal quadrante in basso a sinistra al quadrante in alto a destra); \\(-1 &lt; r_{XY} &lt; +1\\) \\(\\rightarrow\\) presenza di una relazione lineare di intensità diversa; \\(r_{XY} = 0\\) \\(\\rightarrow\\) assenza di relazione lineare tra \\(X\\) e \\(Y\\). Esercizio 3.13 Per i dati della figura 3.8, la covarianza è 207.426. Il segno positivo della covarianza ci dice che tra le due variabili c’è un’associazione lineare positiva. Per capire qual è l’intensità della relazione lineare tra le due variabili calcoliamo la correlazione. Essendo le deviazioni standard del BDI-II e del CES-D rispettavamente uguali a 15.37 e 14.93, la correlazione diventa uguale a \\(\\frac{207.426}{15.38 \\cdot 14.93} = 0.904.\\) Tale valore è prossimo a 1.0, il che vuol dire che i punti del diagramma a dispersione non si discostano troppo da una retta con una pendenza positiva. References "],["correlazione-e-causazione.html", "3.13 Correlazione e causazione", " 3.13 Correlazione e causazione Facendo riferimento nuovamente alla figura 3.8, possiamo dire che, in molte applicazioni (ma non nel caso presente!) l’asse \\(x\\) rappresenta una quantità nota come variabile indipendente e l’interesse si concentra sulla sua influenza sulla variabile dipendente tracciata sull’asse \\(y\\). Ciò presuppone però che sia nota la direzione in cui l’influenza causale potrebbe risiedere. È importante tenere bene a mente che la correlazione è soltanto un indice descrittivo della relazione lineare tra due variabili e in nessun caso può essere usata per inferire alcunché sulle relazioni causali che legano le variabili. È ben nota l’espressione: “correlazione non significa causazione”. Di opinione diversa era invece Karl Pearson (1911), il quale ha affermato: “Quanto spesso, quando è stato osservato un nuovo fenomeno, sentiamo che viene posta la domanda: ‘qual è la sua causa?’. Questa è una domanda a cui potrebbe essere assolutamente impossibile rispondere. Invece, può essere più facile rispondere alla domanda: ‘in che misura altri fenomeni sono associati con esso?’. Dalla risposta a questa seconda domanda possono risultare molte preziose conoscenze.” Che alla seconda domanda posta da Pearson sia facile rispondere è indubbio. Che la nostra comprensione di un fenomeno possa aumentare sulla base delle informazioni fornite unicamente dalle correlazioni, invece, è molto dubbio e quasi certamente falso. 3.13.1 Usi della correlazione Anche se non può essere usata per studiare le relazioni causali, la correlazione viene usata per molti altri scopi tra i quali, per esempio, quello di misurare la validità concorrente di un test psiologico. Se un test psicologico misura effettivamente ciò che ci si aspetta che misuri (nel caso dell’esempio presente, la depressione), allora dovremo aspettarci che fornisca una correlazione alta con risultati di altri test che misurano lo stesso costrutto – come nel caso dei dati di (Zetsche, Bürkner, and Renneberg 2019). Un’altra proprietà desiderabile di un test psicometrico è la validità divergente: i risultati di test psicometrici che misurano costrutti diversi dovrebbero essere poco associati tra loro. In altre parole, in questo secondo caso dovremmo aspettarci che la correlazione sia bassa. 3.13.2 Correlazione di Spearman Una misura alternativa della relazione lineare tra due variabili è fornita dal coefficiente di correlazione di Spearman e dipende soltanto dalla relazione d’ordine dei dati, non dagli specifici valori dei dati. Tale misura di associazione è appropriata quando, del fenomeno in esame, gli psicologi sono stati in grado di misurare soltanto le relazioni d’ordine tra le diverse modalità della risposta dei soggetti, non l’intensità della risposta. Le variabili psicologiche che hanno questa proprietà si dicono ordinali. Nel caso di variabili ordinali, non è possibile sintetizzare i dati mediante le statistiche descrittive che abbiamo introdotto in questo capitolo, quali ad esempio la media e la varianza, ma è invece solo possibile riassumere i dati mediante una distribuzione di frequenze per le varie modalità della risposta. 3.13.3 Correlazione nulla Un ultimo aspetto da mettere in evidenza a proposito della correlazione riguarda il fatto che la correlazione descrive la direzione e l’intensità della relazione lineare tra due variabili. Relazioni non lineari tra le variabili, anche se sono molto forti, non vengono catturate dalla correlazione. È importante rendersi conto che una correlazione pari a zero non significa che non c’è relazione tra le due variabili, ma solo che tra esse non c’è una relazione lineare. Esercizio 3.14 La figura 3.9 fornisce un esempio di correlazione nulla in presenza di una chiara relazione (non lineare) tra due variabili. FIGURA 3.9: Due insiemi di dati (fittizi) per i quali i coefficienti di correlazione di Pearson sono entrambi 0. Ma questo non significa che non vi sia alcuna relazione tra le variabili. References "],["considerazioni-conclusive.html", "Considerazioni conclusive", " Considerazioni conclusive La prima fase dell’analisi dei dati ci porta a riassumere i dati mediante gli strumenti della statistica descrittiva. Le tipiche domande che vengono affrontate in questa fase sono: qual è la distribuzione delle variabili di interesse? Quali relazioni a coppie si possono osservare nel campione? Ci sono delle osservazioni ‘anomale’, ovvero estremamente discrepanti rispetto alle altre, sia quando si esaminano le statistiche descrittive univariate (ovvero, quelle che riguardano le caratteristiche di una variabile presa singolarmente), sia quando vengono esaminate le statistiche bivariate (ovvero, le statistiche che descrivono l’associazione tra le variabili)? È importante avere ben chiare le idee su questi punti prima di procedere con qualsiasi procedura statistica di tipo inferenziale. Per rispondere alle domande che abbiamo elencato sopra, ed ad altre simili, è molto utile procedere con delle rappresentazioni grafiche dei dati. È chiaro che, quando disponiamo di grandi moli di dati (come è sempre il caso in psicologia), le operazioni descritte sopra devono essere svolte mediante un software statistico. "],["intro-prob-1.html", "Capitolo 4 Il calcolo delle probabilità", " Capitolo 4 Il calcolo delle probabilità Una possibile definizione di teoria delle probabilità è la seguente: la teoria delle probabilità ci fornisce gli strumenti per prendere decisioni razionali in condizioni di incertezza, ovvero per formulare le migliori congetture possibili. "],["inf-stat-probl-inv.html", "4.1 La probabilità come la logica della scienza", " 4.1 La probabilità come la logica della scienza La figura 4.1 fornisce una rappresentazione schematica del processo dell’indagine scientifica. Possiamo pensare al progresso scientifico come alla ripetizione di questo ciclo, laddove i fenomeni naturali (e, ovviamente psicologici) vengono esplorati e i ricercatori imparano sempre di più sul loro funzionamento. Le caselle della figura descrivono le varie fasi del processo di ingagine scientifica, mentre lungo le frecce sono riportati i compiti che conducono i ricercatori da una fase alla successiva. FIGURA 4.1: Rappresentazione schematica del processo scientifico (figura adattata dalla Fig. 1.1 di P. Gregory, Bayesian Logical Data Analysis for the Physical Sciences, Cambridge, 2005). Consideriamo i compiti e le fasi dell’indagine scientifica. Iniziamo in basso a sinistra. Invenzione e perfezionamento delle ipotesi. In questa fase del processo scientifico, i ricercatori pensano ai fenomeni naturali, a ciò che è presente nella letteratura scientifica, ai risultati dei loro esperimenti, e formulano ipotesi o teorie che possono essere valutare mediante esperimenti empirici. Questo passaggio richiede innovazione e creatività. L’inferenza deduttiva procede in maniera deterministica dai fatti alle conclusioni. Ad esempio, se dico che tutti gli uomini sono mortali e che Socrate è un uomo, allora posso concludere deduttivamente che Socrate è mortale. Quando i ricercatori progettano gli esperimenti in base alle teorie, usano la logica deduttiva per dire: “Se A è vero, allora B deve essere vero”, dove \\(A\\) è l’ipotesi teorica e \\(B\\) è l’osservazione sperimentale. Esecuzione degli esperimenti. Questa fase richiede molte risorse (tempo e denaro). Richiede anche innovazione e creatività. Nello specifico, i ricercatori devono pensare attentamente a come costruire l’esperimento necessario per verificare la teoria di interesse. Quale risultato dell’esperimento si ottengono i dati. L’inferenza induttiva procede dalle osservazioni ai fatti. Se pensiamo ai fatti come a ciò che governa o genera le osservazioni, allora l’induzione è una sorta di inferenza inversa. Supponiamo di avere osservato \\(B\\). Questo rende \\(A\\) vero? Non necessariamente. Ma può rendere \\(A\\) più plausibile. Questo è un sillogismo debole. Ad esempio, si consideri la seguente coppia ipotesi/osservazioni. \\(A\\) = L’iniezione di acque reflue dopo la fratturazione idraulica, nota come fracking, può portare a una maggiore frequenza di terremoti. \\(B\\) = La frequenza dei terremoti in Oklahoma è aumentata di 100 volte dal 2010, quando il fracking è diventato una pratica comune. Poiché \\(B\\) è stato osservato, \\(A\\) è più plausibile. \\(A\\) non è necessariamente vero, ma è più plausibile. L’inferenza statistica è un tipo di inferenza induttiva che è specificamente formulata come un problema inverso. L’inferenza statistica è quell’insieme di procedure che hanno lo scopo di quantificare quanto più plausibile sia \\(A\\) dopo aver osservato \\(B\\). Per svolgere l’inferenza statistica è dunque necessario quantificare tale plausibilità. Lo strumento che ci consente di fare questo è la teoria delle probabilità. L’inferenza statistica è l’aspetto del processo dell’indagine scientifica che è l’oggetto centrale di questo insegnamento. Il risultato dell’inferenza statistica è la conoscenza di quanto siano plausibili le ipotesi e le stime dei parametri sotto le ipotesi considerate. Ma l’inferenza statistica richiede una teoria delle probabilità, laddove la teoria delle probabilità può essere vista come una generalizzazione della logica. A causa di questa connessione con la logica e del suo ruolo cruciale nella scienza, E. T. Jaynes afferma infatti che la probabilità è la “logica della scienza”. È dunque necessario esaminare preliminarmente alcune nozioni di base della teoria delle probabilità. "],["che-cosè-la-probabilità.html", "4.2 Che cos’è la probabilità?", " 4.2 Che cos’è la probabilità? La definizione della probabilità è un problema estremamente dibattuto ed aperto. Sono state fornite due possibili soluzioni al problema di definire il concetto di probabilità. La natura della probabilità è “ontologica” (ovvero, basata sulla metafisica): la probabilità è una proprietà della della realtà, del mondo, di come sono le cose, indipendentemente dalla nostra esperienza. È una visione che qualcuno chiama “oggettiva”. La natura della probabilità è “epistemica” (ovvero, basata sulla conoscenza): la probabilità si riferisce alla conoscenza che abbiamo del mondo, non al mondo in sé. Di conseguenza è detta, in contrapposizione alla precedente definizione, “soggettiva”. In termini epistemici, la probabilità fornisce una misura della nostra incertezza sul verificarsi di un fenomeno, alla luce delle informazioni disponibili. Potremmo dire che c’è una “scala” naturale che ha per estremi il vero (1: evento certo) da una parte ed il falso (0: evento impossibile) dall’altra. La probabilità è la quantificazione di questa scala: quantifica lo stato della nostra incertezza rispetto al contenuto di verità di una proposizione (ovvero, quantifica la plausibilità di una proposizione). Nell’interpretazione frequentista della probabilità, la probabilità \\(P(A)\\) rappresenta la frequenza relativa a lungo termine nel caso di un grande numero di ripetizioni di un esperimento casuale sotto le medesime condizioni. L’evento \\(A\\) deve essere una proposizione relativa alle variabili casuali6. Nell’interpretazione bayesiana della probabilità \\(P(A)\\) rappresenta il grado di credenza, o plausibilità, a proposito di \\(A\\), dove \\(A\\) può essere qualsiasi proposizione logica. In questo insegnamento utilizzeremo l’interpretazione bayesiana della probabilità. Possiamo citare De Finetti, ad esempio, il quale ha formulato la seguente definizione “soggettiva” di probabilità la quale risulta applicabile anche ad esperimenti casuali i cui eventi elementari non siano ritenuti ugualmente possibili e che non siano necessariamente ripetibili più volte sotto le stesse condizioni: Definizione 4.1 La probabilità di un evento \\(E\\) è la quota \\(p(E)\\) che un individuo reputa di dover pagare ad un banco per ricevere “1” ovvero “0” verificandosi o non verificandosi \\(E\\). Le valutazioni di probabilità degli eventi devono rispondere ai pricipi di equità e coerenza. I principi di equità e coerenza sono definiti come segue. Definizione 4.2 Una scommessa risponde ai pricipi di equità se il ruolo di banco e giocatore sono scambiabili in ogni momento del gioco e sempre alle stesse condizioni; coerenza se non vi sono combinazioni di scommesse che consentano (sia al banco che al giocatore) di realizzare perdite o vincite certe. Secondo Finetti (1931), nessuna scienza ci permetterà di dire: il tale fatto accadrà, andrà così e così, perché ciò è conseguenza di tale legge, e tale legge è una verità assoluta, ma tanto meno ci condurrà a concludere scetticamente: la verità assoluta non esiste, e quindi tale fatto può accadere e può non accadere, può andare così e può andare in tutt’altro modo, nulla io ne so. Quel che si potrà dire è questo: io prevedo che il tale fatto avverrà, e avverrà nel tal modo, perché l’esperienza del passato e l’elaborazione scientifica cui il pensiero dell’uomo l’ha sottoposta mi fanno sembrare ragionevole questa previsione. In altri termini, de Finetti ritiene che la probabilità debba essere concepita non come una proprietà “oggettiva” dei fenomeni (“la probabilità di un fenomeno ha un valore determinato che dobbiamo solo scoprire”), ma bensì come il “grado di fiducia – in inglese degree of belief – di un dato soggetto, in un dato istante e con un dato insieme d’informazioni, riguardo al verificarsi di un evento”. Per denotare sia la probabilità (soggettiva) di un evento sia il concetto di valore atteso (che descriveremo in seguito), Finetti (1970) utilizza il termine “previsione” (e lo stesso simbolo \\(P\\)): la previsione [\\(\\dots\\)] consiste nel considerare ponderatamente tutte le alternative possibili per ripartire fra di esse nel modo che parrà più appropriato le proprie aspettative, le proprie sensazioni di probabilità. References "],["variabili-casuali-e-probabilità-di-un-evento.html", "4.3 Variabili casuali e probabilità di un evento", " 4.3 Variabili casuali e probabilità di un evento Esaminiamo qui di seguito alcuni concetti di base della teoria delle probabilità. 4.3.1 Variabili casuali Sia \\(Y\\) il risultato del lancio di moneta equilibrata, non di un generico lancio di una moneta, ma un’istanza specifica del lancio di una specifica moneta in un dato momento. Definita in questo modo, \\(Y\\) è una variabile casuale, ovvero una variabile che assume valori diversi con probabilità diverse. Se la moneta è equilibrata, c’è una probabilità del 50% che il lancio della moneta dia come risultato “testa” e una probabilità del 50% che dia come risultato “croce”. Per facilitare la trattazione, le variabili casuali assumono solo valori numerici. Per lo specifico lancio della moneta in questione, diciamo, ad esempio, che la variabile casuale \\(Y\\) assume il valore 1 se esce testa e il valore 0 se esce croce. 4.3.2 Eventi e probabilità Nella teoria delle probabilità il risultato “testa” nel lancio di una moneta è chiamato evento.7 Ad esempio, \\(Y\\) = 1 denota l’evento in cui il lancio di una moneta produce come risultato testa. Il funzionale \\(Pr[·]\\) definisce la probabilità di un evento. Ad esempio, per il lancio di una moneta equilibrata, la probabilità dell’evento “il risultato del lancio della moneta è testa” è scritta come \\[ Pr[Y = 1] = 0.5. \\] Se la moneta è equilibrata dobbiamo anche avere \\(Pr[Y = 0] = 0.5\\). I due eventi Y = 1 e \\(Y\\) = 0 sono mutuamente esclusivi nel senso che non possono entrambi verificarsi contemporaneamente. Nella notazione probabilistica, \\[ Pr[Y = 1\\; e \\; Y = 0] = 0. \\] Gli eventi \\(Y\\) = 1 e \\(Y\\) = 0 di dicono esaustivi, nel senso che almeno uno di essi deve verificarsi e nessun altro tipo di evento è possibile. Nella notazione probabilistica, \\[ Pr[Y = 1\\; o \\; Y = 0] = 1. \\] Il connettivo logico “e” specifica eventi congiunti, ovvero eventi che possono verificarsi contemporaneamente (eventi compatibili) e per i quali, perciò, la probabilità della loro congiunzione è \\(Pr(A \\; e \\; B) &gt; 0\\). Il connettivo logico “o” specifica eventi disgiunti, ovvero eventi che non possono verificarsi contemporaneamente (eventi incompatibili) e per i quali, perciò, la probabilità della loro congiunzione è \\(P(A \\; e \\; B) = 0\\). Per un ripasso delle nozioni di base della teoria degli insiemi, si veda l’Appendice ??.↩︎ "],["spazio-campionario-e-risultati-possibili.html", "4.4 Spazio campionario e risultati possibili", " 4.4 Spazio campionario e risultati possibili Anche se il lancio di una moneta produce sempre uno specifico risultato nel mondo reale, noi possiamo anche immaginare i possibili risultati alternativi che si sarebbero potuti osservare. Quindi, anche se in uno specifico lancio la moneta dà testa (\\(Y\\) = 1), possiamo immaginare la possibilità che il lancio possa avere prodotto croce (\\(Y\\) = 0). Tale ragionamento controfattuale è la chiave per comprendere la teoria delle probabilità e l’inferenza statistica. I risultati possibili che si possono osservare come conseguenza del lancio di una moneta determinano i valori possibili che la variabile casuale può assumere. L’insieme di tutti i risultati possibili è chiamato spazio campionario. Lo spazio campionario può essere concettualizzato come un’urna contenente una pallina per ogni possibile risultato del lancio della moneta. Su ogni pallina è scritto il valore della variabile casuale. Uno specifico lancio di una moneta – ovvero, l’osservazione di uno specifico valore di una variabile casuale – è chiamato esperimento casuale. Il lancio di un dado ci fornisce l’esempio di un altro esperimento casuale. Supponiamo di essere interessati all’evento “il lancio del dado produce un numero dispari”. Un evento seleziona un sottoinsieme dello spazio campionario: in questo caso, l’insieme dei risultati \\(\\{1, 3, 5\\}\\). Se esce 3, per esempio, diciamo che si è verificato l’evento “dispari” (ma l’evento “dispari” si sarebbe anche verificato anche se fosse uscito 1 o 5). "],["usare-la-simulazione-per-stimare-le-probabilità.html", "4.5 Usare la simulazione per stimare le probabilità", " 4.5 Usare la simulazione per stimare le probabilità I metodi basati sulla simulazione ci consentono di stimare le probabilità degli eventi in un modo diretto se siamo in grado di generare realizzazioni molteplici e casuali delle variabili casuali coinvolte nelle definizioni degli eventi. Per simulare il lancio di una moneta equilibrata in R iniziamo a definire un vettore che contiene i possibili risultati del lancio della moneta (ovvero i possibili valori della variabile casuale \\(Y\\)): coin &lt;- c(0, 1) L’estrazione casuale di uno di questi due possibili valori (ovvero, la simulazione di uno specifico lancio di una moneta) si realizza con la funzione sample(): sample(coin, size = 1) #&gt; [1] 0 In maniera equivalente, lo stesso risultato si ottiene mediante l’istruzione rbinom(1, 1, 0.5) #&gt; [1] 1 Supponiamo di ripetere questo esperimento casuale 100 volte e di registrare i risultati così ottenuti. La stima della probabilità dell’evento \\(Pr[Y = 1]\\) è data dalla frequenza relativa del numero di volte in cui abbiamo osservato l’evento di interesse (\\(Y = 1\\)): M &lt;- 10 y &lt;- rep(NA, M) for (m in 1:M) { y[m] = rbinom(1, 1, 0.5) } estimate = sum(y) / M cat(&quot;estimated Pr[Y = 1] =&quot;, estimate) #&gt; estimated Pr[Y = 1] = 0.5 Ripetiamo questa procedura 10 volte. flip_coin &lt;- function(M) { y &lt;- rep(NA, M) for (m in 1:M) { y[m] = rbinom(1, 1, 0.5) } estimate &lt;- sum(y) / M cat(&quot;estimated Pr[Y = 1] =&quot;, estimate, &quot;\\n&quot;) } for(i in 1:10) { flip_coin(10) } #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.3 #&gt; estimated Pr[Y = 1] = 0.7 #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.6 #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.8 #&gt; estimated Pr[Y = 1] = 0.4 #&gt; estimated Pr[Y = 1] = 0.5 Dato che la moneta è equilibrata, la stima delle probabilità dell’evento \\(Pr[Y = 1]\\) è simile a al valore che ci aspettiamo (\\(Pr[Y = 1]\\) = 0.5), ma il risultato ottenuto nelle varie simulazioni non è sempre esatto. Proviamo ad aumentare il numero di lanci in ciascuna simulazione: for(i in 1:10) { flip_coin(100) } #&gt; estimated Pr[Y = 1] = 0.44 #&gt; estimated Pr[Y = 1] = 0.53 #&gt; estimated Pr[Y = 1] = 0.43 #&gt; estimated Pr[Y = 1] = 0.58 #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.41 #&gt; estimated Pr[Y = 1] = 0.51 #&gt; estimated Pr[Y = 1] = 0.49 #&gt; estimated Pr[Y = 1] = 0.5 #&gt; estimated Pr[Y = 1] = 0.57 In questo secondo caso, gli errori tendono ad essere più piccoli della simulazione precedente. Cosa succede se in ciascuna simulazione esaminiamo i risultati di 10,000 lanci della moneta? for(i in 1:10) { flip_coin(1e4) } #&gt; estimated Pr[Y = 1] = 0.5029 #&gt; estimated Pr[Y = 1] = 0.4886 #&gt; estimated Pr[Y = 1] = 0.4956 #&gt; estimated Pr[Y = 1] = 0.49 #&gt; estimated Pr[Y = 1] = 0.5032 #&gt; estimated Pr[Y = 1] = 0.5051 #&gt; estimated Pr[Y = 1] = 0.4928 #&gt; estimated Pr[Y = 1] = 0.4968 #&gt; estimated Pr[Y = 1] = 0.4991 #&gt; estimated Pr[Y = 1] = 0.4976 Ora le stime ottenute sono molto vicine alla vera probabilità che vogliamo stimare (cioè 0.5, perché la moneta è equilibrata). I risultati delle simulazioni precedenti pongono dunque il problema di determinare quale sia il numero di lanci di cui abbiamo bisogno per assicurarci che le stime siano accurate (ovvero, vicine al valore corretto della probabilità) "],["la-legge-dei-grandi-numeri.html", "4.6 La legge dei grandi numeri", " 4.6 La legge dei grandi numeri La visualizzazione mediante grafici contribuisce alla comprensione dei concetti della statistica e della teoria delle probabilità. Un modo per descrivere ciò che accade all’aumentare del numero \\(M\\) di ripetizioni del lancio della moneta consiste nel registrare la stima della probabilità dell’evento \\(Pr[Y = 1]\\) in funzione del numero di ripetizioni dell’esperimento casuale per ogni \\(m \\in 1 : M.\\) Un grafico dell’andamento della stima di \\(Pr[Y = 1]\\) in funzione di \\(m\\) si ottiene nel modo seguente. nrep &lt;- 1e4 estimate &lt;- rep(NA, nrep) flip_coin &lt;- function(m) { y &lt;- rbinom(m, 1, 0.5) phat &lt;- sum(y) / m phat } for(i in 1:nrep) { estimate[i] &lt;- flip_coin(i) } d &lt;- data.frame( n = 1:nrep, estimate ) d %&gt;% ggplot( aes(x = n, y = estimate) ) + geom_line() + theme(legend.title = element_blank()) + labs( x = &quot;Numero di lanci della moneta&quot;, y = &quot;Stima Pr[Y = 1]&quot; ) FIGURA 4.2: Stima della probabilità di successo in funzione del numero di lanci di una moneta. Dato che il grafico 4.2 su una scala lineare non rivela chiaramente l’andamento della simulazione, utilizzeremo invece un grafico in cui sull’asse \\(x\\) è stata imposta una scala logaritmica. Con l’asse \\(x\\) su scala logaritmica, i valori tra 1 e 10 vengono tracciati all’incirca con la stessa ampiezza come nel caso dei valori tra 50 e 700, eccetera. d %&gt;% ggplot( aes(x = n, y = estimate) ) + geom_line() + scale_x_log10( breaks = c(1, 3, 10, 50, 200, 700, 2500, 10000) ) + theme(legend.title = element_blank()) + labs( x = &quot;Numero di lanci della moneta&quot;, y = &quot;Stima Pr[Y = 1]&quot; ) FIGURA 4.3: Stima della probabilità di successo in funzione del numero di lanci di una moneta – scala logaritmica. La legge dei grandi numeri ci dice che all’aumentare del numero di ripetizioni dell’esperimento casuale la media dei risultati ottenuti tenderà ad avvicinarsi al valore atteso man mano che verranno eseguite più prove. Nel caso presente, la figura 4.3 mostra appunto che, all’aumentare del numero M di lanci della moneta, la stima di \\(Pr[Y = 1]\\) tende a convergere al vero valore di 0.5. "],["variabili-casuali-multiple.html", "4.7 Variabili casuali multiple", " 4.7 Variabili casuali multiple Le variabili casuali non esistono isolatamente. Abbiamo iniziato con una singola variabile casuale Y che rappresenta il risultato di un singolo, specifico lancio di una moneta equlibrata. Ma supponiamo ora di lanciare la moneta tre volte. Ciò suggerisce che possiamo avere le variabili casuali \\(Y_1 , Y_2 , Y_3\\) che rappresentano i risultati di ciascuno dei lanci. Possiamo assumere che ogni lancio sia indipendente, ovvero che non dipenda dal risultato degli altri lanci. Ognuna di queste variabili \\(Y_n\\) per \\(n \\in 1:3\\) ha \\(Pr[Y_n =1]=0.5\\) e \\(Pr[Y_n =0]=0.5\\). Possiamo combinare più variabili casuali usando le operazioni aritmetiche. Se \\(Y_1 , Y_2, Y_3\\) sono variabili casuali che rappresentano tre lanci di una moneta equilibrata (o un lancio di tre monete equilibrate), possiamo definire la somma di tali variabili casuali come \\[ Z = Y_1 + Y_2 + Y_3. \\] Possiamo simulare i valori assunti dalla variabile casuale Z simulando i valori di \\(Y_1, Y_2, Y_3\\) per poi sommarli. y1 &lt;- rbinom(1, 1, 0.5) y2 &lt;- rbinom(1, 1, 0.5) y3 &lt;- rbinom(1, 1, 0.5) c(y1, y2, y3) #&gt; [1] 0 0 1 z &lt;- sum(c(y1, y2, y3)) cat(&quot;z =&quot;, z, &quot;\\n&quot;) #&gt; z = 1 ovvero, y &lt;- rep(NA, 3) for (i in 1:3) { y[i] &lt;- rbinom(1, 1, 0.5) } y #&gt; [1] 1 0 0 z &lt;- sum(y) cat(&quot;z =&quot;, z, &quot;\\n&quot;) #&gt; z = 1 oppure, ancora più semplicemente: y &lt;- rbinom(3, 1, 0.5) y #&gt; [1] 0 1 1 z &lt;- sum(y) cat(&quot;z =&quot;, z, &quot;\\n&quot;) #&gt; z = 2 Possiamo ripetere questa simulazione \\(M = 1e5\\) volte: M &lt;- 1e5 z &lt;- rep(NA, M) for(i in 1:M) { y &lt;- rbinom(3, 1, 0.5) z[i] &lt;- sum(y) } e calcolare una stima della probabilità che la variabile casuale \\(Z\\) assuma i valori 0, 1, 2, 3: table(z) / M #&gt; z #&gt; 0 1 2 3 #&gt; 0.1256 0.3750 0.3749 0.1245 Nel caso di 4 monete equilibrate, avremo: M &lt;- 1e5 z &lt;- rep(NA, M) for(i in 1:M) { y &lt;- rbinom(4, 1, 0.5) z[i] &lt;- sum(y) } table(z) / M #&gt; z #&gt; 0 1 2 3 4 #&gt; 0.06213 0.25019 0.37400 0.25097 0.06271 Viene detta variabile casuale discreta una variabile casuale le cui modalità possono essere costituite solo da numeri interi: \\[ \\mathbb{Z} = \\dots, -2, -1, 0, 1, 2, \\dots \\] "],["sec:fun-mass-prob.html", "4.8 Funzione di massa di probabilità", " 4.8 Funzione di massa di probabilità È conveniente avere una funzione che associa ogni possibile valore di una variabile casuale alla sua probabilità. In generale, ciò è possibile se e solo se la variabile casuale è discreta, così com’è stata definita nel Paragrafo precedente. Ad esempio, se consideriamo \\(Z = Y_1 + \\dots + Y_4\\) come il numero di risultati “testa” in 4 lanci della moneta, allora possiamo definire la seguente funzione: \\[ \\begin{array}{rclll} p_Z(0) &amp; = &amp; 1/16 &amp; &amp; \\mathrm{TTTT} \\\\ p_Z(1) &amp; = &amp; 4/16 &amp; &amp; \\mathrm{HTTT, THTT, TTHT, TTTH} \\\\ p_Z(2) &amp; = &amp; 6/16 &amp; &amp; \\mathrm{HHTT, HTHT, HTTH, THHT, THTH, TTTH} \\\\ p_Z(3) &amp; = &amp; 4/16 &amp; &amp; \\mathrm{HHHT, HHTH, HTHH, THHH} \\\\ p_Z(4) &amp; = &amp; 1/16 &amp; &amp; \\mathrm{HHHH} \\end{array} \\] Il lancio di quattro monete può produrre sedici possibili risultati. Dato che i lanci sono indipendenti e le monete sono equilibrate, ogni possibile risultato è ugualmente probabile. Nella tabella in alto, le sequenze dei risultati possibili del lancio delle 4 monete sono riportate nella colonna più a destra. Le probabilità si ottengono dividendo il numero di sequenze che producono lo stesso numero di eventi testa per il numero dei risultati possibili. La funzione \\(p_Z\\) è stata costruita per mappare un valore \\(u\\) per \\(Z\\) alla probabilità dell’evento \\(Z = u\\). Convenzionalmente, queste probabilità sono scritte come \\[ p_Z(z) = \\mbox{Pr}[Z = z]. \\] La parte a destra dell’uguale si può leggere come: “la probabilità che la variabile casuale \\(Z\\) assuma il valore \\(z\\)”. Una funzione definita come sopra è detta funzione di massa di probabilità della variabile casuale \\(Z\\). Ad ogni variabile casuale discreta è associata un’unica funzione di massa di probabilità. Una rappresentazione grafica della stima della funzione di massa di probabilità per l’esperimento casuale del lancio di quattro monete equilibrate è fornita nella figura 4.4. set.seed(1234) M &lt;- 1e5 nflips &lt;- 4 u &lt;- rbinom(M, nflips, 0.5) x &lt;- 0:nflips y &lt;- rep(NA, nflips+1) for (n in 0:nflips) y[n + 1] &lt;- sum(u == n) / M bar_plot &lt;- data.frame(Z = x, count = y) %&gt;% ggplot( aes(x = Z, y = count) ) + geom_bar(stat = &quot;identity&quot;) + scale_x_continuous( breaks = 0:4, labels = c(0, 1, 2, 3, 4) ) + labs( y = &quot;Probabilità stimata Pr[Z = z]&quot; ) bar_plot FIGURA 4.4: Grafico di \\(M = 100\\,000\\) simulazioni della funzione di massa di probabilità di una variabile casuale definita come il numero di teste in quattro lanci di una moneta equilibrata. Se \\(A\\) è un sottoinsieme della variabile casuale \\(Z\\), allora denotiamo con \\(P_{z}(A)\\) la probabilità assegnata ad \\(A\\) dalla distribuzione \\(P_{z}\\). Mediante una distribuzione di probabilità \\(P_{z}\\) è dunque possibile determinare la probabilità di ciascun sottoinsieme \\(A \\subset Z\\) come \\[ P_{z}(A) = \\sum_{z \\in A} P_{z}(Z). \\] Esempio 4.1 Nel caso dell’esempio discusso nella Sezione 4.8, la probabilità che la variabile casuale \\(Z\\) sia un numero dispari è \\[ Pr(\\text{Z è un numero dispari}) = P_{z}(Z = 1) + P_{z}(Z = 3) = \\frac{4}{16} + \\frac{4}{16} = \\frac{1}{2}. \\] "],["considerazioni-conclusive-1.html", "Considerazioni conclusive", " Considerazioni conclusive In questo capitolo abbiamo visto come si costruisce lo spazio campionario di un esperimento casuale, quali sono le proprietà di base della probabilità e come si assegnano le probabilità agli eventi definiti sopra uno spazio campionario discreto. Abbiamo anche introdotto le nozioni di “variabile casuale”, ovvero di una variabile che prende i suoi valori casualmente. E abbiamo descritto il modo di specificare la probabilità con cui sono presi i differenti valori, ovvero la funzione di distribuzione probabilistica \\(F(X) = Pr(X &lt; x)\\), e la funzione di massa di probabilità. Le procedure di analisi dei dati psicologici che discuteremo in seguito faranno un grande uso di questi concetti e della notazione qui introdotta. "],["chapter-prob-cond.html", "Capitolo 5 Probabilità condizionata", " Capitolo 5 Probabilità condizionata Il fondamento della statistica bayesiana è il teorema di Bayes e il fondamento del teorema di Bayes è la probabilità condizionata. In questo capitolo, inizieremo a presentare la probabilità condizionata. Nel Capitolo successivo, partendo dalla definizione di probabilità condizionata, deriveremo il teorema di Bayes. "],["probabilità-condizionata-su-altri-eventi.html", "5.1 Probabilità condizionata su altri eventi", " 5.1 Probabilità condizionata su altri eventi L’attribuzione di una probabilità ad un evento è sempre condizionata dalle conoscenze che abbiamo a disposizione. Per un determinato stato di conoscenze, attribuiamo ad un dato evento una certa probabilità di verificarsi; ma se il nostro stato di conoscenze cambia, allora cambierà anche la probabilità che attribuiremo all’evento in questione. La probabilità condizionata è una componente essenziale del ragionamento scientifico dato che chiarisce come sia possibile incorporare le evidenze disponibili, in maniera logica e coerente, nella nostra conoscenza del mondo. Infatti, si può pensare che tutte le probabilità siano probabilità condizionate, anche se l’evento condizionante non è sempre esplicitamente menzionato. Consideriamo il seguente problema. Esercizio 5.1 Supponiamo che lo screening per la diagnosi precoce del tumore mammario si avvalga di test che sono accurati al 90%, nel senso che il 90% delle donne con cancro e il 90% delle donne senza cancro saranno classificate correttamente. Supponiamo che l’1% delle donne sottoposte allo screening abbia effettivamente il cancro al seno. Ci chiediamo: qual è la probabilità che una donna scelta casualmente abbia una mammografia positiva e, se ce l’ha, qual è la probabilità che abbia davvero il cancro? Per risolvere questo problema, supponiamo che il test in questione venga somministrato ad un grande campione di donne, diciamo a 1000 donne. Di queste 1000 donne, 10 (ovvero, l’1%) hanno il cancro al seno. Per queste 10 donne, il test darà un risultato positivo in 9 casi (ovvero, nel 90% dei casi). Per le rimanenti 990 donne che non hanno il cancro al seno, il test darà un risultato positivo in 99 casi (se la probabilità di un vero positivo è del 90%, la probabilità di un falso positivo è del 10%). Questa situazione è rappresentata nella figura 5.1. Combinando questi due risultati, vediamo che il test dà un risultato positivo per 9 donne che hanno effettivamente il cancro al seno e per 99 donne che non ce l’hanno, per un totale di 108 risultati positivi. Dunque, la probabilità di ottenere un risultato positivo al test è \\(\\frac{108}{1000}\\) = 11%. Ma delle 108 donne che hanno ottenuto un risultato positivo al test, solo 9 hanno il cancro al seno. Dunque, la probabilità di avere il cancro, dato un risultato positivo al test, è pari a \\(\\frac{9}{108}\\) = 8%. FIGURA 5.1: Rappresentazione ad albero che riporta le frequenze attese dei risultati di una mammografia in un campione di 1,000 donne. Nell’esercizio precedente, la probabilità dell’evento “ottenere un risultato positivo al test” è una probabilità non condizionata, mentre la probabilità dell’evento “avere il cancro al seno, dato che il test ha dato un risultato positivo” è una probabilità condizionata. In termini generali, la probabilità condizionata \\(P(A \\mid B)\\) rappresenta la probabilità che si verifichi l’evento \\(A\\) sapendo che si è verificato l’evento \\(B\\) (oppure: la probabilità di \\(A\\) in una prova valida solo se si verifica anche \\(B\\)). Ciò ci conduce alla seguente definizione. Definizione 5.1 Dato un qualsiasi evento \\(A\\), si chiama probabilità condizionata di \\(A\\) dato \\(B\\) il numero \\[\\begin{equation} P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}, \\quad \\text{con}\\, P(B) &gt; 0, \\tag{5.1} \\end{equation}\\] dove \\(P(A\\cap B)\\) è la probabilità congiunta dei due eventi, ovvero la probabilità che si verifichino entrambi. Dalla definizione di probabilità condizionata è possibile esprimere la probabilità congiunta come prodotto di due probabilità, una condizionata e una marginale (regola moltiplicativa, o della catena). Per esempio se conosciamo la probabilità marginale \\(P(B)\\) e la probabilità condizionata \\(P(A \\mid B)\\) otteniamo \\[\\begin{equation} P(A \\cap B) = P(B)P(A \\mid B), \\tag{5.2} \\end{equation}\\] mentre se conosciamo la probabilità marginale \\(P(A)\\) e la probabilità condizionata \\(P(B \\mid A)\\) otteniamo \\[ P(A \\cap B) = P(A)P(B \\mid A). \\] Esercizio 5.2 Da un mazzo di 52 carte (13 carte per ciascuno dei 4 semi) ne viene estratta 1 in modo casuale. Qual è la probabilità che esca una figura di cuori? Sapendo che la carta estratta ha il seme di cuori, qual è la probabilità che il valore numerico della carta sia 7, 8 o 9? Ci sono 13 carte di cuori, dunque la risposta alla prima domanda è 1/4. Per rispondere alla seconda domanda consideriamo solo le 13 carte di cuori; la probabilità cercata è dunque 3/13. 5.1.1 La fallacia del condizionale trasposto Un errore comune che si commette è quello di credere che \\(P(A \\mid B)\\) sia uguale a \\(P(B \\mid A)\\). Tale fallacia ha particolare risalto in ambito forense tanto che è conosciuta con il nome di “fallacia del procuratore”. In essa, una piccola probabilità dell’evidenza, data l’innocenza, viene erroneamente interpretata come la probabilità dell’innocenza, data l’evidenza. Consideriamo il caso di un esame del DNA. Un esperto forense potrebbe affermare, ad esempio, che “se l’imputato è innocente, c’è solo una possibilità su un miliardo che vi sia una corrispondenza tra il suo DNA e il DNA trovato sulla scena del crimine”. Ma talvolta questa probabilità è erroneamente interpretata come avesse il seguente significato: “date le prove del DNA, c’è solo una possibilità su un miliardo che l’imputato sia innocente”. Le considerazioni precedenti risultano più chiare se facciamo nuovamente riferimento all’esercizio sul tumore mammario descritto sopra. In tale esercizio abbiamo visto come la probabilità di cancro dato un risultato positivo al test sia uguale a 0.08. Tale probabilità è molto diversa dalla probabilità di un risultato positivo al test data la presenza del cancro. Infatti, questa seconda probabilità è uguale a 0.90 ed è descritta nel problema come una delle caratteristiche del test in questione. "],["legge-della-probabilità-composta.html", "5.2 Legge della probabilità composta", " 5.2 Legge della probabilità composta Il teorema della probabilità composta deriva dal concetto di probabilità condizionata per cui la probabilità che si verifichino due eventi \\(A_i\\) e \\(A_j\\) è pari alla probabilità di uno dei due eventi moltiplicato con la probabilità dell’altro evento condizionato al verificarsi del primo. L’equazione (5.2) si estende al caso di \\(n\\) eventi \\(A_1, \\dots, A_n\\) nella forma seguente: \\[\\begin{equation} \\begin{split} P(A_1 \\cap A_2 \\cap \\dots\\cap A_n) = {}&amp; P(A_1)P(A_2 \\mid A_1)P(A_3 \\mid A_1 \\cap A_2) \\dots\\\\ &amp; P(A_n \\mid A_1 \\cap A_2 \\cap \\dots \\cap A_{n-1}) \\end{split} \\tag{5.3} \\end{equation}\\] la quale esprime in forma generale la legge della probabilità composta. Esercizio 5.3 Da un’urna contenente 6 palline bianche e 4 nere si estrae una pallina per volta, senza reintrodurla nell’urna. Indichiamo con \\(B_i\\) l’evento: “esce una pallina bianca alla \\(i\\)-esima estrazione” e con \\(N_i\\) l’estrazione di una pallina nera. L’evento: “escono due palline bianche nelle prime due estrazioni” è rappresentato dalla intersezione \\(\\{B_1 \\cap B_2\\}\\) e la sua probabilità vale, per la (5.2) \\[ P(B_1 \\cap B_2) = P(B_1)P(B_2 \\mid B_1). \\] \\(P(B_1)\\) vale 6/10, perché nella prima estrazione \\(\\Omega\\) è costituito da 10 elementi: 6 palline bianche e 4 nere. La probabilità condizionata \\(P(B_2 \\mid B_1)\\) vale 5/9, perché nella seconda estrazione, se è verificato l’evento \\(B_1\\), lo spazio campionario consiste di 5 palline bianche e 4 nere. Si ricava pertanto: \\[ P(B_1 \\cap B_2) = \\frac{6}{10} \\cdot \\frac{5}{9} = \\frac{1}{3}. \\] In modo analogo si ha che \\[ P(N_1 \\cap N_2) = P(N_1)P(N_2 \\mid N_1) = \\frac{4}{10} \\cdot \\frac{3}{9} = \\frac{4}{30}. \\] Se l’esperimento consiste nell’estrazione successiva di 3 palline, la probabilità che queste siano tutte bianche vale, per la (5.3): \\[ P(B_1 \\cap B_2 \\cap B_3)=P(B_1)P(B_2 \\mid B_1)P(B_3 \\mid B_1 \\cap B_2), \\] dove la probabilità \\(P(B_3 \\mid B_1 \\cap B_2)\\) si calcola supponendo che si sia verificato l’evento condizionante \\(\\{B_1 \\cap B_2\\}\\). Lo spazio campionario per questa probabilità condizionata è costituito da 4 palline bianche e 4 nere, per cui \\(P(B_3 \\mid B_1 \\cap B_2) = 1/2\\) e quindi: \\[ P (B_1 \\cap B_2 \\cap B_3) = \\frac{6}{10}\\cdot\\frac{5}{9} \\cdot\\frac{4}{8} = \\frac{1}{6}. \\] La probabilità dell’estrazione di tre palline nere è invece: \\[ \\begin{aligned} P(N_1 \\cap N_2 \\cap N_3) &amp;= P(N_1)P(N_2 \\mid N_1)P(N_3 \\mid N_1 \\cap N_2)\\notag\\\\ &amp;= \\frac{4}{10} \\cdot \\frac{3}{9} \\cdot \\frac{2}{8} = \\frac{1}{30}.\\notag \\end{aligned} \\] "],["lindipendendenza-stocastica.html", "5.3 L’indipendendenza stocastica", " 5.3 L’indipendendenza stocastica Un concetto molto importante per le applicazioni statistiche della probabilità è quello dell’indipendenza stocastica. La definizione (5.1) esprime il concetto intuitivo di indipendenza di un evento da un altro, nel senso che il verificarsi di \\(A\\) non influisce sulla probabilità del verificarsi di \\(B\\), ovvero non la condiziona. Infatti, per la definizione (5.1) di probabilità condizionata, si ha che, se \\(A\\) e \\(B\\) sono due eventi indipendenti, risulta: \\[ P(A \\mid B) = \\frac{P(A)P(B)}{P(B)} = P(A).\\notag \\] Possiamo dunque dire che due eventi \\(A\\) e \\(B\\) sono indipendenti se \\[ \\begin{split} P(A \\mid B) &amp;= P(A), \\\\ P(B \\mid A) &amp;= P(B). \\end{split} \\] Esercizio 5.4 Nel lancio di due dadi non truccati, si considerino gli eventi: A = {esce un 1 o un 2 nel primo lancio} e B = {il punteggio totale è 8}. Gli eventi A e B sono indipendenti? Rappresentiamo qui sotto lo spazio campionario dell’esperimento casuale. FIGURA 5.2: Rappresentazione dello spazio campionario dei risultati dell’esperimento casuale corrispondente al lancio di due dadi bilanciati. Sono evidenziati gli eventi elementari che costituiscono l’evento A: esce un 1 o un 2 nel primo lancio. Gli eventi A e B non sono statisticamente indipendenti. Infatti, le loro probabilità valgono P(A) = 12/36 e P(B) = 5/36 e la probabilità della loro intersezione è \\[ P(A \\cap B) = 1/36 = 3/108 \\neq P(A)P(B) = 5/108. \\] Remark. Si noti che il concetto di indipendenza è del tutto differente da quello di incompatibilità. Due eventi A e B incompatibili (per i quali si ha \\(A \\cap B = \\emptyset\\)) sono statisticamente dipendenti, poiché il verificarsi dell’uno esclude il verificarsi dell’altro: \\(P(A \\cap B)=0 \\neq P(A)P(B)\\). Si noti inoltre che, se due eventi con probabilità non nulla sono statisticamente indipendenti, la legge delle probabilità totali espressa dalla (5.4) \\[\\begin{equation} P(A \\cup B) = P(A) + P(B) - P(A \\cap B) \\tag{5.4} \\end{equation}\\] si modifica nella relazione seguente: \\[\\begin{equation} P(A \\cup B) = P(A) + P(B) - P(A)P(B). \\end{equation}\\] "],["considerazioni-conclusive-2.html", "Considerazioni conclusive", " Considerazioni conclusive La probabilità condizionata è importante perché ci fornisce uno strumento per precisare il concetto di indipendenza statistica. Una delle domande più importanti delle analisi statistiche è infatti quella che si chiede se due variabili sono associate tra loro oppure no. In questo Capitolo abbiamo discusso il concetto di indipendenza (come contrapposto al concetto di associazione – si veda il Capitolo 3.1). In seguito vedremo come sia possibile fare inferenza sull’associazione tra variabili. "],["chapter-teo-bayes.html", "Capitolo 6 Il teorema di Bayes", " Capitolo 6 Il teorema di Bayes Questo Capitolo presenterà il teorema di Bayes per calcolare la probabilità degli eventi riferiti a esperimenti casuali, ossia esperimenti di cui non si può prevedere il risultato finale ma di cui si conoscono tutti i possibili risultati. Prima di esaminare il teorema di Bayes verrà introdotta una sua componente, ovvero il teorema della probabilità totale. "],["il-teorema-della-probabilità-totale.html", "6.1 Il teorema della probabilità totale", " 6.1 Il teorema della probabilità totale Il teorema della probabilità totale fa uso della legge della probabilità composta (5.3). Lo discuteremo qui considerando il caso di una partizione dello spazio campionario in tre sottoinsiemi, ma è facile estendere tale discussione al caso di una partizione in un qualunque numero di sottoinsiemi. Teorema 6.1 Sia \\(\\{F_1, F_2, F_3\\}\\) una partizione dello spazio campionario \\(\\Omega\\). Se \\(E\\) è un qualunque altro evento, allora: \\[\\begin{equation} P(E) = P(E \\cap F_1) + P(E \\cap F_2) + P(E \\cap F_3) \\notag \\tag{6.1} \\end{equation}\\] ovvero \\[\\begin{equation} P(E) = P(E \\mid F_1) P(F_1) + P (E \\mid F_2) P(F_2) + P(E \\mid F_3) P(F_3). \\tag{6.2} \\end{equation}\\] Il teorema della probabilità totale afferma che, se l’evento \\(E\\) è costituito da tutti gli eventi elementari in \\(E \\cap F_1\\), \\(E \\cap F_2\\) e \\(E \\cap F_3\\), allora la probabilità \\(P(E)\\) è data dalla somma delle probabilità di questi tre eventi (figura 6.1). FIGURA 6.1: Partizione dello spazio campionario \\(\\Omega\\). Esercizio 6.1 Si considerino tre urne, ciascuna delle quali contiene 100 palline: Urna 1: 75 palline rosse e 25 palline blu, Urna 2: 60 palline rosse e 40 palline blu, Urna 3: 45 palline rosse e 55 palline blu. Una pallina viene estratta a caso da un’urna anch’essa scelta a caso. Qual è la probabilità che la pallina estratta sia di colore rosso? Sia \\(R\\) l’evento “la pallina estratta è rossa” e sia \\(U_i\\) l’evento che corrisponde alla scelta dell’\\(i\\)-esima urna. Sappiamo che \\[ P(R \\mid U_1) = 0.75, \\quad P(R \\mid U_2) = 0.60, \\quad P(R \\mid U_3) = 0.45. \\] Gli eventi \\(U_1\\), \\(U_2\\) e \\(U_3\\) costituiscono una partizione dello spazio campionario in quanto \\(U_1\\), \\(U_2\\) e \\(U_3\\) sono eventi mutualmente esclusivi ed esaustivi, \\(P(U_1 \\cup U_2 \\cup U_3) = 1.0\\). In base al teorema della probabilità totale, la probabilità di estrarre una pallina rossa è \\[ \\begin{split} P(R) &amp;= P(R \\mid U_1)P(U_1)+P(R \\mid U_2)P(U_2)+P(R \\mid U_3)P(U_3) \\\\ &amp;= 0.75 \\cdot \\frac{1}{3}+0.60 \\cdot \\frac{1}{3}+0.45 \\cdot \\frac{1}{3} \\\\ &amp;=0.60. \\end{split} \\] Esercizio 6.2 Consideriamo un’urna che contiene 5 palline rosse e 2 palline verdi. Due palline vengono estratte, una dopo l’altra. Vogliamo sapere la probabilità dell’evento “la seconda pallina estratta è rossa”. Lo spazio campionario è \\(\\Omega = \\{RR, RV, VR, VV\\}\\). Chiamiamo \\(R_1\\) l’evento “la prima pallina estratta è rossa”, \\(V_1\\) l’evento “la prima pallina estratta è verde”, \\(R_2\\) l’evento “la seconda pallina estratta è rossa” e \\(V_2\\) l’evento “la seconda pallina estratta è verde”. Dobbiamo trovare \\(P(R_2)\\) e possiamo risolvere il problema usando il teorema della probabilità totale (6.2): \\[ \\begin{split} P(R_2) &amp;= P(R_2 \\mid R_1) P(R_1) + P(R_2 \\mid V_1)P(V_1)\\\\ &amp;= \\frac{4}{6} \\cdot \\frac{5}{7} + \\frac{5}{6} \\cdot \\frac{2}{7} \\\\ &amp;= \\frac{30}{42} = \\frac{5}{7}. \\end{split} \\] Se la prima estrazione è quella di una pallina rossa, nell’urna restano 4 palline rosse e due verdi, dunque, la probabilità che la seconda estrazione produca una pallina rossa è uguale a 4/6. La probabilità di una pallina rossa nella prima estrazione è 5/7. Se la prima estrazione è quella di una pallina verde, nell’urna restano 5 palline rosse e una pallina verde, dunque, la probabilità che la seconda estrazione produca una pallina rossa è uguale a 5/6. La probabilità di una pallina verde nella prima estrazione è 2/7. "],["la-regola-di-bayes.html", "6.2 La regola di Bayes", " 6.2 La regola di Bayes Il teorema di Bayes rappresenta uno dei fondamenti della teoria della probabilità e della statistica. Lo presentiamo qui considerando un caso specifico per poi descriverlo nella sua forma più generale. Sia \\(\\{F_1, F_2\\}\\) una partizione dello spazio campionario \\(\\Omega\\). Consideriamo un terzo evento \\(E \\subset \\Omega\\) con probabilità non nulla di cui si conoscono le probabilità condizionate rispetto ad \\(F_1\\) e a \\(F_2\\), ovvero \\(P(E \\mid F_1)\\) e \\(P(E \\mid F_2)\\). È chiaro per le ipotesi fatte che se si verifica \\(E\\) deve anche essersi verificato almeno uno degli eventi \\(F_1\\) e \\(F_2\\). Supponendo che si sia verificato l’evento \\(E\\), ci chiediamo: qual è la probabilità che si sia verificato \\(F_1\\) piuttosto che \\(F_2\\)? Per rispondere alla domanda precedente scriviamo: \\[ \\begin{split} P(F_1 \\mid E) &amp;= \\frac{P(E \\cap F_1)}{P(E)}\\notag\\\\ &amp;= \\frac{P(E \\mid F_1)P(F_1)}{P(E)}. \\end{split} \\] Sapendo che \\(E = (E \\cap F_1) \\cup (E \\cap F_2)\\) e che \\(F_1\\) e \\(F_2\\) sono eventi disgiunti, ovvero \\(F_1 \\cap F_2 = \\emptyset\\), ne segue che possiamo calcolare \\(P(E)\\) utilizzando il teorema della probabilità totale: \\[ \\begin{split} P(E) &amp;= P(E \\cap F_1) + P(E \\cap F_2)\\notag\\\\ &amp;= P(E \\mid F_1)P(F_1) + P(E \\mid F_2)P(F_2). \\end{split} \\] Sostituendo il risultato precedente nella formula della probabilità condizionata \\(P(F_1 \\mid E)\\) otteniamo: \\[\\begin{equation} P(F_1 \\mid E) = \\frac{P(E \\mid F_1)P(F_1)}{P(E \\mid F_1)P(F_1) + P(E \\mid F_2)P(F_2)}. \\tag{6.3} \\end{equation}\\] La (6.3) si generalizza facilmente al caso di più di due eventi disgiunti, come indicato di seguito. Teorema 6.2 Sia \\(E\\) un evento contenuto in \\(F_1 \\cup \\dots \\cup F_k\\), dove gli eventi \\(F_j, j=1, \\dots, k\\) sono a due a due incompatibili e necessari. Allora per ognuno dei suddetti eventi \\(F_j\\) vale la seguente formula: \\[\\begin{equation} P(F_j \\mid E) = \\frac{P(E \\mid F_j)P(F_j)}{\\sum_{j=1}^{k}P(F_j)P(E \\mid F_j)}. \\tag{6.4} \\end{equation}\\] La (6.4) prende il nome di Teorema di Bayes e mostra che la conoscenza del verificarsi dell’evento \\(E\\) modifica la probabilità che abbiamo attribuito all’evento \\(F_j\\). Nella (6.4) la probabilità condizionata \\(P(F_j \\mid E)\\) prende il nome di probabilità a posteriori dell’evento \\(F_j\\): il termine “a posteriori” sta a significare “dopo che è noto che si è verificato l’evento \\(E\\)”. Nel capitolo ?? estenderemo questa discussione mostrando come la (6.4) possa essere formulata in un modo più generale, ovvero in modo tale che non faccia riferimento unicamente alla probabilità di eventi, ma bensì anche alle funzioni di densità di probabilità. Remark. Qual è la pronuncia di “Bayesian”? Per saperlo possiamo seguire questo link. 6.2.1 Le probabilità come grado di fiducia Il teorema di Bayes rende esplicito il motivo per cui la probabilità non può essere pensata come uno stato oggettivo, quanto piuttosto come un’inferenza soggettiva e condizionata. Il denominatore del membro di destra della (6.4) è un semplice fattore di normalizzazione. Nel numeratore compaiono invece due quantità: \\(P(F_j\\)) e \\(P(E \\mid F_j)\\). La probabilità \\(P(F_j\\)) è la probabilità probabilità a priori (prior) dell’evento \\(F_j\\) e rappresenta l’informazione che l’agente bayesiano possiede a proposito dell’evento \\(F_j\\). Diremo che \\(P(F_j)\\) codifica il grado di fiducia che l’agente ripone in \\(F_j\\), sul quale non possiamo porre vincoli di alcun tipo. La probabilità condizionata \\(P(E \\mid F_j)\\) rappresenta invece la verosimiglianza di \\(F_j\\) e ci dice quant’è plausibile che si verifichi l’evento \\(E\\) condizionatemente al fatto che si sia verificato \\(F_j\\). Nell’interpretazione bayesiana \\(P(F_j)\\) rappresenta un giudizio personale dell’agente e non esistono criteri esterni che possano determinare se tale giudizio sia coretto o meno. Il teorema di Bayes descrive la regola che l’agente deve seguire per aggiornare il suo grado di fiducia in \\(F_j\\) alla luce di un ulteriore evento \\(E\\). Per questo motivo abbiamo chiamato \\(P(F_j \\mid E)\\) probabilità a posteriori: essa rappresenta infatti la nuova probabilità che l’agente assegna ad \\(F_j\\) affinché rimanga consistente con le nuove informazioni fornitegli da \\(E\\). La probabilità a posteriori dipende sia da \\(E\\), sia dalla conoscenza a priori dell’agente \\(P(F_j)\\). In questo senso è chiaro come non abbia senso parlare di una probabilità oggettiva: per il teorema di Bayes la probabilità è definita condizionatamente alla probabilità a priori, la quale a sua volta, per definizione, è un’assegnazione soggettiva. Ne segue pertanto che ogni probabilità debba essere una rappresentazione del grado di fiducia (soggettiva) dell’agente. Se ogni assegnazione probabilistica rappresenta uno stato di conoscenza, è altresì vero che un particolare stato di conoscenza è arbitrario e dunque non deve esserci necessariamente accordo a priori tra diversi agenti. Tuttavia, alla luce di nuove informazioni, la teoria delle probabilità ci fornisce uno strumento che consente l’aggiornamento dello stato di conoscenza in un modo razionale. 6.2.2 Aggiornamento bayesiano Il teorema di Bayes consente di modificare una credenza a priori in maniera dinamica, via via che nuove evidenze vengono raccolte, in modo tale da formulare una credenza a posteriori la quale non è mai definitiva, ma può sempre essere aggiornata in base alle nuove evidenze disponibili. Questo processo si chiama aggiornamento bayesiano. Esercizio 6.3 Supponiamo che, per qualche strano errore di produzione, una fabbrica produca due tipi di monete. Il primo tipo di monete ha la caratteristica che, quando una moneta viene lanciata, la probabilità di osservare l’esito “testa” è 0.6. Per semplicità, sia \\(\\theta\\) la probabilità di osservare l’esito “testa”. Per una moneta del primo tipo, dunque, \\(\\theta = 0.6\\). Per una moneta del secondo tipo, invece, la probabilità di produrre l’esito “testa” è 0.4. Ovvero, \\(\\theta = 0.4\\). Noi possediamo una moneta, ma non sappiamo se è del primo tipo o del secondo tipo. Sappiamo solo che il 75% delle monete sono del primo tipo e il 25% sono del secondo tipo. Sulla base di questa conoscenza a priori – ovvero sulla base di una conoscenza ottenuta senza avere eseguito l’esperimento che consiste nel lanciare la moneta una serie di volte per osservare gli esiti prodotti – possiamo dire che la probabilità di una prima ipotesi, secondo la quale \\(\\theta = 0.6\\), è 3 volte più grande della probabilità di una seconda ipotesi, secondo la quale \\(\\theta = 0.4\\). Senza avere eseguito alcun esperimento casuale con la moneta, questo è quello che sappiamo. Ora immaginiamo di lanciare una moneta due volte e di ottenere il risultato seguente: \\(\\{T, C\\}\\). Quello che ci chiediamo è: sulla base di questa evidenza, come cambiano le probabilità che associamo alle due ipotesi? In altre parole, ci chiediamo qual è la probabilità di ciascuna ipotesi alla luce dei dati che sono stati osservati: \\(P(H \\mid y)\\), laddove \\(y\\) sono i dati osservati. Tale probabilità si chiama probabilità a posteriori. Inoltre, se confrontiamo le due ipotesi, ci chiediamo quale valore assuma il rapporto \\(\\frac{P(H_1 \\mid y)}{P(H_2 \\mid y)}\\). Tale rapporto ci dice quanto è più probabile \\(H_1\\) rispetto ad \\(H_2\\), alla luce dei dati osservati. Infine, ci chiediamo come cambia il rapporto definito sopra, quando osserviamo via via nuovi risultati prodotti dal lancio della moneta. Definiamo il problema in maniera più chiara. Conosciamo le probabilità a priori, ovvero \\(P(H_1) = 0.75\\) e \\(P(H_1) = 0.25\\). Quello che vogliamo conoscere sono le probabilità a posteriori \\(P(H_1 \\mid y)\\) e \\(P(H_2 \\mid y)\\). Per trovare le probabilità a posteriori applichiamo il teorema di Bayes: \\[ \\begin{split} P(H_1 \\mid y) &amp;= \\frac{P(y \\mid H_1) P(H_1)}{P(y)} \\\\ &amp;= \\frac{P(y \\mid H_1) P(H_1)}{P(y \\mid H_1) P(H_1) + P(y \\mid H_2) P(H_2)}, \\end{split} \\] laddove lo sviluppo del denominatore deriva da un’applicazione del teorema della probabilità totale. Inoltre, \\[ P(H_2 \\mid y) = \\frac{P(y \\mid H_2) P(H_2)}{P(y \\mid H_1) P(H_1) + P(y \\mid H_2) P(H_2)}. \\] Se consideriamo l’ipotesi \\(H_1\\) = “la probabilità di testa è 0.6”, allora la verosimiglianza dei dati \\(\\{T, C\\}\\), ovvero la probabilità di osservare questa specifica sequenza di T e C, è uguale a \\(0.6 \\times 0.4 = 0.24.\\) Dunque, \\(P(y \\mid H_1) = 0.24\\). Se invece consideriamo l’ipotesi \\(H_2\\) = “la probabilità di testa è 0.4”, allora la verosimiglianza dei dati \\(\\{T, C\\}\\) è \\(0.4 \\times 0.6 = 0.24\\), ovvero, \\(P(y \\mid H_2) = 0.24\\). In base alle due ipotesi \\(H_1\\) e \\(H_2\\), dunque, i dati osservati hanno la medesima plausibilità di essere osservati. Per semplicità, calcoliamo anche \\[ \\begin{split} P(y) &amp;= P(y \\mid H_1) P(H_1) + P(y \\mid H_2) P(H_2) \\\\ &amp;= 0.24 \\cdot 0.75 + 0.24 \\cdot 0.25 \\\\ &amp;= 0.24. \\end{split} \\] Le probabilità a posteriori diventano: \\[ \\begin{split} P(H_1 \\mid y) &amp;= \\frac{P(y \\mid H_1) P(H_1)}{P(y)}\\\\ &amp;= \\frac{0.24 \\cdot 0.75}{0.24} \\\\ &amp;= 0.75, \\end{split} \\] \\[ \\begin{split} P(H_2 \\mid y) &amp;= \\frac{P(y \\mid H_2) P(H_2)}{P(y)} \\\\ &amp;= \\frac{0.24 \\cdot 0.25}{0.24} \\\\ &amp;= 0.25. \\end{split} \\] Possiamo dunque concludere dicendo che, sulla base dei dati osservati, l’ipotesi \\(H_1\\) ha una probabilità 3 volte maggiore di essere vera dell’ipotesi \\(H_2\\). È tuttavia possibile raccogliere più evidenze e, sulla base di esse, le probabilità a posteriori cambieranno. Supponiamo di lanciare la moneta una terza volta e di osservare croce. I nostri dati dunque sono \\(\\{T, C, C\\}\\). Di conseguenza, \\(P(y \\mid H_1) = 0.6 \\cdot 0.4 \\cdot 0.4 = 0.096\\) e \\(P(y \\mid H_2) = 0.4 \\cdot 0.6 \\cdot 0.6 = 0.144\\). Ne segue che le probabilità a posteriori diventano: \\[ \\begin{split} P(H_1 \\mid y) &amp;= \\frac{P(y \\mid H_1) P(H_1)}{P(y)} \\\\ &amp;= \\frac{0.096 \\cdot 0.75}{0.096 \\cdot 0.75 + 0.144 \\cdot 0.25} \\\\ &amp;= 0.667, \\end{split} \\] \\[ \\begin{split} P(H_2 \\mid y) &amp;= \\frac{P(y \\mid H_2) P(H_2)}{P(y)} \\\\ &amp;= \\frac{0.144 \\cdot 0.25}{0.096 \\cdot 0.75 + 0.144 \\cdot 0.25} \\\\ &amp;= 0.333. \\end{split} \\] In queste circostanze, le evidenze che favoriscono \\(H_1\\) nei confronti di \\(H_2\\) sono solo pari ad un fattore di 2. Se otteniamo ancora croce in un quarto lancio della moneta, i nostri dati diventano: \\(\\{T, C, C, C\\}\\). Ripetendo il ragionamento fatto sopra, \\(P(y \\mid H_1) = 0.6 \\cdot 0.4 \\cdot 0.4 \\cdot 0.4 = 0.0384\\) e \\(P(y \\mid H_2) = 0.4 \\cdot 0.6 \\cdot 0.6 \\cdot 0.6 = 0.0864\\). Dunque \\[\\begin{equation} P(H_1 \\mid y) = \\frac{0.0384 \\cdot 0.75}{0.0384 \\cdot 0.75 + 0.0864 \\cdot 0.25} = 0.571,\\notag \\end{equation}\\] \\[\\begin{equation} P(H_2 \\mid y) = \\frac{0.0864 \\cdot 0.25}{0.0384 \\cdot 0.75 + 0.0864 \\cdot 0.25} = 0.429.\\notag \\end{equation}\\] e le evidenze a favore di \\(H_1\\) si riducono a 1.33. Se si ottenesse un altro esito croce in un sesto lancio della moneta, l’ipotesi \\(H2\\) diventerebbe più probabile dell’ipotesi \\(H_1\\). In conclusione, questo esercizio ci fa capire come sia possibile aggiornare le nostre credenze sulla base delle evidenze disponibili, ovvero come sia possibile passare da un grado di conoscenza del mondo a priori a una conoscenza a posteriori. Se prima di lanciare la moneta ritenevamo che l’ipotesi \\(H_1\\) fosse tre volte più plausibile dell’ipotesi \\(H_2\\), dopo avere osservato uno specifico campione di dati siamo giunti alla conclusione opposta. Il processo di aggiornamento bayesiano, dunque, ci fornisce un metodo per modificare il livello di fiducia in una data ipotesi, alla luce di nuove informazioni. "],["considerazioni-conclusive-3.html", "Considerazioni conclusive", " Considerazioni conclusive Il teorema di Bayes costituisce il fondamento dell’approccio più moderno della statistica, quello appunto detto bayesiano. Chi usa il teorema di Bayes non è, solo per questo motivo, “bayesiano”: ci vuole ben altro. Ci vuole un modo diverso per intendere il significato della probabilità e un modo diverso per intendere gli obiettivi dell’inferenza statistica. In anni recenti, una gran parte della comunità scientifica ha riconosciuto all’approccio bayesiano il merito di consentire lo sviluppo di modelli anche molto complessi (intrattabili in base all’approccio frequentista) senza richiedere, d’altra parte, conoscenze matematiche troppo avanzate all’utente. Per questa ragione l’approccio bayesiano sta prendendo sempre più piede, anche in psicologia. "],["chapter-prob-congiunta.html", "Capitolo 7 Probabilità congiunta", " Capitolo 7 Probabilità congiunta Per descrivere la relazione tra due variabili casuali è necessario calcolare la covarianza e la correlazione. Il calcolo di questi due indici richiede la conoscenza della funzione di probabilità congiunta. Obiettivo di questo Capitolo è descrivere la funzione di probabilità congiunta di due variabili casuali; esamineremo in dettaglio il caso discreto. "],["funzione-di-probabilità-congiunta.html", "7.1 Funzione di probabilità congiunta", " 7.1 Funzione di probabilità congiunta Dopo aver trattato della distribuzione di probabilità di una variabile casuale, la quale associa ad ogni evento elementare dello spazio campionario uno ed un solo numero reale, è naturale estendere questo concetto al caso di due o più variabili casuali. Iniziamo a descrivere il caso discreto con un esempio. Consideriamo l’esperimento casuale corrispondente al lancio di tre monete equilibrate. Lo spazio campionario è \\[ \\Omega = \\{TTT, TTC, TCT, CTT, CCT, CTC, TCC, CCC\\}. \\] Dato che i tre lanci sono tra loro indipendenti, non c’è ragione di aspettarsi che uno degli otto risultati possibili dell’esperimento sia più probabile degli altri, dunque possiamo associare a ciascuno degli otto eventi elementari dello spazio campionario la stessa probabilità, ovvero 1/8. Siano \\(X \\in \\{0, 1, 2, 3\\}\\) = “numero di realizzazioni con il risultato testa nei tre lanci” e \\(Y \\in \\{0, 1\\}\\) = “numero di realizzazioni con il risultato testa nel primo lancio” due variabili casuali definite sullo spazio campionario \\(\\Omega\\). Indicando con T = ‘testa’ e C = ‘croce’, si ottiene la situazione riportata nella tabella 7.1. TABELLA 7.1: Spazio campionario dell’esperimento consistente nel lancio di tre monete equilibrate su cui sono state definite le variabili aleatorie \\(X\\) e \\(Y\\). \\(\\omega\\) \\(X\\) \\(Y\\) \\(P(\\omega)\\) \\(\\omega_1\\) = TTT 3 1 1/8 \\(\\omega_2\\) = TTC 2 1 1/8 \\(\\omega_3\\) = TCT 2 1 1/8 \\(\\omega_4\\) = CTT 2 0 1/8 \\(\\omega_5\\) = CCT 1 0 1/8 \\(\\omega_6\\) = CTC 1 0 1/8 \\(\\omega_7\\) = TCC 1 1 1/8 \\(\\omega_8\\) = CCC 0 0 1/8 Ci poniamo il problema di associare un livello di probabilità ad ogni coppia \\((x, y)\\) definita su \\(\\Omega\\). La coppia \\((X = 0, Y = 0)\\) si realizza in corrispondenza di un solo evento elementare, ovvero CCC; avrà dunque una probabilità pari a \\(P(X=0, Y=0) = P(CCC) = 1/8\\). Nel caso della coppia \\((X = 1, Y = 0)\\) ci sono due eventi elementari che danno luogo al risultato considerato, ovvero, CCT e CTC; la probabilità \\(P(X=1, Y=0)\\) sarà dunque data dalla probabilità dell’unione dei due eventi elementari, cioé \\(P(X=1, Y=0) = P(CCT \\:\\cup\\: CTC) = 1/8 + 1/8 = 1/4\\). Sono riportati qui sotto i calcoli per tutti i possibili valori di \\(X\\) e \\(Y\\). \\[\\begin{align} P(X = 0, Y = 0) &amp;= P(\\omega_8 = CCC) = 1/8; \\notag\\\\ P(X = 1, Y = 0) &amp;= P(\\omega_5 = CCT) + P(\\omega_6 = CTC) = 2/8; \\notag\\\\ P(X = 1, Y = 1) &amp;= P(\\omega_7 = TCC) = 1/8; \\notag\\\\ P(X = 2, Y = 0) &amp;= P(\\omega_4 = CTT) = 1/8; \\notag\\\\ P(X = 2, Y = 1) &amp;= P(\\omega_3 = TCT) + P(\\omega_2 = TTC) = 2/8; \\notag\\\\ P(X = 3, Y = 1) &amp;= P(\\omega_1 = TTT) = 1/8; \\notag \\end{align}\\] Le probabilità così trovate sono riportate nella tabella 7.2 la quale descrive la distribuzione di probabilità congiunta delle variabili casuali \\(X\\) = “numero di realizzazioni con il risultato testa nei tre lanci” e \\(Y\\) = “numero di realizzazioni con il risultato testa nel primo lancio” per l’esperimento casuale consistente nel lancio di tre monete equilibrate. TABELLA 7.2: Distribuzione di probabilità congiunta per i risultati dell’esperimento consistente nel lancio di tre monete equilibrate. \\(x / y\\) 0 1 0 1/8 0 1 2/8 1/8 2 1/8 2/8 3 0 1/8 In generale, possiamo dire che, dato uno spazio campionario discreto \\(\\Omega\\), è possibile associare ad ogni evento elementare \\(\\omega_i\\) dello spazio campionario una coppia di numeri reali \\((x, y)\\), essendo \\(x = X(\\omega)\\) e \\(y = Y(\\omega)\\), il che ci conduce alla seguente definizione. Definizione 7.1 Siano \\(X\\) e \\(Y\\) due variabili casuali. La funzione che associa ad ogni coppia \\((x, y)\\) un livello di probabilità prende il nome di funzione di probabilità congiunta: \\[ P(x, y) = P(X = x, Y = y). \\] Il termine “congiunta” deriva dal fatto che questa probabilità è legata al verificarsi di una coppia di valori, il primo associato alla variabile casuale \\(X\\) ed il secondo alla variabile casuale \\(Y\\). Nel caso di due sole variabili casuali si parla di distribuzione bivariata, mentre nel caso di più variabili casuali si parla di distribuzione multivariata. 7.1.1 Proprietà Una distribuzione di massa di probabilità congiunta bivariata deve soddisfare due proprietà: \\(0 \\leq P(x_i, y_j) \\leq 1\\); la probabilità totale deve essere uguale a \\(1.0\\). Tale proprietà può essere espressa nel modo seguente \\[ \\sum_{i} \\sum_{j} P(x_i, y_j) = 1.0. \\] 7.1.2 Eventi Si noti che dalla probabilità congiunta possiamo calcolare la probabilità di qualsiasi evento definito in base alle variabili aleatorie \\(X\\) e \\(Y\\). Per capire come questo possa essere fatto, consideriamo nuovamente l’esperimento casuale discusso in precedenza. Esercizio 7.1 Per la distribuzione di massa di probabilità congiunta riportata nella tabella precedente si trovi la probabilità dell’evento \\(X+Y \\leq 1\\). Per trovare la probabilità richiesta dobbiamo semplicemente sommare le probabilità associate a tutte le coppie \\((x,y)\\) che soddisfano la condizione \\(X+Y \\leq 1\\), ovvero \\[\\begin{equation} P_{XY}(X+Y \\leq 1) = P_{XY}(0, 0) + P_{XY}(1, 0)= 3/8.\\notag \\end{equation}\\] 7.1.3 Regola della catena Regola della catena permette il calcolo di qualsiasi membro della distribuzione congiunta di un insieme di variabili casuali utilizzando solo le probabilità condizionate. Definizione 7.2 Dati due eventi \\(A\\) e \\(B\\), la regola della catena afferma che \\[ P(A \\cap B) = P(A)P(B \\mid A). \\] Nel caso di 4 eventi, per esempio, la regola della catena diventa \\[ P(A_1, A_2, A_3, A_4) = P(A_1) P(A_2 \\mid A_1) P(A_3 \\mid A_1, A_2) P(A_4 \\mid A_1, A_2, A_3). \\] 7.1.4 Funzioni di probabilità marginali La distribuzione marginale di un sottoinsieme di variabili casuali è la distribuzione di probabilità delle variabili contenute nel sottoinsieme. Come spiegato da Wikipedia: il termine variabile marginale è usato per riferirsi a quelle variabili nel sottoinsieme delle variabili che vengono trattenute ovvero utilizzate. Questo termine, marginale, è attribuito ai valori ottenuti ad esempio sommando in una tabella di valori lungo le righe oppure lungo le colonne, trascrivendo il risultato appunto a margine rispettivamente della riga o colonna sommata.[1] La distribuzione delle variabili marginali (la distribuzione marginale) è ottenuta mediante marginalizzazione sopra le variabili da “scartare”, e le variabili scartate sono dette fuori marginalizzate. Nel caso di due variabili casuali discrete \\(X\\) e \\(Y\\) di cui conosciamo la cui distribuzione congiunta, la distribuzione marginale di \\(X\\) è calcolata sommando o integrando la distribuzione di probabilità congiunta sopra \\(Y\\). La funzione di massa di probabilità marginale \\(P(X=x)\\) è \\[\\begin{equation} P(X = x) = \\sum_y P(X, Y = y) = \\sum_y P(X \\mid Y = y) P(Y = y), \\end{equation}\\] dove \\(P(X = x,Y = y)\\) è la distribuzione congiunta di \\(X, Y\\), mentre \\(P(X = x \\mid Y = y)\\) è la distribuzione condizionata di \\(X\\) dato \\(Y\\). In questo caso, la variabile \\(Y\\) è stata marginalizzata. Le probabilità bivariate marginali e congiunte per variabili casuali discrete sono spesso mostrate come tabelle di contingenza. Si noti che \\(P(X = x)\\) e \\(P(Y = y)\\) sono normalizzate: \\[ \\sum_x P(X=x) = 1.0, \\quad \\sum_y P(Y=y) = 1.0. \\] Esercizio 7.2 Per l’esperimento casuale consistente nel lancio di tre monete equilibrate, si calcolino le probabilità marginali di \\(X\\) e \\(Y\\). Nell’ultima colonna a destra e nell’ultima riga in basso della tabella 7.3 sono riportate le distribuzioni di probabilità marginali di \\(X\\) e \\(Y\\). \\(P_X\\) si ottiene sommando su ciascuna riga fissata la colonna \\(j\\), \\(P_X(X = j) = \\sum_y p_{xy}(x = j, y)\\). \\(P_Y\\) si trova sommando su ciascuna colonna fissata la riga \\(i,\\) \\(P_Y (Y = i) = \\sum_x p_{xy}(x, y = i)\\). TABELLA 7.3: Distribuzione di probabilità congiunta \\(p(x,y)\\) per i risultati dell’esperimento consistente nel lancio di tre monete equilibrate e probabilità marginali \\(P(x)\\) e \\(P(y)\\). \\(x / y\\) 0 1 \\(P(x)\\) 0 1/8 0 1/8 1 2/8 1/8 3/8 2 1/8 2/8 3/8 3 0 1/8 1/8 \\(P(y)\\) 4/8 4/8 1.0 "],["indipendenza-stocastica.html", "7.2 Indipendenza stocastica", " 7.2 Indipendenza stocastica Ora abbiamo tutti gli strumenti per dare una precisa definizione statistica al concetto di indipendenza. La definizione proposta sarà necessariamente coerente con la definizione di indipendenza che abbiamo usato fino ad ora. Ma, espressa in questi nuovi termini, potrà essere utilizzata in indagini probabilistiche e statistiche più complesse. Ricordiamo che gli eventi \\(A\\) e \\(B\\) si dicono indipendenti se \\(P (A \\cap B)\\, = P(A) P(B)\\). Diciamo quindi che \\(X\\) e \\(Y\\) sono indipendenti se qualsiasi evento definito da \\(X\\) è indipendente da qualsiasi evento definito da \\(Y\\). La definizione formale che garantisce che ciò accada è la seguente. Definizione 7.3 Le variabili aleatorie \\(X\\) e \\(Y\\) sono indipendenti se la loro distribuzione congiunta è il prodotto delle rispettive distribuzioni marginali: \\[\\begin{equation} P(X, Y)\\, = P_X(x)P_Y(y). \\end{equation}\\] Nel caso discreto, dunque, l’indipendenza implica che la probabilità riportata in ciascuna cella della tabella di probabilità congiunta deve essere uguale al prodotto delle probabilità marginali di riga e di colonna: \\[ P(x_i, y_i)\\, = P_X(x_i) P_Y(y_i). \\] Esercizio 7.3 Per la situazione rappresentata nella tabella 7.3 le variabili casuali \\(X\\) e \\(Y\\) sono indipendenti? Nella tabella le variabili casuali \\(X\\) e \\(Y\\) non sono indipendenti: le probabilità congiunte non sono ricavabili dal prodotto delle marginali. Per esempio, nessuna delle probabilità marginali è uguale a \\(0\\) per cui nessuno dei valori dentro la tabella (probabilità congiunte) che risulta essere uguale a \\(0\\) può essere il prodotto delle probabilità marginali. "],["considerazioni-conclusive-4.html", "Considerazioni conclusive", " Considerazioni conclusive La funzione di probabilità congiunta tiene simultaneamente conto del comportamento di due variabili casuali \\(X\\) e \\(Y\\) e di come esse si influenzano reciprocamente. In particolare, si osserva che se le due variabili non si influenzano, cioè se sono statisticamente indipendenti, allora la distribuzione di massa di probabilità congiunta si ottiene come prodotto delle funzioni di probabilità marginali di \\(X\\) e \\(Y\\): \\(P_{X, Y}(x, y) = P_X(x) P_Y(y)\\). "],["chapter-intro-density-function.html", "Capitolo 8 Funzione di densità di probabilità", " Capitolo 8 Funzione di densità di probabilità Finora abbiamo considerato solo variabili casuali discrete, cioè variabili che assumono solo valori interi. Ma cosa succede se vogliamo usare variabili casuali per rappresentare lunghezze o volumi o distanze una qualsiasi delle altre proprietà continue nel mondo fisico (o psicologico)? È necessario generalizzare l’approccio usato finora. Le variabili casuali continue assumono valori reali. L’insieme dei numeri reali è non numerabile perché è più grande dell’insieme degli interi.8 Le leggi della probabilità sono le stessa per le variabili casuali discrete e quelle continue. La nozione di funzione di massa di probabilità, invece, deve essere sostituita dal suo equivalente continuo, ovvero dalla funzione di densità di probabilità. Lo scopo di questo Capitolo è quello di chiarire il significato di questa nozione, usando un approccio basato sulle simulazioni. Georg Cantor dimostrò che era impossibile mappare uno a uno i reali negli interi, dimostrando così che l’insieme dei reali è non numerabile.↩︎ "],["spinner-e-variabili-casuali-continue-uniformi.html", "8.1 Spinner e variabili casuali continue uniformi", " 8.1 Spinner e variabili casuali continue uniformi Consideriamo il seguente esperimento casuale. Facciamo ruotare ad alta velocità uno spinner simmetrico imperniato su un goniometro e osserviamo la posizione in cui si ferma (individuata dall’angolo acuto con segno tra il suo asse e l’asse orizzontale del goniometro). Chiamiamo \\(\\Theta\\) la variabile casuale “pendenza dello spinner”. Nella trattazione seguente useremo i gradi e, di conseguenza, \\(\\Theta \\in [0, 360]\\). FIGURA 8.1: Uno spinner che riposa a 36 gradi, o il dieci percento del percorso intorno al cerchio. La pendenza dello spinner può assumere qualunque valore tra 0 e 360 gradi. Cosa implica per \\(\\Theta\\) dire che lo spinner è simmetrico? Possiamo dire che, in ciascuna prova, la rotazione dello spinner produce un angolo qualunque da 0 a 360 gradi. In altri termini, un valore \\(\\Theta\\) compreso tra 0 e 36 gradi ha la stessa probabilità di essere osservato di un valore \\(\\Theta\\) compreso tra 200 e 236 gradi. Inoltre, poiché 36 gradi è un decimo del percorso intorno al cerchio, la probabilità di ottenere un qualsiasi intervallo di 36 gradi sarà sempre uguale al 10%. Ovvero \\[ \\mbox{P}[0 \\leq \\Theta \\leq 36] \\ = \\ \\frac{1}{10} \\] e \\[ \\mbox{P}[200 \\leq \\Theta \\leq 236] \\ = \\ \\frac{1}{10}. \\] È importante notare che le considerazioni precedenti non si riferiscono al fatto che \\(\\Theta\\) può assumere uno specifico valore, ma piuttosto alla probabilità di osservare \\(\\Theta\\) in un particolare intervallo di valori. In generale, la probabilità che la pendenza \\(\\Theta\\) dello spinner cada in intervallo è la frazione del cerchio rappresentata dall’intervallo, cioè, \\[ \\mbox{P}[\\theta_1 \\leq \\Theta \\leq \\theta_2] = \\frac{\\theta_2 - \\theta_1}{360}, \\qquad 0 \\leq \\theta_1 \\leq \\theta_2 \\leq 360. \\] La ragione di questo è che le variabili casuali continue non hanno una massa di probabilità. Invece, una massa di probabilità viene assegnata alla realizzazione della variabile casuale in un intervallo di valori. 8.1.1 Il paradosso delle variabili casuali continue Nel nostro esempio, la pendenza dello spinner è esattamente 36 gradi; ma avrebbe potuto anche essere 36.0376531 gradi o qualunque altro valore in quell’intorno. Qual è la probabilità che la pendenza dello spinner sia esattamente 36? Paradossalmente, la risposta è zero: \\[ \\mbox{P}[\\Theta = 36] = 0. \\] Infatti, se la probabilità di un qualunque valore fosse maggiore di zero, ogni altro possibile valore dovrebbe avere la stessa probabilità, dato che abbiamo assumiamo che tutti i valori \\(\\Theta\\) sono egualmente probabili. Ma se poi andiamo a sommare tutte queste probabilità il totale diventerà maggiore di uno, il che non è possibile. Nel caso delle variabili casuali continue dobbiamo dunque rinunciare a qualcosa, e quel qualcosa è l’idea che, in una distribuzione continua, ciascun valore puntuale della variabile casuale possa avere una massa di probabilità maggiore di zero. Il paradosso sorge perché una realizzazione della variabile casuale conrtinua produce sempre un qualche numero, ma ciscuno di tali numeri ha probabilità nulla. "],["la-funzione-di-ripartizione-per-una-variabile-casuale-continua.html", "8.2 La funzione di ripartizione per una variabile casuale continua", " 8.2 La funzione di ripartizione per una variabile casuale continua Supponiamo che \\(\\Theta \\sim \\mbox{uniform}(0, 360)\\) sia la pendenza dello spinner. La funzione di ripartizione (ovvero, la distribuzione cumulativa) è definita esattamente come nel caso delle variabili casuali discrete: \\[ F_{\\Theta}(\\theta) = \\mbox{P}[\\Theta \\leq \\theta]. \\] Cioè, è la probabilità che la variabile casuale \\(\\Theta\\) assuma un valore minore di o uguale a \\(\\theta\\). In questo caso, poiché si presume che lo spinner sia simmetrico, la funzione di distribuzione cumulativa è \\[ F_{\\Theta}(\\theta) = \\frac{\\theta}{360}. \\] Questa è una funzione lineare di \\(\\theta\\), cioè \\(\\frac{1}{360} \\times \\theta\\), come indicato dal grafico della figura 8.2. FIGURA 8.2: Funzione di distribuzione cumulativa per l’angolo \\(\\theta\\) (in gradi) risultante da una rotazione di uno spinner simmetrico. La linea tratteggiata mostra il valore a 180 gradi, che corrisponde ad una probabilità di 0.5, e la linea tratteggiata a 270 gradi, che corrisponde ad una probabilità di 0.75. Possiamo verificare questo risultato mediante simulazione. Per stimare la funzione di ripartizione, simuliamo \\(M\\) valori \\(\\theta^{(m)}\\) e poi li ordiniamo in ordine crescente. M &lt;- 1000 theta &lt;- runif(M, 0, 360) theta_asc &lt;- sort(theta) prob &lt;- (1:M) / M unif_cdf_df &lt;- data.frame( theta = theta_asc, prob = prob ) unif_cdf_plot &lt;- unif_cdf_df %&gt;% ggplot(aes(x = theta, y = prob)) + geom_line() + scale_x_continuous(breaks = c(0, 90, 180, 270, 360)) + scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1.0)) + xlab(expression(theta)) + ylab(expression(F[Theta](theta))) unif_cdf_plot FIGURA 8.3: Grafico della funzione di ripartizione di una variabile casuale \\(\\Theta\\) che rappresenta il risultato di una rotazione di uno spinner simmetrico. Come previsto, tale funzione è una semplice funzione lineare perché la variabile sottostante \\(\\Theta\\) ha una distribuzione uniforme. Anche con M = 1000, tale grafico è praticamente indistinguibile da quello prodotto per via analitica. Come nel caso delle variabili casuali discrete, la funzione di ripartizione può essere utilizzata per calcolare le probabilità che la variabile casuale assuma valori in un intervallo. Ad esempio \\[\\begin{align} \\mbox{P}[180 &lt; \\Theta \\leq 270] &amp;= \\mbox{P}[\\Theta \\leq 270] \\ - \\ \\mbox{P}[\\Theta \\leq 180] \\notag\\\\ &amp;= F_{\\Theta}(270) - F_{\\Theta}(180)\\notag\\\\ &amp;= \\frac{3}{4} - \\frac{1}{2} \\notag\\\\ &amp;= \\frac{1}{4}.\\noindent \\end{align}\\] "],["la-distribuzione-uniforme.html", "8.3 La distribuzione uniforme", " 8.3 La distribuzione uniforme Dopo avere visto come generare numeri casuali uniformi da 0 a 360, consideriamo ora una variabile casuale che assume valori nell’intervallo da 0 a 1. Chiamiamo tale variabile casuale \\(\\Theta\\) e assumiamo che abbia una distribuzione continua uniforme sull’intervallo [0, 1]: \\[ \\Theta \\sim Uniform(0, 1). \\] Poiché le probabilità assumono valori nell’intervallo [0, 1], possiamo pensare a \\(\\Theta\\) come ad un valore di probabilità preso a caso in ciascuna realizzazione dell’esperimento casuale. La distribuzione uniforme è la più semplice delle distribuzioni di densità di probabilità. Per chiarire le proprietà di tale distribuzione, iniziamo con una simulazione e generiamo 10,000 valori casuali di \\(\\Theta\\). I primi 10 di tali valori sono stampati qui di seguito: set.seed(1234) M &lt;- 10000 logit &lt;- function(x) log(x / (1 - x)) theta &lt;- runif(M) alpha &lt;- logit(theta) for (m in 1:10) print(alpha[m]) #&gt; [1] -2.053 #&gt; [1] 0.4993 #&gt; [1] 0.4443 #&gt; [1] 0.5039 #&gt; [1] 1.823 #&gt; [1] 0.5767 #&gt; [1] -4.647 #&gt; [1] -1.194 #&gt; [1] 0.6905 #&gt; [1] 0.05702 Creaiamo ora un istogramma che descrive la distribuzione delle 10,000 realizzazioni \\(\\Theta\\) che abbiamo trovato: df_prob_unif &lt;- data.frame(theta = theta) unif_prob_plot &lt;- ggplot(df_prob_unif, aes(theta)) + geom_histogram( binwidth = 1 / 34, center = 1 / 68, color = &quot;black&quot;, size = 0.25 ) + scale_x_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1)) + scale_y_continuous(lim = c(0, 1300), breaks = c(500, 1000)) + xlab(expression(paste(Theta, &quot; ~ Uniform(0, 1)&quot;))) unif_prob_plot FIGURA 8.4: Istogramma di \\(10\\,000\\) realizzazioni \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\). È chiaro che, all’aumentare del numero delle realizzazioni \\(\\Theta\\), il profilo dell’istogramma tenderà a diventare una linea retta. Ciò significa che la funzione di densità di una variabile casuale uniforme continua è una costante. Cioè, se \\(\\Theta \\sim \\mbox{Uniform} (a, b)\\), allora \\(p_{\\Theta}(\\theta) = c\\), dove \\(c\\) è una costante. uniform_pdf_df &lt;- data.frame(y = c(0, 1), p_y = c(1, 1)) uniform_pdf_plot &lt;- ggplot(uniform_pdf_df, aes(x = y, y = p_y)) + geom_line(size = 0.5, color = &quot;#333333&quot;) + geom_point(size = 1.5, color = &quot;#333333&quot;) + scale_x_continuous(breaks = c(0, 1), labels = c(&quot;a&quot;, &quot;b&quot;)) + scale_y_continuous( lim = c(0, 1), breaks = c(0, 1), labels = c(&quot;0&quot;, &quot;c&quot;) ) + xlab(expression(theta)) + ylab(expression(paste(p[Theta], &quot;(&quot;, theta, &quot; | a, b)&quot;))) + geom_segment(aes(x = 0, y = 0, xend = 0, yend = 1), linetype = &quot;dotted&quot; ) + geom_segment(aes(x = 1, y = 0, xend = 1, yend = 1), linetype = &quot;dotted&quot; ) + geom_segment(aes(x = 0, y = 0, xend = 1, yend = 0), linetype = &quot;dotted&quot; ) + geom_segment(aes(x = -0.25, y = 0, xend = 0, yend = 0)) + geom_segment(aes(x = 1, y = 0, xend = 1.25, yend = 0)) + geom_point(aes(x = 0, y = 0), size = 1.5, shape = 21, fill = &quot;#ffffe6&quot; ) + geom_point(aes(x = 1, y = 0), size = 1.5, shape = 21, fill = &quot;#ffffe6&quot; ) uniform_pdf_plot Dal grafico vediamo che l’area sottesa alla funzione di densità è \\((b - a)\\times c\\). Dato che tale area deve essere unitaria, ovvero, \\((b - a) \\times c = 1\\), possiamo trovare \\(c\\) dividendo entrambi i termini per \\(b - a\\), \\[ c = \\frac{\\displaystyle{1}}{\\displaystyle b - a}. \\] Ovvero, se \\(\\Theta \\sim \\mbox{Uniform}(a, b)\\), allora \\[ p_{\\Theta}(\\theta) = \\mbox{Uniform}(\\theta \\mid a, b), \\] laddove \\[ \\mbox{Uniform}(\\theta \\mid a, b) = \\frac{1}{b - a}. \\] In conclusione, la densità di una variabile casuale uniforme continua non dipende da \\(\\theta\\) — è costante e identica per ogni possibile valore \\(\\theta\\).9 Vedremo nel prossimo Paragrafo che, eseguendo una trasformazione su questa variabile casuale uniforme, possiamo creare altre variabili casuali di interesse. Esercizio 8.1 Si consideri una variabile casuale uniforme \\(X\\) definita sull’intervallo [0, 100]. Si trovi la probabilità \\(P(20 &lt; X &lt; 60)\\). Per trovare la soluzione è sufficiente calcolare l’area di un rettangolo di base \\(60 - 20 = 40\\) e di altezza 1/100. La probabilità cercata è dunque \\(P(20 &lt; X &lt; 60) = 40 \\cdot 0.01 = 0.4\\). Per comodità, possiamo assumere che i valori impossibili di \\(\\theta\\) abbiano una densità uguale a zero.↩︎ "],["la-trasformazione-logit.html", "8.4 La trasformazione logit", " 8.4 La trasformazione logit Supponiamo che \\(\\Theta\\) sia una variabile casuale con una distribuzione continua uniforme sull’intervallo [0, 1], cioè \\(\\Theta \\sim Uniform(0, 1)\\). Vedremo ora come, partendo dalla distribuzione uniforme, sia possibile generare una nuova variable casuale la cui funzione di densità si chiama distribuzione logistica. Data una variabile casuale uniforme continua \\(\\Theta \\in (0, 1)\\), possiamo definire i suoi log odds come \\[\\begin{equation} \\mbox{logit}(\\theta) = \\log \\frac{\\theta}{1 - \\theta}, \\tag{8.1} \\end{equation}\\] ovvero come il logaritmo naturale degli odds, \\(\\frac{\\theta}{1 -\\theta}\\). Chiameremo \\[ \\Phi = \\mbox{logit}(\\Theta) \\] la variabile casuale le cui realizzazoni sono i logit (log odds) di \\(\\Theta\\). Per comprendere la distribuzione di \\(\\Phi\\) facciamo nuovamente ricorso alla simulazione. Iniziamo con il generare un certo numero di realizzazioni \\(\\Theta\\) dalle quali otteniamo \\(\\Phi = \\mathrm{logit}(\\Theta)\\). Mediante un istogramma esaminiamo la distribuzione dei valori \\(\\Phi\\) che abbiamo trovato. Notiamo che, anche se \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\), la variabile casuale \\(\\Phi = \\mbox{logit}(\\Theta)\\) non è distribuita in maniera uniforme. Un’altra caratteristica di \\(\\Phi\\) è che la distribuzione dei suoi valori è simmetrica intorno allo zero. Infine, dall’istogramma vediamo che la distribuzione di \\(\\Phi\\) è quasi completamente contenuta nell’intervallo \\(\\pm 6\\) dall’origine. df_log_odds &lt;- data.frame(alpha = alpha) log_odds_plot &lt;- ggplot(df_log_odds, aes(alpha)) + geom_histogram( binwidth = 0.5, color = &quot;black&quot;, size = 0.25 ) + scale_x_continuous( breaks = c(-6, -4, -2, 0, 2, 4, 6) ) + scale_y_continuous( lim = c(0, 1300), breaks = c(500, 1000) ) + xlab( expression(paste(Phi, &quot; = &quot;, logit(Theta))) ) log_odds_plot FIGURA 8.5: Istogramma di \\(10\\,000\\) realizzazioni \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\) trasformate mediante la funzione logit \\(\\Phi = \\mbox{logit}(\\Theta).\\) Lo zero sulla scala dei logit corrisponde a 0.5 sulla scala delle probabilità, cioè \\[ 0 = \\mbox{logit}(0.5), \\] o equivalenteente, \\[ \\mbox{logit}^{-1}(0) = 0.5. \\] L’inverso della funzione logit è dato dalla funzione logistica \\[\\begin{equation} \\mbox{logit}^{-1}(u) = \\frac{1}{1 + \\exp(-u)}. \\tag{8.2} \\end{equation}\\] Questo non è sorprendente dato che \\[ \\mbox{logit}^{-1}(-6) = 0.0025 \\] e \\[ \\mbox{logit}^{-1}(6) = 0.9975 \\] sulla scala delle probabilità. Possiamo anche fare quello che abbiamo fatto per le distribuzioni uniformi e, mediante simulazione, generare la funzione di ripartizione di \\(\\Phi\\) (figura 8.6). logit &lt;- function(u) log(u / (1 - u)) M &lt;- 1000 phi &lt;- logit(runif(M)) phi_asc &lt;- sort(phi) prob &lt;- (1:M) / M logistic_cdf_df &lt;- data.frame(phi = phi_asc, prob = prob) logistic_cdf_plot &lt;- ggplot(logistic_cdf_df, aes(x = phi, y = prob)) + geom_line() + geom_hline( yintercept = 1, size = 0.3, linetype = &quot;dashed&quot;, color = &quot;#333333&quot; ) + geom_hline( yintercept = 0, size = 0.3, linetype = &quot;dashed&quot;, color = &quot;#333333&quot; ) + geom_vline( xintercept = 0, size = 0.3, linetype = &quot;dotted&quot;, color = &quot;#333333&quot; ) + geom_hline( yintercept = 0.5, size = 0.3, linetype = &quot;dotted&quot;, color = &quot;#333333&quot; ) + scale_x_continuous( lim = c(-7, 7), breaks = c(-6, -4, -2, 0, 2, 4, 6) ) + scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1.0)) + xlab(expression(phi)) + ylab(expression(F[Phi](phi))) logistic_cdf_plot FIGURA 8.6: Grafico della funzione di distribuzione cumulativa di una variabile casuale \\(\\Phi = \\mbox{logit}(\\Theta)\\) che rappresenta la trasformazione logaritmica di una variabile casuale distribuita uniformemente \\(\\Theta \\sim \\mbox{uniform }(0, 1)\\). La curva ha una forma sigmoidale. Gli asintoti a 0 e 1 sono indicati con linee tratteggiate; la curva è simmetrica intorno allo 0 sull’asse \\(x\\) e a 0.5 sull’asse \\(y\\), come evidenziato dalle linee punteggiate. Il risultato è una funzione a forma sigmoidale i cui valori sono compresi tra 0 e 1, con asintoti a uno quando \\(\\theta\\) tende a \\(+\\infty\\) e a zero quando \\(\\theta\\) tende a \\(-\\infty\\). In corrispondenza di \\(\\Phi\\) = 0 troviamo il valore 0.5. La curva prodotta dalla simulazione è una curva molto nota chiamata funzione logistica. In termini analitici, la funzione logistica viene espressa come segue: \\[\\begin{equation} F_{\\Theta}(\\theta) = \\mathrm{logit}^{-1}(\\theta) = \\frac{1}{1 + \\exp(-\\theta)}, \\tag{8.3} \\end{equation}\\] con \\(\\theta \\in [0, 1].\\) "],["dagli-istogrammi-alle-densità.html", "8.5 Dagli istogrammi alle densità", " 8.5 Dagli istogrammi alle densità Non esiste l’equivalente di una funzione di massa di probabilità per le variabili casuali continue. Esiste invece una funzione di densità di probabilità la quale, nei termini di una simulazione, può essere concepita nel modo seguente: avendo a disposizione un numero enorme di casi, quando l’intervallo \\(\\Delta\\) di ciascuna classe \\(\\rightarrow\\) 0, la spezzata tende a diventare una curva continua. Tale curva continua \\(f(x)\\) è detta funzione di densità di probabilità. Come si trasformano gli istogrammi all’aumentare del numero di osservazioni? Nei grafici seguenti, la numerosità cresce da \\(10\\) a \\(1\\,000\\,000\\). df_log_odds_growth &lt;- data.frame() for (log10M in 1:6) { M &lt;- 10^log10M alpha &lt;- logit(runif(M)) df_log_odds_growth &lt;- rbind( df_log_odds_growth, data.frame( alpha = alpha, M = rep(sprintf(&quot;M = %d&quot;, M), M) ) ) } log_odds_growth_plot &lt;- df_log_odds_growth %&gt;% ggplot(aes(alpha)) + geom_histogram(color = &quot;black&quot;, bins = 75) + facet_wrap(~M, scales = &quot;free&quot;) + scale_x_continuous( lim = c(-8.5, 8.5), breaks = c(-5, 0, 5) ) + xlab(expression(paste(Phi, &quot; = &quot;, logit(Theta)))) + ylab(&quot;proportion of draws&quot;) + theme( axis.text.y = element_blank(), axis.ticks.y = element_blank(), panel.spacing.x = unit(2, &quot;lines&quot;), panel.spacing.y = unit(2, &quot;lines&quot;) ) log_odds_growth_plot FIGURA 8.7: Istogramma di \\(M\\) campioni casuali \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\) trasformati in valori \\(\\Phi = \\mbox{logit}(\\Theta).\\) Il profilo limite dell’istogramma è evidenziato nella figura in basso a destra che è stata costruita usando \\(1\\,000\\,000\\) di osservazioni. In un istogramma, l’area di ciascuna barra è proporzionale alla frequenza relativa delle osservazioni in quel’intervallo. Perché tutti gli intervalli hanno la stessa ampiezza, anche l’altezza di ciascuna barra sarà proporzionale alla frequenza relativa delle osservazioni in quel’intervallo. Nella simulazione, possiamo pensare all’area di ciascuna barra dell’istogramma come alla stima della probabilità che la variabile casuale assuma un valore compreso nell’intervallo considerato. All’aumentare del numero \\(M\\) di osservazioni, le probabilità stimate si avvicinano sempre di più ai veri valori della probabilità. All’aumentare del numero degli intervalli (quando l’ampiezza \\(\\Delta\\) dell’intervallo \\(\\rightarrow\\) 0), il profilo dell’istogramma tende a diventare una curva continua. Tale curva continua è la funzione di densità di probabilità della variabile casuale. Per l’esempio presente, con \\(M =1\\,000\\,000\\), otteniamo il grafico riportato nella figura 8.8. M &lt;- 1e6 alpha &lt;- logit(runif(M)) density_limit_df &lt;- data.frame(alpha = alpha) density_limit_plot &lt;- density_limit_df %&gt;% ggplot(aes(alpha)) + geom_histogram( stat = &quot;density&quot;, n = 75, color = &quot;black&quot;, size = 0.15 ) + stat_function( fun = dlogis, args = list(location = 0, scale = 1), col = &quot;black&quot;, size = 0.3 ) + scale_x_continuous( lim = c(-9, 9), breaks = c(-6, -4, -2, 0, 2, 4, 6) ) + xlab( expression(paste(Phi, &quot; = &quot;, logit(Theta))) ) + ylab(&quot;Frequenza relativa&quot;) + theme( axis.text.y = element_blank(), axis.ticks.y = element_blank() ) density_limit_plot FIGURA 8.8: Istogramma di \\(M = 1\\,000\\,000\\) campioni casuali \\(\\Theta \\sim \\mbox{Uniform}(0,1)\\) trasformati in valori \\(\\Phi = \\mbox{logit}(\\Theta)\\). La spezzata nera congiunge i punti centrali superiori delle barre dell’istogramma. Nel limite, quando il numero di osservazioni e di barre tende all’infinito, tale spezzata approssima la funzione di densità di probabilità della variabile casuale. Nella statistica descrittiva abbiamo già incontrato una rappresentazione che ha lo stesso significato della funzione di densità, ovvero il kernel density plot. La stima della densità del kernel (KDE), infatti, è un modo non parametrico per stimare la funzione di densità di probabilità di una variabile casuale. "],["funzione-di-densità-di-probabilità.html", "8.6 Funzione di densità di probabilità", " 8.6 Funzione di densità di probabilità Per descrivere le probabilità che possono essere associate ad una variabile casuale continua \\(X\\) è necessario definire una funzione \\(p(X)\\) che deve soddisfare le seguenti due proprietà: \\(p(x) \\geq 0, \\forall x\\), ovvero, l’ordinata della funzione di densità è 0 o positiva; \\(\\int_{-\\infty}^{\\infty} p(x) \\,\\operatorname {d}\\!x = 1\\), ovvero, l’area sottesa dalla \\(p(x)\\) è unitaria10; \\(p(a &lt; x &lt; b) = \\int_a^b p(x) \\,\\operatorname {d}\\!x\\), se \\(a \\leq b\\), ovvero, l’area sottesa dalla \\(p(y)\\) tra due punti \\(a\\) e \\(b\\) corrisponde alla probabilità che la v.c. \\(x\\) assuma un valore compresto tra questi due estremi. Interpretazione. È possibile che \\(p(x) &gt; 1\\), quindi una densità di probabilità non può essere interpretata come una probabilità. Piuttosto, la densità \\(p(x)\\) può essere utilizzata per confrontare la plausibilità relativa di diversi valori \\(X\\). Considerata una variabile casuale \\(X\\) di cui è disponibile un insieme di realizzazioni, tanto maggiore è \\(p(x_k)\\) rispetto a \\(p(x_l)\\), tanto più grande sarà la nostra certezza che valori nell’intorno di \\(x_k\\) verranno osservati con maggiore frequenza di valori nell’intorno di \\(x_l\\). Per quel che riguarda la notazione dell’integrale, ovvero \\(\\int_x \\,\\operatorname {d}\\!x\\), rimando alla discussione di S.P. Thompson: https://calculusmadeeasy.org/1.html↩︎ "],["exp-val-and-variance-rv.html", "Capitolo 9 Valore atteso e varianza", " Capitolo 9 Valore atteso e varianza Spesso risulta utile fornire una rappresentazione sintetica della distribuzione di una variabile casuale attraverso degli indicatori caratteristici piuttosto che fare riferimento ad una sua rappresentazione completa mediante la funzione di ripartizione, o la funzione di massa o di densità di probabilità. Una descrizione più sintetica di una variabile casuale, tramite pochi valori, ci consente di cogliere le caratteristiche essenziali della distribuzione, quali: la posizione, cioè il baricentro della distribuzione di probabilità; la variabilità, cioè la dispersione della distribuzione di probabilità attorno ad un centro; la forma della distribuzione di probabilità, considerando la simmetria e la curtosi (pesantezza delle code). In questo Capitolo introdurremo quegli indici sintetici che descrivono il centro di una distribuzione di probabilità e la sua variabilità. "],["valore-atteso.html", "9.1 Valore atteso", " 9.1 Valore atteso Quando vogliamo conoscere il comportamento tipico di una variabile casuale spesso vogliamo sapere qual è il suo “valore tipico”. La nozione di “valore tipico”, tuttavia, è ambigua. Infatti, essa può essere definita in almeno tre modi diversi: la media (somma dei valori divisa per il numero dei valori), la mediana (il valore centrale della distribuzione, quando la variabile è ordinata in senso crescente o decrescente), la moda (il valore che ricorre più spesso). Per esempio, la media di \\(\\{3, 1, 4, 1, 5\\}\\) è \\(\\frac{3+1+4+1+5}{5} = 2.8\\), la mediana è \\(3\\) e la moda è \\(1\\). Tuttavia, la teoria delle probabilità si occupa di variabili casuali piuttosto che di sequenze di numeri. Diventa dunque necessario precisare che cosa intendiamo per “valore tipico” quando facciamo riferimento alle variabili casuali. Giungiamo così alla seguente definizione. Definizione 9.1 Sia \\(Y\\) è una variabile casuale discreta che assume i valori \\(y_1, \\dots, y_n\\) con distribuzione \\(p(y)\\), ossia \\[ P(Y = y_i) = p(y_i), \\] per definizione il valore atteso di \\(Y\\), \\(\\E(Y)\\), è \\[\\begin{equation} \\E(Y) = \\sum_{i=1}^n y_i \\cdot p(y_i). \\tag{9.1} \\end{equation}\\] A parole: il valore atteso (o speranza matematica, o aspettazione, o valor medio) di una variabile casuale è definito come la somma di tutti i valori che la variabile casuale può prendere, ciascuno pesato dalla probabilità con cui il valore è preso. Esercizio 9.1 Calcoliamo il valore atteso della variabile casuale \\(Y\\) corrispondente al lancio di una moneta equilibrata (testa: Y = 1; croce: Y = 0). \\[ \\E(Y) = \\sum_{i=1}^{2} y_i \\cdot P(y_i) = 0 \\cdot \\frac{1}{5} + 1 \\cdot \\frac{1}{5} = 0.5. \\] Esercizio 9.2 Supponiamo ora che Y sia il risultato del lancio di un dado equilibrato. Il valore atteso di Y diventa: \\[ \\E(Y) = \\sum_{i=1}^{6} y_i \\cdot P(y_i) = 1 \\cdot \\frac{1}{6} + 2 \\cdot \\frac{1}{6} + \\dots + 6 \\cdot \\frac{1}{6} = \\frac{21}{6} = 3.5. \\] 9.1.1 Interpretazione Che interpretazione può essere assegnata alla nozione di valore atteso? Bruno de Finetti adottò lo stesso termine di previsione (e lo stesso simbolo) tanto per la probabilità che per la speranza matematica. Si può pertanto dire che, dal punto di vista bayesiano, la speranza matematica è l’estensione naturale della nozione di probabilità soggettiva.11 9.1.2 Proprietà del valore atteso La proprietà più importante del valore atteso è la linearità: il valore atteso di una somma di variabili casuali è uguale alla somma dei lori rispettivi valori attesi: \\[\\begin{equation} \\E(X + Y) = \\E(X) + \\E(Y). \\tag{9.2} \\end{equation}\\] La (9.2) sembra ragionevole quando \\(X\\) e \\(Y\\) sono indipendenti, ma è anche vera quando \\(X\\) e \\(Y\\) sono associati. Abbiamo anche che \\[\\begin{equation} \\E(cY) = c \\E(Y). \\tag{9.3} \\end{equation}\\] La (9.3) ci dice che possiamo estrarre una costante dall’operatore di valore atteso. Tale proprietà si estende a qualunque numero di variabili casuali. Infine, se due variabili casuali \\(X\\) e \\(Y\\) sono indipendenti, abbiamo che \\[\\begin{equation} \\E(X Y) = \\E(X) \\E(Y). \\tag{9.4} \\end{equation}\\] Esercizio 9.3 Si considerino le seguenti variabili casuali: \\(Y\\), ovvero il numero che si ottiene dal lancio di un dado equilibrato, e \\(Y\\), il numero di teste prodotto dal lancio di una moneta equilibrata. Poniamoci il problema di trovare il valore atteso di \\(X+Y\\). Per risolvere il problema iniziamo a costruire lo spazio campionario dell’esperimento casuale consistente nel lancio di un dado e di una moneta. \\(x/ y\\) 1 2 3 4 5 6 0 (0, 1) (0, 2) (0, 3) (0, 4) (0, 5) (0, 6) 1 (1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6) ovvero \\(x/ y\\) 1 2 3 4 5 6 0 1 2 3 4 5 6 1 2 3 4 5 6 7 Il risultato del lancio del dado è indipendente dal risultato del lancio della moneta. Pertanto, ciascun evento elementare dello spazio campionario avrà la stessa probabilità di verificarsi, ovvero \\(Pr(\\omega) = \\frac{1}{12}\\). Il valore atteso di \\(X+Y\\) è dunque uguale a: \\[ \\E(X+Y) = 1 \\cdot \\frac{1}{12} + 2 \\cdot \\frac{1}{12} + \\dots + 7 \\cdot \\frac{1}{12} = 4.0. \\] Lo stesso risultato si ottiene nel modo seguente: \\[ \\E(X+Y) = \\E(X) + E(Y) = 3.5 + 0.5 = 4.0. \\] Esercizio 9.4 Si considerino le variabili casuali \\(X\\) e \\(Y\\) definite nel caso del lancio di tre monete equilibrate, dove \\(X\\) conta il numero delle teste nei tre lanci e \\(Y\\) conta il numero delle teste al primo lancio. Si calcoli il valore atteso del prodotto delle variabili casuali \\(X\\) e \\(Y\\). La distribuzione di probabilità congiunta \\(P(X, Y)\\) è fornita nella tabella seguente. \\(x/ y\\) 0 1 \\(p(Y)\\) 0 1/8 0 1/8 1 2/8 1/8 3/8 2 1/8 2/8 3/8 3 0 1/8 1/8 \\(p(y)\\) 4/8 4/8 1.0 Il calcolo del valore atteso di \\(XY\\) si riduce a \\[ \\E(XY) = 1 \\cdot \\frac{1}{8} + 2 \\cdot \\frac{2}{8} + 3 \\cdot \\frac{1}{8} = 1.0. \\] Si noti che le variabili casuali \\(Y\\) e \\(Y\\) non sono indipendenti. Dunque non possiamo usare la proprietà ??. Infatti, il valore atteso di \\(X\\) è \\[ \\E(X) = 1 \\cdot \\frac{3}{8} + 2 \\cdot \\frac{3}{8} + 3 \\cdot \\frac{1}{8} = 1.5 \\] e il valore atteso di \\(Y\\) è \\[ \\E(Y) = 0 \\cdot \\frac{4}{8} + 1 \\cdot \\frac{4}{8} = 0.5. \\] Dunque \\[ 1.5 \\cdot 0.5 \\neq 1.0. \\] 9.1.3 Variabili casuali continue Nel caso di una variabile casuale continua \\(Y\\) il valore atteso diventa: \\[\\begin{equation} \\E(Y) = \\int_{-\\infty}^{+\\infty} y p(y) \\,\\operatorname {d}\\!y \\tag{9.5} \\end{equation}\\] Anche in questo caso il valore atteso è una media ponderata della \\(y\\), nella quale ciascun possibile valore \\(y\\) è ponderato per il corrispondente valore della densità \\(p(y)\\). Possiamo leggere l’integrale pensando che \\(y\\) rappresenti l’ampiezza delle barre infinitamente strette di un istogramma, con la densità \\(p(y)\\) che corrisponde all’altezza di tali barre e la notazione \\(\\int_{-\\infty}^{+\\infty}\\) che corrisponde ad una somma. Un’altra misura di tendenza centrale delle variabili casuali continue è la moda. La moda della \\(Y\\) individua il valore \\(y\\) più plausibile, ovvero il valore \\(y\\) che massimizza la funzione di densità \\(p(y)\\): \\[\\begin{equation} \\Mo(Y) = \\argmax_y p(y). \\tag{9.6} \\end{equation}\\] Per completezza – che potrebbe anche essere evitata – aggiungo qui l’interpretazione frequentista. I frequentisti pensano al valore atteso della variabile casuale \\(Y\\) come alla media di un enorme numero di realizzazioni della \\(Y\\). Se si potesse esaminare un numero infinito di realizzazioni \\(Y\\), allora la media di tali infiniti valori sarebbe esattamente uguale al valore atteso. Allora perché abbiamo bisogno di introdurre un concetto diverso da quello di “media”? La risposta è che la media aritmetica è una somma divisa per \\(n\\): \\(\\bar{Y} = \\frac{\\sum_{i=1}^n y_i}{n}.\\) Le variabili casuali possono generare un numero infinito di valori possibili. Dato che dividere per infinito non è possibile, è necessario procedere in un altro modo. Possiamo dire, in termini frequentisti, che il valore atteso di una variabile casuale è una media ponderata in cui il valore assegnato a ciacun evento elementare dello spazio campionario viene “pesato” per la sua probabilità di verificarsi, nel caso di variabili casuali discrete, o per la sua densità di probabilità, nel caso di variabili casuali continue. Il termine valore atteso è però un po’ fuorviante. Infatti, esso potrebbe non corrispondere a nessuno dei valori che possono essere generati dalla variabile casuale. Quindi il valore atteso non è “atteso” nel senso che ci aspettiamo di vederlo comparire spesso. Ci aspettiamo invece che sia simile alla media di qualsiasi campione sufficientemente grande di realizzazioni della variabile casuale: \\(\\E(Y) = \\lim_{n \\rightarrow \\infty} \\frac{1}{n} \\sum_{i = 1}^n y_i.\\).↩︎ "],["varianza-1.html", "9.2 Varianza", " 9.2 Varianza La seconda più importante proprietà di una variabile casuale, dopo che conosciamo il suo valore atteso, è la varianza. Definizione 9.2 Se \\(Y\\) è una variabile casuale discreta con distribuzione \\(p(y)\\), per definizione la varianza di \\(Y\\), \\(\\Var(Y)\\), è \\[\\begin{equation} \\Var(Y) = \\E\\Big[\\big(Y - \\E(Y)\\big)^2\\Big]. \\tag{9.7} \\end{equation}\\] A parole: la varianza è la deviazione media quadratica della variabile dalla sua media.12 Se denotiamo \\(\\E(Y) = \\mu\\), la varianza \\(\\Var(Y)\\) diventa il valore atteso di \\((Y - \\mu)^2\\). Esercizio 9.5 Posta \\(S\\) uguale alla somma dei punti ottenuti nel lancio di due dadi equilibrati, poniamoci il problema di calcolare la varianza di \\(S\\). La variabile casuale \\(S\\) ha la seguente distribuzione di probabilità: \\(s\\) 2 3 4 5 6 7 8 9 10 11 12 \\(P(S = s)\\) \\(\\frac{1}{36}\\) \\(\\frac{2}{36}\\) \\(\\frac{3}{36}\\) \\(\\frac{4}{36}\\) \\(\\frac{5}{36}\\) \\(\\frac{6}{36}\\) \\(\\frac{5}{36}\\) \\(\\frac{4}{36}\\) \\(\\frac{3}{36}\\) \\(\\frac{2}{36}\\) \\(\\frac{1}{36}\\) Essendo \\(\\E(S) = 7\\), la varianza diventa \\[\\begin{align} \\Var(S) &amp;= \\sum \\left(S- \\mathbb{E}(S)\\right)^2 \\cdot P(S) \\notag\\\\ &amp;= (2 - 7)^2 \\cdot 0.0278 + (3-7)^2 \\cdot 0.0556 + \\dots + (12 - 7)^2 \\cdot 0.0278 \\notag\\\\ &amp;= 5.8333.\\notag \\end{align}\\] 9.2.1 Formula alternativa per la varianza C’è un modo più semplice per calcolare la varianza: \\[\\begin{align} \\E\\Big[\\big(X - \\E(Y)\\big)^2\\Big] &amp;= \\E\\big(X^2 - 2X\\E(Y) + \\E(Y)^2\\big)\\notag\\\\ &amp;= \\E(Y^2) - 2\\E(Y)\\E(Y) + \\E(Y)^2,\\notag \\end{align}\\] dato che \\(\\E(Y)\\) è una costante; pertanto \\[\\begin{equation} \\Var(Y) = \\E(Y^2) - \\big(\\E(Y) \\big)^2. \\tag{9.8} \\end{equation}\\] A parole: la varianza è la media dei quadrati meno il quadrato della media. Esercizio 9.6 Consideriamo la variabile casuale \\(Y\\) che corrisponde al numero di teste che si osservano nel lancio di una moneta truccata con probabilità di testa uguale a 0.8. Il valore atteso di \\(Y\\) è \\[ \\E(Y) = 0 \\cdot 0.2 + 1 \\cdot 0.8 = 0.8. \\] Usando la formula tradizionale della varianza otteniamo: \\[ \\Var(Y) = (0 - 0.8)^2 \\cdot 0.2 + (1 - 0.8)^2 \\cdot 0.8 = 0.16. \\] Lo stesso risultato si trova con la formula alternativa della varianza. Il valore atteso di \\(Y^2\\) è \\[ \\E(Y^2) = 0^2 \\cdot 0.2 + 1^2 * 0.8 = 0.8. \\] e la varianza diventa \\[ \\Var(Y) = \\E(Y^2) - \\big(\\E(Y) \\big)^2 = 0.8 - 0.8^2 = 0.16. \\] 9.2.2 Variabili casuali continue Nel caso di una variabile casuale continua \\(Y\\), la varianza diventa: \\[\\begin{equation} \\Var(Y) = \\int_{-\\infty}^{+\\infty} \\large[y - \\E(Y)\\large]^2 p(y) \\,\\operatorname {d}\\!y \\tag{9.9} \\end{equation}\\] Come nel caso discreto, la varianza di una v.c. continua \\(y\\) misura approssimativamente la distanza al quadrato tipica o prevista dei possibili valori \\(y\\) dalla loro media. Data una variabile casuale \\(Y\\) con valore atteso \\(\\E(Y)\\), le “distanze” tra i valori di \\(Y\\) e il valore atteso \\(\\E(Y)\\) definiscono la variabile casuale \\(Y - \\E(Y)\\) chiamata scarto, oppure deviazione oppure variabile casuale centrata. La variabile \\(Y - \\E(Y)\\) equivale ad una traslazione di sistema di riferimento che porta il valore atteso nell’origine degli assi. Si può dimostrare facilmente che il valore atteso della variabile scarto \\(Y - \\E(Y)\\) vale zero, dunque la media di tale variabile non può essere usata per quantificare la “dispersione” dei valori di \\(Y\\) relativamente al suo valore medio. Occorre rendere sempre positivi i valori di \\(Y - \\E(Y)\\) e tale risultato viene ottenuto considerando la variabile casuale \\(\\left(Y - \\E(Y)\\right)^2\\).↩︎ "],["deviazione-standard.html", "9.3 Deviazione standard", " 9.3 Deviazione standard Quando lavoriamo con le varianze, i termini sono innalzati al quadrato e quindi i numeri possono diventare molto grandi (o molto piccoli). Per trasformare nuovamente i valori nell’unità di misura della scala originaria si prende la radice quadrata. Il valore risultante viene chiamato deviazione standard e solitamente è denotato dalla lettera greca \\(\\sigma\\). Definizione 9.3 Si definisce scarto quadratico medio (o deviazione standard o scarto tipo) la radice quadrata della varianza: \\[\\begin{equation} \\sigma_Y = \\sqrt{\\Var(Y)}. \\tag{9.10} \\end{equation}\\] Interpretiamo la deviazione standard di una variabile casuale come nella statistica descrittiva: misura approssimativamente la distanza tipica o prevista dei possibili valori \\(y\\) dalla loro media. Esercizio 9.7 Per i dadi equilibrati dell’esempio precedente, la deviazione standard della variabile casuale \\(S\\) è uguale a \\(\\sqrt{5.833} = 2.415\\). "],["standardizzazione.html", "9.4 Standardizzazione", " 9.4 Standardizzazione Definizione 9.4 Data una variabile casuale \\(Y\\), si dice variabile standardizzata di \\(Y\\) l’espressione \\[\\begin{equation} Z = \\frac{Y - \\E(Y)}{\\sigma_Y}. \\tag{9.11} \\end{equation}\\] Solitamente, una variabile standardizzata viene denotata con la lettera \\(Z\\). "],["momenti-di-variabili-casuali.html", "9.5 Momenti di variabili casuali", " 9.5 Momenti di variabili casuali Definizione 9.5 Si chiama momento di ordine \\(q\\) di una v.c. \\(X\\), dotata di densità \\(p(x)\\), la quantità \\[\\begin{equation} \\E(X^q) = \\int_{-\\infty}^{+\\infty} x^q p(x) \\; dx. \\end{equation}\\] Se \\(X\\) è una v.c. discreta, i suoi momenti valgono: \\[\\begin{equation} \\E(X^q) = \\sum_i x_i^q p(x_i). \\end{equation}\\] I momenti sono importanti parametri indicatori di certe proprietà di \\(X\\). I più noti sono senza dubbio quelli per \\(q = 1\\) e \\(q = 2\\). Il momento del primo ordine corrisponde al valore atteso di \\(X\\). Spesso i momenti di ordine superiore al primo vengono calcolati rispetto al valor medio di \\(X\\), operando una traslazione \\(x_0 = x − \\E(X)\\) che individua lo scarto dalla media. Ne deriva che il momento centrale di ordine 2 corrisponde alla varianza. "],["funzione-di-ripartizione.html", "9.6 Funzione di ripartizione", " 9.6 Funzione di ripartizione Il concetto di funzione di ripartizione è molto importante nella teoria della probabilità, sia nel caso discreto, sia in quello continuo. L’insieme \\(\\{\\omega: Y \\leq y\\}\\) è un evento in \\(\\Omega\\) e si può scrivere \\((Y \\leq y)\\). A tale evento è possibile assegnare una probabilità \\(P(Y \\leq y)\\) che, al variare di \\(y \\in \\mathbb{R}\\), definisce la funzione di ripartizione della variabile casuale \\(Y\\). Definizione 9.6 Si chiama funzione di ripartizione o funzione di distribuzione della variabile casuale \\(X\\) la funzione \\(F(X)\\) definita da \\[\\begin{equation} F(X) \\triangleq P(X \\le x), \\qquad x \\in \\mathbb{R}. \\tag{9.12} \\end{equation}\\] Detto a parole: la funzione di distribuzione cumulata, o funzione di ripartizione di \\(X\\), misura la probabilità che \\(X\\) assuma valori minori o uguali al valore \\(x\\). La funzione di ripartizione è sempre non negativa, monotona non decrescente tra \\(0\\) e \\(1\\), tale che: \\[ \\lim_{x \\to -\\infty} F_x(X) = F_X(-\\infty) = 0, \\quad \\lim_{x \\to +\\infty} F_X(X) = F_X(+\\infty) = 1. \\] Esercizio 9.8 Consideriamo l’esperimento casuale corrispondente al lancio di due monete. Sia \\(X\\) il numero di volte in cui esce testa. La distribuzione di probabilità di \\(X\\) è: \\[ P(X) = \\begin{cases} 0, &amp; 0.25,\\\\ 1, &amp; 0.50,\\\\ 2, &amp; 0.25. \\end{cases} \\] La funzione di ripartizione di \\(X\\) è: \\[ F(X) = \\begin{cases} 0, &amp; \\text{se } x &lt; 0,\\\\ 1/4, &amp; \\text{se } 0 \\leq x &lt; 1,\\\\ 3/4, &amp; \\text{se } 1 \\leq x &lt; 2,\\\\ 1, &amp; \\text{se } 2 \\leq x. \\end{cases} \\] Il valore della funzione di ripartizione in corrispondenza di \\(x = 1.5\\), ad esempio, è: \\[ F(1.5) = P(X \\leq 1.5) = P(X=0) + P(X=1) = \\frac{1}{4} + \\frac{2}{4} = \\frac{3}{4}. \\] "],["distr-rv-discr.html", "Capitolo 10 Distribuzioni di v.c. discrete", " Capitolo 10 Distribuzioni di v.c. discrete In questo Capitolo verranno esaminate le principali distribuzioni di probabilità delle variabili casuali discrete. Un esperimento casuale che può dare luogo a solo due possibili esiti (successo, insuccesso) è modellabile con una variabile casuale di Bernoulli. Una sequenza di prove di Bernoulli costituisce un processo Bernoulliano. Il numero di successi dopo \\(n\\) prove di Bernoulli corrisponde ad una variabile casuale che segue la legge binomiale. La distribuzione binomiale risulta da un insieme di prove di Bernoulli solo se il numero totale \\(n\\) è fisso per disegno. Se il numero di prove è esso stesso una variabile casuale, allora il numero di successi nella corrispondente sequenza di prove bernoulliane segue al distribuzione di Poisson. "],["una-prova-bernoulliana.html", "10.1 Una prova Bernoulliana", " 10.1 Una prova Bernoulliana Se un esperimento casuale ha solo due esiti possibili, allora le repliche indipendenti di questo esperimento sono chiamate “prove Bernoulliane” (il lancio di una moneta è il tipico esempio). Definizione 10.1 Viene detta variabile di Bernoulli una variabile casuale discreta \\(Y = \\{0, 1\\}\\) con la seguente distribuzione di probabilità: \\[ P(Y \\mid \\theta) = \\begin{cases} \\theta &amp; \\text{se $Y = 1$}, \\\\ 1 - \\theta &amp; \\text{se $Y = 0$}, \\end{cases} \\] con \\(0 \\leq \\theta \\leq 1\\). Convenzionalmente l’evento \\(\\{Y = 1\\}\\) con probabilità \\(\\theta\\) viene chiamato “successo” mentre l’evento \\(\\{Y = 0\\}\\) con probabilità \\(1-\\theta\\) viene chiamato “insuccesso”. Applicando l’operatore di valore atteso e di varianza, otteniamo \\[\\begin{align} \\E(Y) &amp;= 0 \\cdot Pr(Y=0) + 1 \\cdot Pr(Y=1) = \\theta, \\\\ \\Var(Y) &amp;= (0 - \\theta)^2 \\cdot Pr(Y=0) + (1 - \\theta)^2 \\cdot rP(Y=1) = \\theta(1-\\theta). \\tag{10.1} \\end{align}\\] Scriviamo \\(Y \\sim \\mathcal{B}(\\theta)\\) per indicare che la variabile casuale \\(Y\\) ha una distribuzione Bernoulliana di parametro \\(\\theta\\). Esercizio 10.1 Nel caso del lancio di una moneta equilibrata la variabile casuale di Bernoulli assume i valori \\(0\\) e \\(1\\). La distribuzione di massa di probabilità è pari a \\(\\frac{1}{2}\\) in corrispondenza di entrambi iv valori. La funzione di distribuzione vale \\(\\frac{1}{2}\\) per \\(Y = 0\\) e \\(1\\) per \\(Y = 1\\). "],["una-sequenza-di-prove-bernoulliane.html", "10.2 Una sequenza di prove Bernoulliane", " 10.2 Una sequenza di prove Bernoulliane La distribuzione binomiale è rappresentata dall’elenco di tutti i possibili numeri di successi \\(Y = \\{0, 1, 2, \\dots n\\}\\) che possono essere osservati in \\(n\\) prove Bernoulliane indipendenti di probabilità \\(\\theta\\), a ciascuno dei quali è associata la relativa probabilità. Esempi di una distribuzione binomiale sono i risultati di una serie di lanci di una stessa moneta o di una serie di estrazioni da un’urna (con reintroduzione). La distribuzione binomiale di parametri \\(n\\) e \\(\\theta\\) è in realtà una famiglia di distribuzioni: al variare dei parametri \\(\\theta\\) e \\(n\\) variano le probabilità. Definizione 10.2 La probabilità di ottenere \\(y\\) successi e \\(n-y\\) insuccessi in \\(n\\) prove Bernoulliane è data dalla distribuzione binomiale: \\[\\begin{align} P(Y=y) &amp;= \\binom{n}{y} \\theta^{y} (1-\\theta)^{n-y} \\notag \\\\ &amp;= \\frac{n!}{y!(n-y)!} \\theta^{y} (1-\\theta)^{n-y}, \\tag{10.2} \\end{align}\\] dove \\(n\\) = numero di prove Bernoulliane, \\(\\theta\\) = probabilità di successo in ciascuna prova e \\(y\\) = numero di successi. Proof. La (10.2) può essere derivata nel modo seguente. Indichiamo con \\(S\\) il successo e con \\(I\\) l’insuccesso di ciascuna prova. Una sequenza di \\(n\\) prove Bernoulliane darà come esito una sequenza di \\(n\\) elementi \\(S\\) e \\(I\\). Ad esempio, una sequenza che contiene \\(y\\) successi è la seguente: \\[ \\overbrace{SS\\dots S}^\\text{$y$ volte} \\overbrace{II\\dots I}^\\text{$n-y$ volte} \\] Essendo \\(\\theta\\) la probabilità di \\(S\\) e \\(1-\\theta\\) la probabilità di \\(I\\), la probabilità di ottenere la specifica sequenza riportata sopra è \\[\\begin{equation} \\overbrace{\\theta \\theta\\dots \\theta}^\\text{$y$ volte} \\overbrace{(1-\\theta)(1-\\theta)\\dots (1-\\theta)}^\\text{$n-y$ volte} = \\theta^y \\cdot (1-\\theta)^{n-y}. \\tag{10.3} \\end{equation}\\] Non siamo però interessati alla probabilità di una specifica sequenza di \\(S\\) e \\(I\\) ma, bensì, alla probabilità di osservare una qualsiasi sequenza di \\(y\\) successi in \\(n\\) prove. In altre parole, vogliamo la probabilità dell’unione di tutti gli eventi corrispondenti a \\(y\\) successi in \\(n\\) prove. È immediato notare che una qualsiasi altra sequenza contenente esattamente \\(y\\) successi avrà sempre come probabilità \\(\\theta^y \\cdot (1-\\theta)^{n-y}\\): il prodotto infatti resta costante anche se cambia l’ordine dei fattori.13 Per trovare il risultato cercato dobbiamo moltiplicare la (10.3) per il numero di sequenze possibili di \\(y\\) successi in \\(n\\) prove. Il numero di sequenze che contengono esattamente \\(y\\) successi in \\(n\\) prove. La risposta è fornita dal coefficiente binomiale14: \\[\\begin{equation} \\binom{n}{y} = \\frac{n!}{y!(n-y)!}, \\tag{10.4} \\end{equation}\\] dove il simbolo \\(n!\\) si legge \\(n\\) fattoriale ed è uguale al prodotto di \\(n\\) numeri interi decrescenti a partire da \\(n\\). Per definizione \\(0! = 1\\). Essendo la probabilità dell’unione di \\(K\\) elementi incompatibili uguale alla somma delle loro rispettive probabilità, e dato che le sequenze di \\(y\\) successi in \\(n\\) prove hanno tutte la stessa probabilità, per trovare la formula della distributione binomiale (10.2) è sufficiente moltiplicare la (10.3) per la (10.4). La distribuzione di probabilità di alcune distribuzioni binomiali, per due valori di \\(n\\) e \\(\\theta\\), è fornita nella figura 10.1. FIGURA 10.1: Alcune distribuzioni binomiali. Nella figura, il parametro \\(\\theta\\) è indicato con \\(p\\). Esercizio 10.2 Usando la (10.2), si trovi la probabilità di \\(y = 2\\) successi in \\(n = 4\\) prove Bernoulliane indipendenti con \\(\\theta = 0.2\\) \\[ \\begin{aligned} P(Y=2) &amp;= \\frac{4!}{2!(4-2)!} 0.2^{2} (1-0.2)^{4-2} \\notag \\\\ &amp;= \\frac{4 \\cdot 3 \\cdot 2 \\cdot 1}{(2 \\cdot 1)(2 \\cdot 1)} 0.2^{2} 0.8^{2} = 0.1536. \\notag \\end{aligned} \\] Ripetendo i calcoli per i valori \\(y = 0, \\dots, 4\\) troviamo la distribuzione binomiale di parametri \\(n = 4\\) e \\(\\theta = 0.2\\): y P(Y = y) 0 0.4096 1 0.4096 2 0.1536 3 0.0256 4 0.0016 sum 1.0 Lo stesso risultato si ottiene usando la sequente istruzione : dbinom(0:4, 4, 0.2) #&gt; [1] 0.4096 0.4096 0.1536 0.0256 0.0016 Esercizio 10.3 Lanciando \\(5\\) volte una moneta onesta, qual è la probabilità che esca testa almeno tre volte? In , la soluzione si trova con dbinom(3, 5, 0.5) + dbinom(4, 5, 0.5) + dbinom(5, 5, 0.5) #&gt; [1] 0.5 Alternativamente, possiamo trovare la probabilità dell’evento complementare a quello definito dalla funzione di ripartizione calcolata mediante pbinom(), ovvero 1 - pbinom(2, 5, 0.5) #&gt; [1] 0.5 10.2.1 Valore atteso e deviazione standard La media (numero atteso di successi in \\(n\\) prove) e la deviazione standard di una distribuzione binomiale sono molto semplici: \\[\\begin{align} \\mu &amp;= n\\theta, \\notag \\\\ \\sigma &amp;= \\sqrt{n\\theta(1-\\theta)}. \\end{align}\\] Proof. Essendo \\(Y\\) la somma di \\(n\\) prove Bernoulliane indipendenti \\(Y_i\\), è facile vedere che \\[\\begin{align} \\E(Y) &amp;= \\E \\left( \\sum_{i=1}^n Y_i \\right) = \\sum_{i=1}^n \\E(Y_i) = n\\theta, \\\\ \\Var(Y) &amp;= \\Var \\left( \\sum_{i=1}^n Y_i \\right) = \\sum_{i=1}^n \\Var(Y_i) = n \\theta (1-\\theta). \\end{align}\\] Esercizio 10.4 Si trovino il valore atteso e la varianza del lancio di quattro monete con probabilità di successo pari a \\(\\theta = 0.2\\). Il valore atteso è \\(\\mu = n\\theta = 4 \\cdot 0.2 = 0.8.\\) Ciò significa che, se l’esperimento casuale venisse ripetuto infinite volte, l’esito testa verrebbe osservato un numero medio di volte pari a 0.8. La varianza è \\(n \\theta (1-\\theta) = 4 \\cdot(1 - 0.2) = 0.8\\).15 Viene detta scambiabilità la proprietà per cui l’ordine con cui compiamo le osservazioni è irrilevante per l’assegnazione delle probabilità.↩︎ La derivazione della formula del coefficiente binomiale è fornita nell’Appendice ??.↩︎ L’eguaglianza di \\(\\mu\\) e \\(\\sigma\\) è solo una peculiarità di questo esempio.↩︎ "],["distribuzione-di-poisson.html", "10.3 Distribuzione di Poisson", " 10.3 Distribuzione di Poisson La distribuzione di Poisson è una distribuzione di probabilità discreta che esprime le probabilità per il numero di eventi che si verificano successivamente ed indipendentemente in un dato intervallo di tempo, sapendo che mediamente se ne verifica un numero \\(\\lambda\\). La distribuzione di Poisson serve dunque per contare il numero di volte in cui un evento ha luogo in un determinato intervallo di tempo. La stessa distribuzione può essere estesa anche per contare gli eventi che hanno luogo in una determinata porzione di spazio. Definizione 10.3 La distribuzione di Poisson può essere intesa come limite della distribuzione binomiale, dove la probabilità di successo \\(\\theta\\) è pari a \\(\\frac{\\lambda}{n}\\) con \\(n\\) che tende a \\(\\infty\\): \\[\\begin{equation} \\lim_{y \\rightarrow \\infty} \\binom{n}{y} \\theta^y (1-\\theta)^{n-y} = \\frac{\\lambda^y}{y!}e^{-\\lambda}. \\end{equation}\\] Alcune distribuzioni di Poisson sono riportate nella figura 10.2. FIGURA 10.2: Alcune distribuzioni di Poisson. Esercizio 10.5 Supponiamo che un evento accada 300 volte all’ora e si vuole determinare la probabilità che in un minuto accadano esattamente 3 eventi. Il numero medio di eventi in un minuto è pari a lambda &lt;- 300 / 60 lambda #&gt; [1] 5 Quindi la probabilità che in un minuto si abbiano 3 eventi è pari a y &lt;- 3 (lambda^y / factorial(y)) * exp(-lambda) #&gt; [1] 0.1404 Esercizio 10.6 Per i dati dell’esempio precedente, si trovi la probabilità che un evento accada almeno 8 volte in un minuto. La probabilità cercata è \\[ p(y \\geq 8) = 1 - p (y \\leq 7) = 1- \\sum_{i = 0}^7 \\frac{\\lambda^7}{7!}e^{-\\lambda}, \\] con \\(\\lambda = 5\\). Svolgendo i calcoli in otteniamo: 1 - ppois(q = 7, lambda = 5) #&gt; [1] 0.1334 ppois(q = 7, lambda = 5, lower.tail = FALSE) #&gt; [1] 0.1334 Esercizio 10.7 Sapendo che un evento avviene in media 6 volte al minuto, si calcoli (a) la probabilità di osservare un numero di eventi uguale o inferiore a 3 in un minuto, e (b) la probabilità di osservare esattamente 2 eventi in 30 secondi. In questo caso \\(\\lambda = 6\\) e la probabilità richiesta è ppois(q = 3, lambda = 6, lower.tail = TRUE) #&gt; [1] 0.1512 In questo caso \\(\\lambda = 6 / 2\\) e la probabilità richiesta è dpois(x = 2, lambda = 3) #&gt; [1] 0.224 "],["alcune-proprietà-della-variabile-di-poisson.html", "10.4 Alcune proprietà della variabile di Poisson", " 10.4 Alcune proprietà della variabile di Poisson Il valore atteso, la moda e la varianza della variabile di Poisson sono uguali a \\(\\lambda\\). La somma \\(Y_1 + \\dots + Y_n\\) di \\(n\\) variabili casuali indipendenti con distribuzioni di Poisson di parametri \\(\\lambda_{1},\\dots,\\lambda_{n}\\) segue una distribuzione di Poisson di parametro \\(\\lambda = \\lambda_{1}+\\dots+\\lambda_{n}\\). La differenze di due variabili di Poisson non è una variabile di Poisson. Basti infatti pensare che può assumere valori negativi. "],["considerazioni-conclusive-5.html", "Considerazioni conclusive", " Considerazioni conclusive La distribuzione binomiale è una distribuzione di probabilità discreta che descrive il numero di successi in un processo di Bernoulli, ovvero la variabile aleatoria \\(Y = Y_1 + \\dots + Y_n\\) che somma \\(n\\) variabili casuali indipendenti di uguale distribuzione di Bernoulli \\(\\mathcal{B}(\\theta)\\), ognuna delle quali può fornire due soli risultati: il successo con probabilità \\(\\theta\\) e il fallimento con probabilità \\(1 - \\theta\\). La distribuzione binomiale è molto importante per le sue molte applicazioni. Nelle presenti dispense, dedicate all’analisi bayesiana, è soprattutto importante perché costituisce il fondamento del caso più semplice del cosiddetto “aggiornamento bayesiano”, ovvero il caso Beta-Binomiale. Il modello Beta-Binomiale ci fornirà infatti un esempio paradigmatico dell’approccio bayesiano all’inferenza e sarà trattato in maniera analitica. È dunque importante che le proprietà della distribuzione binomiale risultino ben chiare. "],["distr-rv-cont.html", "Capitolo 11 Distribuzioni di v.c. continue", " Capitolo 11 Distribuzioni di v.c. continue Dopo avere introdotto con una simulazione il concetto di funzione di densità nel Capitolo 8, prendiamo ora in esame alcune delle densità di probabilità più note. La più importante di esse è sicuramente la distribuzione Normale. "],["distribuzione-normale.html", "11.1 Distribuzione Normale", " 11.1 Distribuzione Normale Non c’è un’unica distribuzione Normale, ma ce ne sono molte. Tali distribuzioni sono anche dette “gaussiane” in onore di Carl Friedrich Gauss (uno dei più grandi matematici della storia il quale, tra le altre cose, scoprì l’utilità di tale funzione di densità per descrivere gli errori di misurazione). Adolphe Quetelet, il padre delle scienze sociali quantitative, fu il primo ad applicare tale densità alle misurazioni dell’uomo. Karl Pearson usò per primo il termine “distribuzione Normale” anche se ammise che questa espressione “ha lo svantaggio di indurre le persone a credere che le altre distribuzioni, in un senso o nell’altro, non siano normali.” 11.1.1 Limite delle distribuzioni binomiali Iniziamo con un un breve excursus storico. Nel 1733, Abraham de Moivre notò che, aumentando il numero di prove in una distribuzione binomiale, la distribuzione risultante diventava quasi simmetrica e a forma campanulare. Con 10 prove e una probabilità di successo di 0.9 in ciascuna prova, la distribuzione è chiaramente asimmetrica. N &lt;- 10 x &lt;- 0:10 y &lt;- dbinom(x, N, 0.9) binomial_limit_plot &lt;- tibble(x = x, y = y) %&gt;% ggplot(aes(x = x, y = y)) + geom_bar( stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.2 ) + xlab(&quot;y&quot;) + scale_x_continuous(breaks = c(0, 2, 4, 6, 8, 10)) + ylab(&quot;Binomial(y | 10, 0.9)&quot;) binomial_limit_plot FIGURA 11.1: Probabilità del numero di successi in \\(N = 10\\) prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione \\(\\Bin(y \\mid 10, 0.9)\\). Con solo dieci prove, la distribuzione è fortemente asimmetrica negativa. Ma se aumentiamo il numero di prove di un fattore di 100 a N = 1000, senza modificare la probabilità di successo di 0.9, la distribuzione assume una forma campanulare quasi simmetrica. Dunque, de Moivre scoprì che, quando N è grande, la funzione Normale (che introdurremo qui sotto), nonostante sia la densità di v.a. continue, fornisce una buona approssimazione alla funzione di massa di probabilità binomiale. N &lt;- 1000 x &lt;- 0:1000 y &lt;- dbinom(x, N, 0.9) binomial_limit_plot &lt;- tibble(x = x, y = y) %&gt;% ggplot(aes(x = x, y = y)) + geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.2) + xlab(&quot;y&quot;) + ylab(&quot;Binomial(y | 1000, 0.9)&quot;) + xlim(850, 950) binomial_limit_plot FIGURA 11.2: Probabilità del numero di successi in \\(N = 1000\\) prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione \\(\\Bin(y \\mid 1000, 0.9)\\). Con mille prove, la distribuzione è quasi simmetrica a forma campanulare. La distribuzione Normale fu scoperta da Gauss nel 1809 e, storicamente, è intimamente legata al metodo dei minimi quadrati – si veda l’Appendice ??. Il Paragrafo successivo illustra come si possa giungere alla Normale mediante una simulazione. "],["normal-random-walk.html", "11.2 La Normale prodotta con una simulazione", " 11.2 La Normale prodotta con una simulazione McElreath (2020) presenta un esempio che illustra come sia possibile giungere alla distribuzione Normale mediante una simulazione. Supponiamo che vi siano mille persone tutte allineate su una linea di partenza. Quando viene dato un segnale, ciascuna persona lancia una moneta e fa un passo in avanti oppure all’indietro a seconda che sia uscita testa o croce. Supponiamo che la lunghezza di ciascun passo vari da 0 a 1 metro. Ciascuna persona lancia una moneta 16 volte e dunque compie 16 passi. Alla conclusione di queste passeggiate casuali (random walk) non possiamo sapere con esattezza dove si troverà ciascuna persona, ma possiamo conoscere con certezza le caratteristiche della distribuzione delle mille distanze dall’origine. Per esempio, possiamo predire in maniera accurata la proporzione di persone che si sono spostate in avanti oppure all’indietro. Oppure, possiamo predire accuratamente la proporzione di persone che si troveranno ad una certa distanza dalla linea di partenza (es., a 1.5 m dall’origine). Queste predizioni sono possibili perché tali distanze si distribuiscono secondo la legge Normale. È facile simulare questo processo usando . I risultati della simulazione sono riportati nella figura 11.3. pos &lt;- replicate(100, runif(16, -1, 1)) %&gt;% as_tibble() %&gt;% rbind(0, .) %&gt;% mutate(step = 0:16) %&gt;% gather(key, value, -step) %&gt;% mutate(person = rep(1:100, each = 17)) %&gt;% group_by(person) %&gt;% mutate(position = cumsum(value)) %&gt;% ungroup() ggplot( data = pos, aes(x = step, y = position, group = person) ) + geom_vline(xintercept = c(4, 8, 16), linetype = 2) + geom_line(aes(color = person &lt; 2, alpha = person &lt; 2)) + scale_color_manual(values = c(&quot;gray&quot;, &quot;black&quot;)) + scale_alpha_manual(values = c(1 / 5, 1)) + scale_x_continuous( &quot;Numero di passi&quot;, breaks = c(0, 4, 8, 12, 16) ) + labs(y = &quot;Posizione&quot;) + theme(legend.position = &quot;none&quot;) FIGURA 11.3: Passeggiata casuale di 4, 8 e 16 passi. La spezzata nera indica la media delle distanze dall’origine come funzione del numero di passi. Un kernel density plot delle distanze ottenute dopo 4, 8 e 16 passi è riportato nella figura 11.4. Nel pannello di destra, al kernel density plot è stata sovrapposta una densità Normale di opportuni parametri (linea tratteggiata). p1 &lt;- pos %&gt;% filter(step == 4) %&gt;% ggplot(aes(x = position)) + geom_line(stat = &quot;density&quot;, color = &quot;black&quot;) + labs(title = &quot;4 passi&quot;) p2 &lt;- pos %&gt;% filter(step == 8) %&gt;% ggplot(aes(x = position)) + geom_density(color = &quot;black&quot;, outline.type = &quot;full&quot;) + labs(title = &quot;8 passi&quot;) sd &lt;- pos %&gt;% filter(step == 16) %&gt;% summarise(sd = sd(position)) %&gt;% pull(sd) p3 &lt;- pos %&gt;% filter(step == 16) %&gt;% ggplot(aes(x = position)) + stat_function( fun = dnorm, args = list(mean = 0, sd = sd), linetype = 2 ) + geom_density(color = &quot;black&quot;, alpha = 1 / 2) + labs( title = &quot;16 passi&quot;, y = &quot;Densità&quot; ) (p1 | p2 | p3) &amp; coord_cartesian(xlim = c(-6, 6)) FIGURA 11.4: Kernel density plot dei risultati della passeggiata casuale riportata nella figura precente, dopo 4, 8 e 16 passi. Nel pannello di destra, una densità Normale di opportuni parametri è sovrapposta all’istogramma lisciato. Questa simulazione mostra che qualunque processo nel quale viene sommato un certo numero di valori casuali, tutti provenienti dalla medesima distribuzione, converge ad una distribuzione Normale. Non importa quale sia la forma della distribuzione di partenza: essa può essere uniforme, come nell’esempio presente, o di qualunque altro tipo. La forma della distribuzione da cui viene realizzato il campionamento determina la velocità della convergenza alla Normale. In alcuni casi la convergenza è lenta; in altri casi la convergenza è molto rapida (come nell’esempio presente). Da un punto di vista formale, diciamo che una variabile casuale continua \\(Y\\) ha una distribuzione Normale se la sua densità è \\[\\begin{equation} f(y; \\mu, \\sigma) = {1 \\over {\\sigma\\sqrt{2\\pi} }} \\exp \\left\\{-\\frac{(y - \\mu)^2}{2 \\sigma^2} \\right\\}, \\tag{11.1} \\end{equation}\\] dove \\(\\mu \\in \\mathbb{R}\\) e \\(\\sigma &gt; 0\\) sono i parametri della distribuzione. La densità normale è unimodale e simmetrica con una caratteristica forma a campana e con il punto di massima densità in corrispondenza di \\(\\mu\\). Il significato dei parametri \\(\\mu\\) e \\(\\sigma\\) che appaiono nella (11.1) viene chiarito dalla dimostrazione che \\[\\begin{equation} \\E(X) = \\mu, \\qquad \\Var(X) = \\sigma^2. \\end{equation}\\] La rappresentazione grafica di quattro densità Normali tutte con media 0 e con deviazioni standard 0.25, 0.5, 1 e 2 è fornita nella figura 11.5. FIGURA 11.5: Alcune distribuzioni Normali. 11.2.1 Concentrazione È istruttivo osservare il grado di concentrazione della distribuzione Normale attorno alla media: \\[\\begin{align} P(\\mu - \\sigma &lt; X &lt; \\mu + \\sigma) &amp;= P (-1 &lt; Z &lt; 1) \\simeq 0.683, \\notag\\\\ P(\\mu - 2\\sigma &lt; X &lt; \\mu + 2\\sigma) &amp;= P (-2 &lt; Z &lt; 2) \\simeq 0.956, \\notag\\\\ P(\\mu - 3\\sigma &lt; X &lt; \\mu + 3\\sigma) &amp;= P (-3 &lt; Z &lt; 3) \\simeq 0.997. \\notag \\end{align}\\] Si noti come un dato la cui distanza dalla media è superiore a 3 volte la deviazione standard presenti un carattere di eccezionalità perché meno del 0.3% dei dati della distribuzione Normale presentano questa caratteristica. Per indicare la distribuzione Normale si usa la notazione \\(\\mathcal{N}(\\mu, \\sigma)\\). 11.2.2 Funzione di ripartizione Il valore della funzione di ripartizione di \\(Y\\) nel punto \\(y\\) è l’area sottesa alla curva di densità \\(f(y)\\) nella semiretta \\((-\\infty, y]\\). Non esiste alcuna funzione elementare per la funzione di ripartizione \\[\\begin{equation} F(y) = \\int_{-\\infty}^y {1 \\over {\\sigma\\sqrt{2\\pi} }} \\exp \\left\\{-\\frac{(y - \\mu)^2}{2\\sigma^2} \\right\\} dy, \\end{equation}\\] pertanto le probabilità \\(P(Y &lt; y)\\) vengono calcolate mediante integrazione numerica approssimata. I valori della funzione di ripartizione di una variabile casuale Normale sono dunque forniti da un software. Esercizio 11.1 Usiamo per calcolare la funzione di ripartizione della Normale. La funzione pnorm(q, mean, sd) restituisce la funzione di ripartizione della Normale con media mean e deviazione standard sd, ovvero l’area sottesa alla funzione di densità di una Normale con media mean e deviazione standard sd nell’intervallo \\([-\\infty, q]\\). Per esempio, in precedenza abbiamo detto che il 68% circa dell’area sottesa ad una Normale è compresa nell’intervallo \\(\\mu \\pm \\sigma\\). Verifichiamo per la distribuzione del QI \\(\\sim \\mathcal{N}(\\mu = 100, \\sigma = 15)\\): pnorm(100+15, 100, 15) - pnorm(100-15, 100, 15) #&gt; [1] 0.6827 Il 95% dell’area è compresa nell’intervallo \\(\\mu \\pm 1.96 \\cdot\\sigma\\): pnorm(100 + 1.96 * 15, 100, 15) - pnorm(100 - 1.96 * 15, 100, 15) #&gt; [1] 0.95 Quasi tutta la distribuzione è compresa nell’intervallo \\(\\mu \\pm 3 \\cdot\\sigma\\): pnorm(100 + 3 * 15, 100, 15) - pnorm(100 - 3 * 15, 100, 15) #&gt; [1] 0.9973 11.2.3 Distribuzione Normale standard La distribuzione Normale di parametri \\(\\mu = 0\\) e \\(\\sigma = 1\\) viene detta distribuzione Normale standard. La famiglia Normale è l’insieme avente come elementi tutte le distribuzioni Normali con parametri \\(\\mu\\) e \\(\\sigma\\) diversi. Tutte le distribuzioni Normali si ottengono dalla Normale standard mediante una trasformazione lineare: se \\(Y \\sim \\mathcal{N}(\\mu_Y, \\sigma_Y)\\) allora \\[\\begin{equation} X = a + b Y \\sim \\mathcal{N}(\\mu_X = a+b \\mu_Y, \\sigma_X = \\left|b\\right|\\sigma_Y). \\end{equation}\\] L’area sottesa alla curva di densità di \\(\\mathcal{N}(\\mu, \\sigma)\\) nella semiretta \\((-\\infty, y]\\) è uguale all’area sottesa alla densità Normale standard nella semiretta \\((-\\infty, z]\\), in cui \\(z = (y -\\mu_Y )/\\sigma_Y\\) è il punteggio standard di \\(Y\\). Per la simmetria della distribuzione, l’area sottesa nella semiretta \\([1, \\infty)\\) è uguale all’area sottesa nella semiretta \\((-\\infty, 1]\\) e quest’ultima coincide con \\(F(-1)\\). Analogamente, l’area sottesa nell’intervallo \\([y_a, y_b]\\), con \\(y_a &lt; y_b\\), è pari a \\(F(z_b) - F(z_a)\\), dove \\(z_a\\) e \\(z_b\\) sono i punteggi standard di \\(y_a\\) e \\(y_b\\). Si ha anche il problema inverso rispetto a quello del calcolo delle aree: dato un numero \\(0 \\leq p \\leq 1\\), il problema è quello di determinare un numero \\(z \\in \\mathbb{R}\\) tale che \\(P(Z &lt; z) = p\\). Il valore \\(z\\) cercato è detto quantile di ordine \\(p\\) della Normale standard e può essere trovato mediante un software. Esercizio 11.2 Supponiamo che l’altezza degli individui adulti segua la distribuzione Normale di media \\(\\mu = 1.7\\) m e deviazione standard \\(\\sigma = 0.1\\) m. Vogliamo sapere la proporzione di individui adulti con un’altezza compresa tra \\(1.7\\) e \\(1.8\\) m. Il problema ci chiede di trovare l’area sottesa alla distribuzione \\(\\mathcal{N}(\\mu = 1.7, \\sigma = 0.1)\\) nell’intervallo \\([1.7, 1.8]\\): df &lt;- tibble(x = seq(1.4, 2.0, length.out = 100)) %&gt;% mutate(y = dnorm(x, mean = 1.7, sd = 0.1)) ggplot(df, aes(x, y)) + geom_area(fill = &quot;sky blue&quot;) + gghighlight(x &lt; 1.8 &amp; x &gt; 1.7) + labs( x = &quot;Altezza&quot;, y = &quot;Densità&quot; ) La risposta si trova utilizzando la funzione di ripartizione \\(F(X)\\) della legge \\(\\mathcal{N}(1.7, 0.1)\\) in corrispondenza dei due valori forniti dal problema: \\(F(X = 1.8) - F(X = 1.7)\\). Utilizzando la seguente istruzione pnorm(1.8, 1.7, 0.1) - pnorm(1.7, 1.7, 0.1) #&gt; [1] 0.3413 otteniamo il \\(31.43\\%\\). In maniera equivalente, possiamo standardizzare i valori che delimitano l’intervallo considerato e utilizzare la funzione di ripartizione della normale standardizzata. I limiti inferiore e superiore dell’intervallo sono \\[ z_{\\text{inf}} = \\frac{1.7 - 1.7}{0.1} = 0, \\quad z_{\\text{sup}} = \\frac{1.8 - 1.7}{0.1} = 1.0, \\] quindi otteniamo pnorm(1.0, 0, 1) - pnorm(0, 0, 1) #&gt; [1] 0.3413 Il modo più semplice per risolvere questo problema resta comunque quello di rendersi conto che la probabilità richiesta non è altro che la metà dell’area sottesa dalle distribuzioni Normali nell’intervallo \\([\\mu - \\sigma, \\mu + \\sigma]\\), ovvero \\(0.683/2\\). 11.2.3.1 Funzione di ripartizione della normale standard e funzione logistica Si noti che la funzione logistica (in blu), pur essendo del tutto diversa dalla Normale dal punto di vista formale, assomiglia molto alla Normale standard quando le due cdf hanno la stessa varianza. tibble(x = c(-3, 3)) %&gt;% ggplot(aes(x = x)) + stat_function(fun = pnorm) + stat_function( fun = plogis, args = list(scale = 0.56) ) References "],["teorema-del-limite-centrale.html", "11.3 Teorema del limite centrale", " 11.3 Teorema del limite centrale Laplace dimostrò il teorema del limite centrale (TLC) nel 1812. Il TLC ci dice che se prendiamo una sequenza di variabili casuali indipendenti e le sommiamo, tale somma tende a distribuirisi come una Normale. Il TLC specifica inoltre, sulla base dei valori attesi e delle varianze delle v.c. che vengono sommate, quali saranno i parametri della distribuzione Normale così ottenuta. Teorema 11.1 Si supponga che \\(Y = Y_1, Y_2, \\ldots, Y_N\\) sia una sequenza di v.a. i.i.d. con \\(\\E(Y_n) = \\mu\\) e \\(\\SD(Y_n) = \\sigma\\). Si definisca una nuova v.c. come la media di \\(Y\\): \\[ Z = \\frac{1}{N} \\sum_{n=1}^N Y_n. \\] Con \\(N \\rightarrow \\infty\\), \\(Z\\) tenderà ad una Normale con lo stesso valore atteso di \\(Y_n\\) e una deviazione standard che sarà più piccola della deviazione standard originaria di un fattore pari a \\(\\sqrt{\\frac{1}{\\sqrt{N}}}\\): \\[\\begin{equation} p_Z(z) \\rightarrow \\mathcal{N}\\left(z \\ \\Bigg| \\ \\mu, \\, \\frac{1}{\\sqrt{N}} \\cdot \\sigma \\right). \\end{equation}\\] Il TLC può essere generalizzato a variabili che non hanno la stessa distribuzione purché siano indipendenti e abbiano aspettative e varianze finite. Molti fenomeni naturali, come l’altezza dell’uomo adulto di entrambi i sessi, sono il risultato di una serie di effetti additivi relativamente piccoli, la cui combinazione porta alla normalità, indipendentemente da come gli effetti additivi sono distribuiti. In pratica, questo è il motivo per cui la distribuzione normale ha senso come rappresentazione di molti fenomeni naturali. "],["distribuzione-chi-quadrato.html", "11.4 Distribuzione Chi-quadrato", " 11.4 Distribuzione Chi-quadrato Dalla Normale deriva la distribuzione \\(\\chi^2\\). La distribuzione \\(\\chi^2_{~k}\\) con \\(k\\) gradi di libertà descrive la variabile casuale \\[ Z_1^2 + Z_2^2 + \\dots + Z_k^2, \\] dove \\(Z_1, Z_2, \\dots, Z_k\\) sono variabili casuali i.i.d. con distribuzione Normale standard \\(\\mathcal{N}(0, 1)\\). La variabile casuale chi-quadrato dipende dal parametro intero positivo \\(\\nu = k\\) che ne identifica il numero di gradi di libertà. La densità di probabilità di \\(\\chi^2_{~\\nu}\\) è \\[ f(x) = C_{\\nu} x^{\\nu/2-1} \\exp (-x/2), \\qquad \\text{se } x &gt; 0, \\] dove \\(C_{\\nu}\\) è una costante positiva. La figura 11.6 mostra alcune distribuzioni Chi-quadrato variando il parametro \\(\\nu\\). FIGURA 11.6: Alcune distribuzioni Chi-quadrato. 11.4.1 Proprietà La distribuzione di densità \\(\\chi^2_{~\\nu}\\) è asimmetrica. Il valore atteso di una variabile \\(\\chi^2_{~\\nu}\\) è uguale a \\(\\nu\\). La varianza di una variabile \\(\\chi^2_{~\\nu}\\) è uguale a \\(2\\nu\\). Per \\(k \\rightarrow \\infty\\), la \\(\\chi^2_{~\\nu} \\rightarrow \\mathcal{N}\\). Se \\(X\\) e \\(Y\\) sono due variabili casuali chi-quadrato indipendenti con \\(\\nu_1\\) e \\(\\nu_2\\) gradi di libertà, ne segue che \\(X + Y \\sim \\chi^2_m\\), con \\(m = \\nu_1 + \\nu_2\\). Tale principio si estende a qualunque numero finito di variabili casuali chi-quadrato indipendenti. Esercizio 11.3 Usiamo \\(\\R\\) per disegnare la densità chi-quadrato con 3 gradi di libertà dividendo l’area sottesa alla curva di densità in due parti uguali. df &lt;- tibble(x = seq(0, 15.0, length.out = 100)) %&gt;% mutate(y = dchisq(x, 3)) ggplot(df, aes(x, y)) + geom_area(fill = &quot;sky blue&quot;) + gghighlight(x &lt; 3) + labs( x = &quot;V.a. chi-quadrato con 3 gradi di libertà&quot;, y = &quot;Densità&quot; ) "],["distribuzione-t-di-student.html", "11.5 Distribuzione \\(t\\) di Student", " 11.5 Distribuzione \\(t\\) di Student Dalle distribuzioni Normale e Chi quadrato deriva un’altra distribuzione molto nota, la \\(t\\) di Student. Se \\(Z \\sim \\mathcal{N}\\) e \\(W \\sim \\chi^2_{~\\nu}\\) sono due variabili casuali indipendenti, allora il rapporto \\[\\begin{equation} T = \\frac{Z}{\\Big( \\frac{W}{\\nu}\\Big)^{\\frac{1}{2}}} \\end{equation}\\] definisce la distribuzione \\(t\\) di Student con \\(\\nu\\) gradi di libertà. Si usa scrivere \\(T \\sim t_{\\nu}\\). L’andamento della distribuzione \\(t\\) di Student è simile a quello della distribuzione Normale, ma ha una maggiore dispersione (ha le code più pesanti di una Normale, ovvero ha una varianza maggiore di 1). La figura 11.7 mostra alcune distribuzioni \\(t\\) di Student variando il parametro \\(\\nu\\). FIGURA 11.7: Alcune distribuzioni \\(t\\) di Student. 11.5.1 Proprietà La variabile casuale \\(t\\) di Student soddisfa le seguenti proprietà: Per \\(\\nu \\rightarrow \\infty\\), \\(t_{\\nu}\\) tende alla normale standard \\(\\mathcal{N}(0, 1)\\). La densità della \\(t_{\\nu}\\) è una funzione simmetrica con valore atteso nullo. Per \\(\\nu &gt; 2\\), la varianza della \\(t_{\\nu}\\) vale \\(\\nu/(\\nu - 2)\\); pertanto è sempre maggiore di 1 e tende a 1 per \\(\\nu \\rightarrow \\infty\\). "],["funzione-beta-di-eulero.html", "11.6 Funzione beta di Eulero", " 11.6 Funzione beta di Eulero La funzione beta di Eulero è una funzione matematica, non una densità di probabilità. La menzioniamo qui perché viene utilizzata nella distribuzione Beta. La funzione beta si può scrivere in molti modi diversi; per i nostri scopi la scriveremo così: \\[\\begin{equation} B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha + \\beta)}\\,, \\end{equation}\\] dove \\(\\Gamma(x)\\) è la funzione Gamma, ovvero il fattoriale discendente, cioè \\[\\begin{equation} x(x-1)(x-2)\\ldots (x-n+1)\\notag\\,. \\end{equation}\\] "],["distribuzione-beta.html", "11.7 Distribuzione Beta", " 11.7 Distribuzione Beta Una distribuzione che viene usata per modellare percentuali e proporzioni è la distribuzione Beta in quanto è definita sull’intervallo \\((0; 1)\\) – ma non include i valori 0 o 1. La distribuzione Beta è una distribuzione estremamente flessibile e può assumere molti tipi di forme diverse (un’illustrazione è fornita dalla seguente GIF animata). Una definizione formale è la seguente. Definizione 11.1 Sia \\(\\pi\\) una variabile casuale che può assumere qualsiasi valore compreso tra 0 e 1, cioè \\(\\pi \\in [0, 1]\\). Diremo che \\(\\pi\\) segue la distribuzione Beta di parametri \\(\\alpha\\) e \\(\\beta\\), \\(\\pi \\sim \\text{Beta}(\\alpha, \\beta)\\), se la sua densità è \\[\\begin{align} \\text{Beta}(\\pi \\mid \\alpha, \\beta) &amp;= \\frac{1}{B(\\alpha, \\beta)}\\pi^{\\alpha-1} (1-\\pi)^{\\beta-1}\\notag\\\\ &amp;= \\frac{\\Gamma(\\alpha+ \\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\pi^{\\alpha-1} (1-\\pi)^{\\beta-1} \\quad \\text{per } \\pi \\in [0, 1]\\,, \\tag{11.2} \\end{align}\\] laddove \\(B(\\alpha, \\beta)\\) è la funzione beta. I termini \\(\\alpha\\) e \\(\\beta\\) sono i parametri della distribuzione Beta e devono essere entrambi positivi. Tali parametri possono essere interpretati come l’espressione delle nostre credenze a priori relative ad una sequenza di prove Bernoulliane Il parametro \\(\\alpha\\) rappresenta il numero di “successi” e il parametro \\(\\beta\\) il numero di “insuccessi”: \\[\\begin{equation} \\frac{\\text{Numero di successi}}{\\text{Numero di successi} + \\text{Numero di insuccessi}} = \\frac{\\alpha}{\\alpha + \\beta}\\notag\\,. \\end{equation}\\] Il rapporto \\(\\frac{1}{B(\\alpha, \\beta)} = \\frac{\\Gamma(\\alpha+b)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\) è una costante di normalizzazione: \\[\\begin{equation} \\int_0^1 \\pi^{\\alpha-1} (1-\\pi)^{\\beta-1} = \\frac{\\Gamma(\\alpha+b)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\,. \\end{equation}\\] Il valore atteso, la moda e la varianza di una distribuzione Beta sono dati dalle seguenti equazioni: \\[\\begin{equation} \\E(\\pi) = \\frac{\\alpha}{\\alpha+\\beta}\\,, \\tag{11.3} \\end{equation}\\] \\[\\begin{equation} \\Mo(\\pi) = \\frac{\\alpha-1}{\\alpha+\\beta-2}\\,, \\tag{11.4} \\end{equation}\\] \\[\\begin{equation} \\Var(\\pi) = \\frac{\\alpha \\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}\\,. \\tag{11.5} \\end{equation}\\] Remark. Attenzione alle parole: in questo contesto, il termine “beta” viene utilizzato con tre significati diversi: la distribuzione di densità Beta, la funzione matematica beta, il parametro \\(\\beta\\). Al variare di \\(\\alpha\\) e \\(\\beta\\) si ottengono molte distribuzioni di forma diversa; per \\(\\alpha = \\beta = 1\\) si ha la densità uniforme. Vari esempi di distribuzioni Beta sono mostrati nella figura 11.8. FIGURA 11.8: Alcune distribuzioni Beta. Si può ottenere una rappresentazione grafica della distribuzione \\(\\mbox{Beta}(\\pi \\mid \\alpha, \\beta)\\) con la funzione plot_beta() del pacchetto bayesrules. Per esempio: bayesrules::plot_beta(alpha = 2, beta = 12) La funzione bayesrules::summarize_beta() ci restituisce la media, moda e varianza della distribuzione Beta. Per esempio: bayesrules::summarize_beta(alpha = 2, beta = 12) #&gt; mean mode var sd #&gt; 1 0.1429 0.08333 0.008163 0.09035 Esercizio 11.4 Nel disturbo depressivo la recidiva è definita come la comparsa di un nuovo episodio depressivo che si manifesta dopo un prolungato periodo di recupero (6-12 mesi) con stato di eutimia (umore relativamente normale). Supponiamo che una serie di studi mostri una comparsa di recidiva in una proporzione che va dal 20% al 60% dei casi, con una media del 40% (per una recente discussione, si veda Nuggerud-Galeas et al. 2020). Sulla base di queste ipotetiche informazioni, è possibile usare la distribuzione Beta per rappresentare le nostre credenze a priori relativamente alla probabilità di recidiva. Per fare questo dobbiamo trovare i parametri della distribuzione Beta tali per cui la massa della densità sia compresa tra 0.2 e 0.6, con la media in corrispondenza di 0.4. Procedendo per tentativi ed errori, ed usando la funzione bayesrules::plot_beta(), un risultato possibile è \\(\\Beta(16, 24)\\). find_pars &lt;- function(ev, n) { a &lt;- ev * n b &lt;- n - a return(c(round(a), round(b))) } pars &lt;- find_pars(.4, 40) pars #&gt; [1] 16 24 bayesrules::plot_beta(pars[1], pars[2]) La media della distribuzione a priori diventa: 16 / (16 + 24) #&gt; [1] 0.4 e la moda è (16 - 1) / (16 + 24 - 2) #&gt; [1] 0.3947 Inoltre, la deviazione standard della distribuzione a priori diventa sqrt((16 * 24) / ((16 + 24)^2 * (16 + 24 + 1))) #&gt; [1] 0.07651 uguale a circa 8 punti percentuali. Verifichiamo: bayesrules::summarize_beta(alpha = 16, beta = 24) #&gt; mean mode var sd #&gt; 1 0.4 0.3947 0.005854 0.07651 Questo significa che le nostre credenze a priori rispetto la possibilità di recidiva tendono a deviare di circa 8 punti percentuali rispetto alla media della distribuzione a priori che corrisponde circa a 0.40. References "],["distribuzione-di-cauchy.html", "11.8 Distribuzione di Cauchy", " 11.8 Distribuzione di Cauchy La distribuzione di Cauchy è un caso speciale della distribuzione di \\(t\\) di Student con 1 grado di libertà. È definita da una densità di probabilità che corrisponde alla funzione, dipendente da due parametri \\(\\theta\\) e \\(d\\) (con la condizione \\(d &gt; 0\\)), \\[\\begin{equation} f(x; \\theta, d) = \\frac{1}{\\pi d} \\frac{1}{1 + \\left(\\frac{x - \\theta}{d} \\right)^2}, \\end{equation}\\] dove \\(\\theta\\) è la mediana della distribuzione e \\(d\\) ne misura la larghezza a metà altezza. "],["distribuzione-log-normale.html", "11.9 Distribuzione log-normale", " 11.9 Distribuzione log-normale Sia \\(y\\) una variabile casuale avente distribuzione normale con media \\(\\mu\\) e varianza \\(\\sigma^2\\). Definiamo poi una nuova variabile casuale \\(x\\) attraverso la relazione \\[ x = e^y \\quad \\Longleftrightarrow \\quad y = \\log x. \\] Il dominio di definizione della \\(x\\) è il semiasse \\(x &gt; 0\\) e la densità di probabilità \\(f(x)\\) è data da \\[\\begin{equation} f(x) = \\frac{1}{\\sigma \\sqrt{2 \\pi}} \\frac{1}{x} \\exp \\left\\{-\\frac{(\\log x - \\mu)^2}{2 \\sigma^2} \\right\\}. \\end{equation}\\] Questa funzione di densità si chiama log-normale. Il valore atteso e la varianza di una distribuzione log-normale sono dati dalle seguenti equazioni: \\[\\begin{equation} \\E(x) = \\exp \\left\\{\\mu + \\frac{\\sigma^2}{2} \\right\\}. \\end{equation}\\] \\[\\begin{equation} \\Var(x) = \\exp \\left\\{2 \\mu + \\sigma^2 \\right\\} \\left(\\exp \\left\\{\\sigma^2 \\right\\} -1\\right). \\end{equation}\\] Si può dimostrare che il prodotto di variabili casuali log-normali ed indipendenti segue una distribuzione log-normale. "],["distribuzione-di-pareto.html", "11.10 Distribuzione di Pareto", " 11.10 Distribuzione di Pareto La distribuzione paretiana (o distribuzione di Pareto) è una distribuzione di probabilità continua e così chiamata in onore di Vilfredo Pareto. La distribuzione di Pareto è una distribuzione di probabilità con legge di potenza utilizzata nella descrizione di fenomeni sociali e molti altri tipi di fenomeni osservabili. Originariamente applicata per descrivere la distribuzione del reddito in una società, adattandosi alla tendenza che una grande porzione di ricchezza è detenuta da una piccola frazione della popolazione, la distribuzione di Pareto è diventata colloquialmente nota e indicata come il principio di Pareto, o “regola 80-20”. Questa regola afferma che, ad esempio, l’80% della ricchezza di una società è detenuto dal 20% della sua popolazione. Viene spesso applicata nello studio della distribuzione del reddito, della dimensione dell’impresa, della dimensione di una popolazione e nelle fluttuazioni del prezzo delle azioni. La densità di una distribuzione di Pareto è \\[ f(x)=(x_m/x)^\\alpha, \\] dove \\(x_m\\) (parametro di scala) è il minimo (necessariamente positivo) valore possibile di \\(X\\) e \\(\\alpha\\) è un parametro di forma. La distribuzione di Pareto ha una asimmetria positiva. Il supporto della distribuzione di Pareto è la retta reale positiva. Tutti i valori devono essere maggiori del parametro di scala \\(x_m\\), che è in realtà un parametro di soglia. "],["ch:intro-bayes-inference.html", "Capitolo 12 Inferenza bayesiana", " Capitolo 12 Inferenza bayesiana La moderna statistica bayesiana viene per lo più eseguita utilizzando un linguaggio di programmazione probabilistico implementato su computer. Ciò ha cambiato radicalmente il modo in cui venivano eseguite le statistiche bayesiane anche fin pochi decenni fa. La complessità dei modelli che possiamo costruire è aumentata e la barriera delle competenze matematiche e computazionali che sono richieste è diminuita. Inoltre, il processo di modellazione iterativa è diventato, sotto molti aspetti, molto più facile da eseguire. Anche se formulare modelli statistici complessi è diventato più facile che mai, la statistica è un campo pieno di sottigliezze che non scompaiono magicamente utilizzando potenti metodi computazionali. Pertanto, avere una buona preparazione sugli aspetti teorici, specialmente quelli rilevanti nella pratica, è estremamente utile per applicare efficacemente i metodi statistici. "],["modellizzazione-bayesiana.html", "12.1 Modellizzazione bayesiana", " 12.1 Modellizzazione bayesiana Seguendo (Martin, Kumar, and Lao 2022), possiamo descrivere il processo della modellazione bayesiana distinguendo 3 passaggi. Dati alcuni dati e alcune ipotesi su come questi dati potrebbero essere stati generati, progettiamo un modello combinando e trasformando variabili casuali. Usiamo il teorema di Bayes per condizionare i nostri modelli ai dati disponibili. Chiamiamo questo processo “inferenza” e come risultato otteniamo una distribuzione a posteriori. Ci auguriamo che i dati riducano l’incertezza per i possibili valori dei parametri, sebbene questo non sia garantito per nessun modello bayesiano. Critichiamo il modello verificando se il modello abbia senso utilizzando criteri diversi, inclusi i dati e la nostra conoscenza del dominio. Poiché generalmente siamo incerti sui modelli stessi, a volte confrontiamo diversi modelli. Questi 3 passaggi vengono eseguiti in modo iterativo e danno luogo a quello che si chiama un “flusso di lavoro bayesiano” (bayesian workflow). Remark. Un modello è uno strumento concettuale che viene utilizzato per risolvere uno specifico problema. In quanto tale, è generalmente più conveniente parlare dell’adeguatezza del modello a un dato problema che di determinare la sua intrinseca correttezza. I modelli esistono esclusivamente come l’ausilio per il raggiungimento di un qualche ulteriore obiettivo. Il problema che i modelli bayesiani cercano di risolvere è quello dell’inferenza16. I modelli bayesiani, computazionali o meno, hanno due caratteristiche distintive: Le quantità incognite sono descritte utilizzando le distribuzioni di probabilità. Queste quantità incognite sono chiatame parametri. Il teorema di Bayes viene utilizzato per aggiornare i valori dei parametri condizionati ai dati. Possiamo anche concepire questo processo come una riallocazione delle probabilità. References "],["inferenza-bayesiana-come-un-problema-inverso.html", "12.2 Inferenza bayesiana come un problema inverso", " 12.2 Inferenza bayesiana come un problema inverso In questo capitolo ci focalizzeremo sul passaggio 2 descritto sopra. Nello specifico, descrivemo in dettaglio il significato dei tre i termini a destra del segno di uguale nella formula di Bayes: la distribuzione a priori e la funzione di verosimiglianza al numeratore, e la verosimiglianza marginale al denominatore. 12.2.1 Notazione Per fissare la notazione, nel seguito \\(y\\) rappresenterà i dati e \\(\\theta\\) rappresenterà i parametri incogniti di un modello statistico. Sia \\(y\\) che \\(\\theta\\) saranno concepiti come delle variabili casuali.17 Con \\(x\\) verranno invece denotate le quantità note, come ad esempio i predittori del modello lineare. Per rappresentare in un modo conciso i modelli probabilistici viene usata una notazione particolare. Ad esempio, invece di scrivere \\(p(\\theta) = \\mbox{Beta}(1, 1)\\) scriviamo \\(\\theta \\sim \\mbox{Beta}(1, 1)\\). Il simbolo “\\(\\sim\\)” viene spesso letto “è distribuito come”. Possiamo anche pensare che significhi che \\(\\theta\\) costituisce un campione casuale estratto dalla distribuzione Beta(1, 1). Allo stesso modo, ad esempio, la verosimiglianza del modello binomiale può essere scritta come \\(y \\sim \\text{Bin}(n, \\theta)\\). 12.2.2 Funzioni di probabilità Una caratteristica attraente della statistica bayesiana è che la nostra credenza “a posteriori” viene sempre descritta mediante una distribuzione. Questo fatto ci consente di fare affermazioni probabilistiche sui parametri, come ad esempio: “la probabilità che un parametro sia positivo è 0.35”; oppure, “il valore più probabile di \\(\\theta\\) è 12 e abbiamo probabilità del 50% che \\(\\theta\\) sia compreso tra 10 e 15”. Inoltre, possiamo pensare alla distribuzione a posteriori come alla logica conseguenza della combinazione di un modello con i dati; quindi, abbiamo la garanzia che le affermazioni probabilistiche associate alla distribuzione a posteriori siano matematicamente coerenti. Dobbiamo solo ricordare che tutte queste belle proprietà matematiche sono valide solo nel mondo platonico delle idee dove esistono oggetti matematici come sfere, distribuzioni gaussiane e catene di Markov. Quando passiamo dalla purezza della matematica al disordine della matematica applicata al mondo reale, dobbiamo sempre tenere a mente che i nostri risultati sono condizionati, non solo dai dati, ma anche dai modelli. Di conseguenza, dati errati e/o modelli errati conducono facilmente a conclusioni prive di senso, anche se matematicamente coerenti. È dunque necessario conservare sempre una sana quota di scetticismo relativamente ai nostri dati, modelli e risultati (Martin, Kumar, and Lao 2022). Avendo detto questo, nell’aggiornamento bayesiano (dai dati ai parametri) vengono utilizzate le seguenti distribuzioni di probabilità (o di massa di probabilità): la distribuzione a priori \\(p(\\theta)\\) — la credenza iniziale (prima di avere osservato i dati \\(Y = y\\)) riguardo a \\(\\theta\\); la funzione di verosimiglianza \\(p(y \\mid \\theta)\\) — quanto sono compatibili i dati osservati \\(Y = y\\) con i diversi valori possibili di \\(\\theta\\)? la verosimiglianza marginale \\(p(y)\\) — costante di normalizzazione: qual è la probabilità complessiva di osservare i dati \\(Y = y\\)? In termini formali: \\[ p(y) = \\int_\\theta p(y, \\theta) \\,\\operatorname {d}\\!\\theta = \\int_\\theta p(y \\mid \\theta) p(\\theta) \\,\\operatorname {d}\\!\\theta. \\] la distribuzione a posteriori \\(p(\\theta \\mid y)\\) — la nuova credenza relativa alla credibilità di ciascun valore \\(\\theta\\) dopo avere osservato i dati \\(Y = y\\). References "],["la-regola-di-bayes-1.html", "12.3 La regola di Bayes", " 12.3 La regola di Bayes Assumendo un modello statistico, la formula di Bayes consente di giungere alla distribuzione a posteriori \\(p(\\theta \\mid y)\\) per il parametro di interesse \\(\\theta\\), come indicato dalla seguente catena di equazioni18: \\[\\begin{align} p(\\theta \\mid y) &amp;= \\displaystyle \\frac{p(\\theta,y)}{p(y)} \\ \\ \\ \\ \\ \\mbox{ [def. prob. condizionata]} \\\\ &amp;= \\displaystyle \\frac{p(y \\mid \\theta) \\, p(\\theta)}{p(y)} \\ \\ \\ \\ \\ \\mbox{ [legge prob. composta]} \\\\ &amp;= \\displaystyle \\frac{p(y \\mid\\theta) \\, p(\\theta)} {\\int_{\\Theta} p(y,\\theta) \\, \\,\\operatorname {d}\\!\\theta} \\ \\ \\ \\ \\ \\mbox{ [legge prob. totale]} \\\\ &amp;= \\displaystyle \\frac{p(y \\mid\\theta) \\, p(\\theta)} {\\int_{\\Theta} p(y \\mid\\theta) \\, p(\\theta) \\, \\,\\operatorname {d}\\!\\theta} \\ \\ \\ \\ \\ \\mbox{ [legge prob. composta]} \\\\ &amp; \\propto \\displaystyle p(y \\mid\\theta) \\, p(\\theta) \\tag{12.1} \\end{align}\\] La regola di Bayes “inverte” la probabilità della distribuzione a posteriori \\(p(\\theta \\mid y)\\), esprimendola nei termini della funzione di verosimiglianza \\(p(y \\mid \\theta)\\) e della distribuzione a priori \\(p(\\theta)\\). L’ultimo passo è importante per la stima della distribuzione a posteriori mediante i metodi Monte Carlo a catena di Markov, in quanto per questi metodi richiedono soltanto che le funzioni di probabilità siano definite a meno di una costante di proporzionalità. In altri termini, per la maggior parte degli scopi dell’inferenza inversa, è sufficiente calcolare la densità a posteriori non normalizzata, ovvero è possibile ignorare il denominatore bayesiano \\(p(y)\\). La distribuzione a posteriori non normalizzata, dunque, si riduce al prodotto della varosimiglianza e della distribuzione a priori. Possiamo dire che la regola di Bayes viene usata per aggiornare le credenze a priori su \\(\\theta\\) (ovvero, la distribuzione a priori) in modo tale da produrre le nuove credenze a posteriori \\(p(\\theta \\mid y)\\) che combinano le informazioni fornite dai dati \\(y\\) con le credenze precedenti. La distribuzione a posteriori riflette dunque l’aggiornamento delle credenze del ricercatore alla luce dei dati. La distribuzione a posteriori \\(p(\\theta \\mid y)\\) contiene tutta l’informazione riguardante il parametro \\(\\theta\\) e viene utilizzata per produrre indicatori sintetici, per la determinazione di stime puntuali o intervallari, e per la verifica d’ipotesi. La (12.1) rende evidente che, in ottica bayesiana, la quantità di interesse \\(\\theta\\) non è fissata (come nell’impostazione frequentista), ma è una variabile casuale la cui distribuzione di probabilità è influenzata sia dalle informazioni a priori sia dai dati a disposizione. In altre parole, nell’approccio bayesiano non esiste un valore vero di \\(\\theta\\), ma invece lo scopo è quello di fornire invece un giudizio di probabilità (o di formulare una “previsione”, nel linguaggio di de Finetti). Prima delle osservazioni, sulla base delle nostre conoscenze assegnamo a \\(\\theta\\) una distribuzione a priori di probabilità. Dopo le osservazioni, correggiamo il nostro giudizio e assegniamo a \\(\\theta\\) una distribuzione a posteriori di probabilità. 12.3.1 Un esempio di aggiornamento bayesiano Per descrivere l’aggiornamento bayesiano, in questo Capitolo (così come nei successivi) considereremo i dati di Zetsche, Bürkner, and Renneberg (2019). Questi ricercatori si sono chiesti se gli individui depressi manifestino delle aspettative accurate circa il loro umore futuro, oppure se tali aspettative siano distorte negativamente. Esamineremo qui i 30 partecipanti dello studio di Zetsche, Bürkner, and Renneberg (2019) che hanno riportato la presenza di un episodio di depressione maggiore in atto. All’inizio della settimana di test, a questi pazienti è stato chiesto di valutare l’umore che si aspettavano di esperire nei giorni seguenti della settimana. Mediante una app, i partecipanti dovevano poi valutare il proprio umore in cinque momenti diversi di ciascuno dei cinque giorni successivi. Lo studio considera diverse emozioni, ma qui ci concentriamo solo sulla tristezza. Sulla base dei dati forniti dagli autori, abbiamo calcolato la media dei giudizi relativi al livello di tristezza raccolti da ciascun partecipante tramite la app. Tale media è stata poi sottratta dall’aspettativa del livello di tristezza fornita all’inizio della settimana. La discrepanza tra aspettative e realtà è stata considerata come un evento dicotomico: valori positivi di tale differenza indicano che le aspettative circa il livello di tristezza erano maggiori del livello di tristezza effettivamente esperito — ciò significa che le aspettative future risultano negativamente distorte (evento codificato con “1”). Viceversa, si ha che le aspettative risultano positivamente distorte se la differenza descritta in precedenza assume un valore negativo (evento codificato con “0”). Nel campione dei 30 partecipanti clinici di Zetsche, Bürkner, and Renneberg (2019), le aspettative future di 23 partecipanti risultano distorte negativamente e quelle di 7 partecipanti risultano distorte positivamente. Chiameremo \\(\\theta\\) la probabilità dell’evento “le aspettative del partecipante sono distorte negativamente”. Ci poniamo il problema di ottenere una stima a posteriori di \\(\\theta\\) avendo osservato 23 “successi” in 30 prove.19 References "],["modello-probabilistico.html", "12.4 Modello probabilistico", " 12.4 Modello probabilistico Nel caso dello studio di Zetsche, Bürkner, and Renneberg (2019), i dati qui considerati possono essere considerati la manifestazione di una variabile casuale Bernoulliana – 23 “successi” in 30 prove. Se i dati rappresentano una proporzione, allora possiamo adottare un modello probabilistico binomiale quale meccanismo generatore dei dati: \\[\\begin{equation} y \\sim \\mbox{Bin}(n, \\theta), \\tag{12.2} \\end{equation}\\] laddove \\(\\theta\\) è la probabiltà che una prova Bernoulliana assuma il valore 1 e \\(n\\) corrisponde al numero di prove Bernoulliane. Questo modello assume che le prove Bernoulliane \\(y_i\\) che costituiscono il campione \\(y\\) siano tra loro indipendenti e che ciascuna abbia la stessa probabilità \\(\\theta \\in [0, 1]\\) di essere un “successo” (valore 1). In altre parole, il modello generatore dei dati avrà una funzione di massa di probabilità \\[ p(y \\mid \\theta) \\ = \\ \\mbox{Bin}(y \\mid n, \\theta). \\] Nei capitoli precedenti è stato mostrato come, sulla base del modello binomiale, sia possibile assegnare una probabilità a ciascun possibile valore \\(y \\in \\{0, 1, \\dots, n\\}\\) assumendo noto il valore del parametro \\(\\theta\\). Ma ora abbiamo il problema inverso, ovvero quello di fare inferenza su \\(\\theta\\) alla luce dei dati campionari \\(y\\). In altre parole, riteniamo di conoscere il modello probabilistico che ha generato i dati, ma di tale modello non conosciamo i parametri: vogliamo dunque ottenere informazioni su \\(\\theta\\) avendo osservato i dati \\(y\\). Nel modello probabilistico che stiamo esaminando, il termine \\(n\\) viene trattato come una costante nota e \\(\\theta\\) come una variabile casuale. Dato che \\(\\theta\\) è incognito, ma abbiamo a disposione i dati \\(y\\), svolgeremo l’inferenza su \\(\\theta\\) mediante la regola di Bayes per determinare la distribuzione a posteriori \\(p(\\theta \\mid y)\\). Remark. Si noti che il modello probabilistico (12.2) non spiega perché, in ciascuna realizzazione, \\(Y\\) assuma un particolare valore. Questo modello deve piuttosto essere inteso come un costrutto matematico che ha lo scopo di riflettere alcune proprietà del processo corrispondente ad una sequenza di prove Bernoulliane. Una parte del lavoro della ricerca in tutte le scienze consiste nel verificare le assunzioni dei modelli e, se necessario, nel migliorare i modelli dei fenomeni considerati. Un modello viene giudicato in relazione al suo obiettivo. Se l’obiettivo del modello molto semplice che stiamo discutendo è quello di prevedere la proporzione di casi nei quali \\(y_i = 1\\), \\(i = 1, \\dots, n\\), allora un modello con un solo parametro come quello che abbiamo introdotto sopra può essere sufficiente. Ma l’evento \\(y_i=1\\) (supponiamo: superare l’esame di Psicometria, oppure risultare positivi al COVID-19) dipende da molti fattori e se vogliamo rendere conto di una tale complessità, un modello come quello che stiamo discutendo qui certamente non sarà sufficiente. In altre parole, modelli sempre migliori vengono proposti, laddove ogni successivo modello è migliore di quello precedente in quanto ne migliora le capacità di previsione, è più generale, o è più elegante. Per concludere, un modello è un costrutto matematico il cui scopo è quello di rappresentare un qualche aspetto della realtà. Il valore di un tale strumento dipende dalla sua capacità di ottenere lo scopo per cui è stato costruito. References "],["distribuzioni-a-priori.html", "12.5 Distribuzioni a priori", " 12.5 Distribuzioni a priori Quando adottiamo un approccio bayesiano, i parametri della distribuzione di riferimento non venono considerati come delle costanti incognite ma bensì vengono trattati come variabili casuali e, di conseguenza, i parametri assumono una particolare distribuzione che nelle statistica bayesiana viene definita come “a priori”. I parametri (o il parametro), che possiamo indicare con \\(\\theta\\), possono assumere delle distribuzioni a priori differenti; a seconda delle informazioni disponibili bisogna cercare di assegnare una distribuzione di \\(\\theta\\) in modo tale che venga assegnata una probabilità maggiore a quei valori che si ritengono più plausibili per \\(\\theta\\). La distribuzione a priori sui valori dei parametri \\(p(\\theta)\\) è parte integrante del modello statistico. Ciò implica che due modelli bayesiani possono condividere la stessa funzione di verosimiglianza, ma tuttavia devono essere considerati come modelli diversi se specificano diverse distribuzioni a priori. Ciò significa che, quando diciamo “Modello binomiale”, intendiamo in realtà un’intera classe di modelli, ovvero tutti i possibili modelli che hanno la stessa verosimiglianza ma diverse distribuzioni a priori su \\(\\theta\\). Nell’analisi dei dati bayesiana, la distribuzione a priori \\(p(\\theta)\\) codifica le credenze del ricercatore a proposito dei valori dei parametri, prima di avere osservato i dati. Idealmente, le credenze a priori che supportano la specificazione di una distribuzione a priori dovrebbero essere supportate da una qualche motivazione, come ad esempio i risultati di ricerche precedenti, o altre motivazioni giustificabili. Quando una nuova osservazione (p. es., vedo un cigno bianco) corrisponde alle mie credenze precedenti (p. es., la maggior parte dei cigni sono bianchi) la nuova osservazione rafforza le mie credenze precedenti: più nuove osservazioni raccolgo (p. es., più cigni bianchi vedo), più forti diventano le mie credenze precedenti. Tuttavia, quando una nuova osservazione (p. es., vedo un cigno nero) non corrisponde alle mie credenze precedenti, ciò contribuisce a diminuire la certezza che attribuisco alle mie credenze: tanto maggiori diventano le osservazioni non corrispondenti alle mie credenze (p. es., più cigni neri vedo ), tanto più si indeboliscono le mie credenze. Fondamentalmente, tanto più forti sono le mie credenze precedenti, di tante più osservazioni incompatibili (ad esempio, cigni neri) ho bisogno per cambiare idea. Pertanto, da una prospettiva bayesiana, l’incertezza intorno ai parametri di un modello dopo aver visto i dati (ovvero le distribuzioni a posteriori) deve includere anche le credenze precedenti. Se questo modo di ragionare vi sembra molto intuitivo, non è una coincidenza: vi sono infatti diverse teorie psicologiche che prendono l’aggiornamento bayesiano come modello di funzionamento di diversi processi cognitivi. 12.5.1 Tipologie di distribuzioni a priori Possiamo distinguere tra diverse distribuzioni a priori in base a quanto fortemente impegnano il ricercatore a ritenere come plausibile un particolare intervallo di valori dei parametri. Il caso più estremo è quello che rivela una totale assenza di conoscenze a priori, il che conduce alle distribuzioni a priori non informative, ovvero quelle che assegnano lo stesso livello di credibilità a tutti i valori dei parametri. Le distribuzioni a priori informative, d’altra parte, possono essere debolmente informative o fortemente informative, a seconda della forza della credenza che esprimono. Il caso più estremo di credenza a priori è quello che riassume il punto di vista del ricercatore nei termini di un unico valore del parametro, il che assegna tutta la probabilità (massa o densità) su di un singolo valore di un parametro. Poiché questa non è più una distribuzione di probabilità, sebbene ne soddisfi la definizione, in questo caso si parla di una distribuzione a priori degenerata. La figura seguente mostra esempi di distribuzioni a priori non informative, debolmente o fortemente informative, così come una distribuzione a priori espressa nei termini di un valore puntuale per il modello Binomiale. Le distribuzione a priori illustrate di seguito sono le seguenti: non informativa : \\(\\theta_c \\sim \\mbox{Beta}(1,1)\\); debolmente informativa : \\(\\theta_c \\sim \\mbox{Beta}(5,2)\\); fortemente informativa : \\(\\theta_c \\sim \\mbox{Beta}(50,20)\\); valore puntuale : \\(\\theta_c \\sim \\mbox{Beta}(\\alpha, \\beta)\\) con \\(\\alpha, \\beta \\rightarrow \\infty\\) e \\(\\frac{\\alpha}{\\beta} = \\frac{5}{2}\\). FIGURA 12.1: Esempi di distribuzioni a priori per il parametro \\(\\theta_c\\) nel Modello Binomiale. 12.5.2 Selezione della distribuzione a priori La selezione delle distribuzioni a priori è stata spesso vista come una delle scelte più importanti che un ricercatore fa quando implementa un modello bayesiano in quanto può avere un impatto sostanziale sui risultati finali. La soggettività delle distribuzioni a priori è evidenziata dai critici come un potenziale svantaggio dei metodi bayesiani. A questa critica, Schoot et al. (2021) rispondono dicendo che, al di là della scelta delle distribuzioni a priori, ci sono molti elementi del processo di inferenza statistica che sono soggettivi, ovvero la scelta del modello statistico e le ipotesi sulla distribuzione degli errori. In secondo luogo, Schoot et al. (2021) notano come le distribuzioni a priori svolgono due importanti ruoli statistici: quello della “regolarizzazione della stima”, ovvero, il processo che porta ad indebolire l’influenza indebita di osservazioni estreme, e quello del miglioramento dell’efficienza della stima, ovvero, la facilitazione dei processi di calcolo numerico di stima della distribuzione a posteriori. L’effetto della distribuzione a priori sulla distribuzione a posteriori verrà discusso nel Capitolo ??. 12.5.3 La distribuzione a priori per i dati di Zetsche, Bürkner, and Renneberg (2019) In un problema concreto di analisi dei dati, la scelta della distribuzione a priori dipende dalle credenze a priori che vogliamo includere nell’analisi dei dati. Se non abbiamo alcuna informazione a priori, potremmo pensare di usare una distribuzione a priori uniforme, ovvero una Beta di parametri \\(\\alpha=1\\) e \\(\\beta=1\\). Questa, tuttavia, è una cattiva idea perché il risultato ottenuto non è invariante a seconda della trasformazione della scala dei dati (ad esempio, se esprimiamo l’altezza in cm piuttosto che in m). Il problema della riparametrizzazione verrà discusso nel Capitolo ?? TODO. È invece raccomandato usare una distribuzione a priori poco informativa, come ad esempio \\(\\mbox{Beta}(2, 2)\\). Nella presente discussione, per fare un esempio, quale distribuzione a priori useremo una \\(\\mbox{Beta}(2, 10)\\), ovvero: \\[ p(\\theta) = \\frac{\\Gamma(12)}{\\Gamma(2)\\Gamma(10)}\\theta^{2-1} (1-\\theta)^{10-1}. \\] bayesrules::plot_beta(alpha = 2, beta = 10, mean = TRUE, mode = TRUE) La \\(\\mbox{Beta}(2, 10)\\) esprime la credenza che \\(\\theta\\) assume valori \\(&lt; 0.5\\), con il valore più plausibile pari a circa 0.1. Questo è assolutamente implausibile, nel caso dell’esempio in discussione. Adotteremo una tale distribuzione a priori solo per scopi didattici, per esplorare le conseguenze di tale scelta (molto più sensato sarebbe stato usare \\(\\mbox{Beta}(2, 2)\\)). References "],["verosimiglianza.html", "12.6 Verosimiglianza", " 12.6 Verosimiglianza Oltre alla distribuzione a priori di \\(\\theta\\), nel numeratore della regola di Bayes troviamo la funzione di verosimigliana. Iniziamo dunque con una definizione. Definizione 12.1 La funzione di verosimiglianza \\(\\mathcal{L}(\\theta \\mid y) = f(y \\mid \\theta), \\theta \\in \\Theta,\\) è la funzione di massa o di densità di probabilità dei dati \\(y\\) vista come una funzione del parametro sconosciuto (o dei parametri sconosciuti) \\(\\theta\\). Detto in altre parole, le funzioni di verosimiglianza e di (massa o densità di) probabilità sono formalmente identiche, ma è completamente diversa la loro interpretazione. Nel caso della funzione di massa o di densità di probabilità la distribuzione del vettore casuale delle osservazioni campionarie \\(y\\) dipende dai valori assunti dal parametro (o dai parametri) \\(\\theta\\); nel caso della la funzione di verosimiglianza la credibilità assegnata a ciascun possibile valore \\(\\theta\\) viene determinata avendo acquisita l’informazione campionaria \\(y\\) che rappresenta l’elemento condizionante. In altri termini, la funzione di verosimiglianza è lo strumento che consente di rispondere alla seguente domanda: avendo osservato i dati \\(y\\), quanto risultano (relativamente) credibili i diversi valori del parametro \\(\\theta\\)? Spesso per indicare la verosimiglianza si scrive \\(\\mathcal{L}(\\theta)\\) se è chiaro a quali valori \\(y\\) ci si riferisce. La verosimiglianza \\(\\mathcal{L}\\) è una curva (in generale, una superficie) nello spazio \\(\\Theta\\) del parametro (in generale, dei parametri) che riflette la credibilità relativa dei valori \\(\\theta\\) alla luce dei dati osservati. Notiamo un punto importante: la funzione \\(\\mathcal{L}(\\theta \\mid y)\\) non è una funzione di densità. Infatti, essa non racchiude un’area unitaria. In conclusione, la funzione di verosimiglianza descrive in termini relativi il sostegno empirico che \\(\\theta \\in \\Theta\\) riceve da \\(y\\). Infatti, la funzione di verosimiglianza assume forme diverse al variare di \\(y\\) (lasciamo come esercizio da svolgere la verifica di questa affermazione). 12.6.1 La stima di massima verosimiglianza La funzione di verosimiglianza rappresenta la “credibilità relativa” dei valori del parametro di interesse. Ma qual è il valore più credibile? Se utilizziamo soltanto la funzione di verosimiglianza, allora la risposta è data dalla stima di massima verosimiglinza. Definizione 12.2 Un valore di \\(\\theta\\) che massimizza \\(\\mathcal{L}(\\theta \\mid y)\\) sullo spazio parametrico \\(\\Theta\\) è detto stima di massima verosimiglinza (s.m.v.) di \\(\\theta\\) ed è indicato con \\(\\hat{\\theta}\\): \\[\\begin{equation} \\hat{\\theta} = \\argmax_{\\theta \\in \\Theta} \\mathcal{L}(\\theta). \\end{equation}\\] Il paradigma frequentista utilizza la funzione di verosimiglianza quale unico strumento per giungere alla stima del valore più credibile del parametro sconosciuto \\(\\theta\\). Tale stima corrisponde al punto di massimo della funzione di verosimiglianza. In base all’approccio bayesiano, invece, il valore più credibile del parametro sconosciuto \\(\\theta\\), anziché alla s.m.v., corrisponde invece alla moda (o media, o mediana) della distribuzione a posteriori \\(p(\\theta \\mid y)\\) che si ottiene combinando la verosimiglianza \\(p(y \\mid \\theta)\\) con la distribuzione a priori \\(p(\\theta)\\). Per un approfondimento della stima di massima verosimiglianza si veda l’Appendice ??. 12.6.2 La log-verosimiglianza Dal punto di vista pratico risulta più conveniente utilizzare, al posto della funzione di verosimiglianza, il suo logaritmo naturale, ovvero la funzione di log-verosimiglianza: \\[\\begin{equation} \\ell(\\theta) = \\log \\mathcal{L}(\\theta). \\end{equation}\\] Poiché il logaritmo è una funzione strettamente crescente (usualmente si considera il logaritmo naturale), allora \\(\\mathcal{L}(\\theta)\\) e \\(\\ell(\\theta)\\) assumono il massimo (o i punti di massimo) in corrispondenza degli stessi valori di \\(\\theta\\): \\[ \\hat{\\theta} = \\argmax_{\\theta \\in \\Theta} \\ell(\\theta) = \\argmax_{\\theta \\in \\Theta} \\mathcal{L}(\\theta). \\] Per le proprietà del logaritmo, si ha \\[\\begin{equation} \\ell(\\theta) = \\log \\left( \\prod_{i = 1}^n f(y \\mid \\theta) \\right) = \\sum_{i = 1}^n \\log f(y \\mid \\theta). \\end{equation}\\] Si noti che non è necessario lavorare con i logaritmi, ma è fortemente consigliato. Il motivo è che i valori della verosimiglianza, in cui si moltiplicano valori di probabilità molto piccoli, possono diventare estremamente piccoli – qualcosa come \\(10^{-34}\\). In tali circostanze, non è sorprendente che i programmi dei computer mostrino problemi di arrotondamento numerico. Le trasformazioni logaritmiche risolvono questo problema. Remark. Seguendo una pratica comune, in questa dispensa spesso useremo la notazione \\(p(\\cdot)\\) per rappresentare due quantità differenti, ovvero la funzione di verosimiglianza e la distribuzione a priori. Questo piccolo abuso di notazione riflette il seguente punto di vista: anche se la verosimiglianza non è una funzione di densità di probabilità, noi non vogliamo stressare questo aspetto, ma vogliamo piuttosto pensare alla verosimiglianza e alla distribuzione a priori come a due elementi che sono egualmente necessari per calcolare la distribuzione a posteriori. In altri termini, per così dire, questa notazione assegna lo stesso status epistemologico alle due diverse quantità che si trovano al numeratore della regola di Bayes. Esercizio 12.1 Per i dati di Zetsche, Bürkner, and Renneberg (2019), ovvero 23 “successi” in 30 prove, si trovi e si interpreti la funzione di verosimiglianza. Per i dati di Zetsche, Bürkner, and Renneberg (2019) la funzione di verosimiglianza corrisponde alla funzione binomiale di parametro \\(\\theta \\in [0, 1]\\) sconosciuto. Abbiamo osservato un “successo” 23 volte in 30 “prove”, dunque, \\(y = 23\\) e \\(n = 30\\). La funzione di verosimiglianza diventa \\[\\begin{equation} \\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} \\theta^{23} + (1-\\theta)^7. \\tag{12.3} \\end{equation}\\] Per costruire la funzione di verosimiglianza dobbiamo applicare la (12.3) tante volte, cambiando ogni volta il valore \\(\\theta\\) ma tenendo sempre costante il valore dei dati. Per esempio, se poniamo \\(\\theta = 0.1\\) \\[ \\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} 0.1^{23} + (1-0.1)^7 \\] otteniamo dbinom(23, 30, 0.1) #&gt; [1] 9.737e-18 Se poniamo \\(\\theta = 0.2\\) \\[ \\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} 0.2^{23} + (1-0.2)^7 \\] otteniamo dbinom(23, 30, 0.2) #&gt; [1] 3.581e-11 e così via. La figura 12.2 — costruita utilizzando 100 valori equispaziati \\(\\theta \\in [0, 1]\\) — fornisce una rappresentazione grafica della funzione di verosimiglianza. n &lt;- 30 y &lt;- 23 theta &lt;- seq(0, 1, length.out = 100) like &lt;- choose(n, y) * theta^y * (1 - theta)^(n - y) tibble(theta, like) %&gt;% ggplot(aes(x = theta, y = like)) + geom_line() + labs( y = expression(L(theta)), x = expression(&quot;Valori possibili di&quot; ~ theta) ) FIGURA 12.2: Funzione di verosimiglianza nel caso di 23 successi in 30 prove. Come possiamo interpretare la curva che abbiamo ottenuto? Per alcuni valori \\(\\theta\\) la funzione di verosimiglianza assume valori piccoli; per altri valori \\(\\theta\\) la funzione di verosimiglianza assume valori più grandi. Questi ultimi sono i valori di \\(\\theta\\) “più credibili” e il valore 23/30 è il valore più credibile di tutti. La funzione di verosimiglianza di \\(\\theta\\) valuta la compatibilità dei dati osservati \\(Y = y\\) con i diversi possibili valori \\(\\theta\\). In termini più formali possiamo dire che la funzione di verosimiglianza ha la seguente interpretazione: sulla base dei dati, \\(\\theta_1 \\in \\Theta\\) è più credibile di \\(\\theta_2 \\in \\Theta\\) come indice del modello probabilistico generatore delle osservazioni se \\(\\mathcal{L}(\\theta_1) &gt; \\mathcal{L}(\\theta_1)\\). References "],["sec:const-normaliz-bino23.html", "12.7 La verosimiglianza marginale", " 12.7 La verosimiglianza marginale Per il calcolo di \\(p(\\theta \\mid y)\\) è necessario dividere il prodotto tra la distribuzione a priori e la verosimiglianza per una costante di normalizzazione. Tale costante di normalizzazione, detta verosimiglianza marginale, ha lo scopo di fare in modo che \\(p(\\theta \\mid y)\\) abbia area unitaria. Si noti che il denominatore della regola di Bayes (ovvero la verosimiglianza marginale) è sempre espresso nei termini di un integrale. Tranne in pochi casi particolari, tale integrale non ha una soluzione analitica. Per questa ragione, l’inferenza bayesiana procede calcolando una approssimazione della distribuzione a posteriori mediante metodi numerici. Esercizio 12.2 Si trovi la verosimiglianza maginale per i dati di Zetsche, Bürkner, and Renneberg (2019). Supponiamo che nel numeratore bayesiano la verosimiglianza sia moltiplicata per una distribuzione uniforme, \\(\\mbox{Beta}(1, 1)\\). In questo caso, il prodotto si riduce alla funzione di verosimiglianza. In riferimento ai dati di Zetsche, Bürkner, and Renneberg (2019), la costante di normalizzazione per si ottiene semplicemente marginalizzando la funzione di verosimiglianza \\(p(y = 23, n = 30 \\mid \\theta)\\) sopra \\(\\theta\\), ovvero risolvendo l’integrale: \\[\\begin{equation} p(y = 23, n = 30) = \\int_0^1 \\binom{30}{23} \\theta^{23} (1-\\theta)^{7} \\,\\operatorname {d}\\!\\theta. \\tag{12.4} \\end{equation}\\] Una soluzione numerica si trova facilmente usando \\(\\R\\): like_bin &lt;- function(theta) { choose(30, 23) * theta^23 * (1 - theta)^7 } integrate(like_bin, lower = 0, upper = 1)$value #&gt; [1] 0.03226 La derivazione analitica della costante di normalizzazione qui discussa è fornita nell’Appendice ??. References "],["distribuzione-a-posteriori.html", "12.8 Distribuzione a posteriori", " 12.8 Distribuzione a posteriori La distribuzione a postreriori si trova applicando il teorema di Bayes: \\[ \\text{probabilità a posteriori} = \\frac{\\text{probabilità a priori} \\cdot \\text{verosimiglianza}}{\\text{costante di normalizzazione}} \\] Ci sono due metodi principali per calcolare la distribuzione a posteriori \\(p(\\theta \\mid y)\\): una precisa derivazione matematica formulata nei termini della distribuzione a priori coniugata alla distribuzione a posteriori (si veda il Capitolo ??); tale procedura però ha un’applicabilità molto limitata; un metodo approssimato, molto facile da utilizzare in pratica, che dipende da metodi Monte Carlo basati su Catena di Markov (MCMC); questo problema verrà discusso nel Capitolo ?? Una volta trovata la distribuzione a posteriori, possiamo usarla per derivare altre quantità di interesse. Questo viene generalmente ottenuto calcolando il valore atteso: \\[ J = \\int f(\\theta) p(\\theta \\mid y) \\,\\operatorname {d}\\!y \\] Se \\(f(\\cdot)\\) è la funzione identità, ad esempio, \\(J\\) risulta essere la media di \\(\\theta\\): \\[ \\bar{\\theta} = \\int_{\\Theta} \\theta p(\\theta \\mid y) \\,\\operatorname {d}\\!\\theta . \\] "],["distribuzione-predittiva-a-priori.html", "12.9 Distribuzione predittiva a priori", " 12.9 Distribuzione predittiva a priori La distribuzione a posteriori è l’oggetto centrale nella statistica bayesiana, ma non è l’unico. Oltre a fare inferenze sui valori dei parametri, potremmo voler fare inferenze sui dati. Questo può essere fatto calcolando la distribuzione predittiva a priori: \\[\\begin{equation} p(y^*) = \\int_\\Theta p(y^* \\mid \\theta) p(\\theta) \\,\\operatorname {d}\\!\\theta . \\tag{12.5} \\end{equation}\\] La (12.5) descrive la distribuzione prevista dei dati in base al modello (che include la distribuzione a priori e la verosimiglianza). Questi sono i dati \\(y^*\\) che ci aspettiamo, dato il modello, prima di avere osservato i dati del campione. Possiamo utilizzare campioni dalla distribuzione predittiva a priori per valutare e calibrare i modelli utilizzando le nostre conoscenze dominio-specifiche. Ad esempio, ci potremmo chiedere: “È sensato che un modello dell’altezza umana preveda che un essere umano sia alto -1.5 metri?”. Già prima di misurare una singola persona, possiamo renderci conto dell’assurdità di questa domanda. Se la distribuzione prevista dei dati consente domande di questo tipo, è chiaro che il modello deve essere riformulato. Remark. Si dice comunemente che l’adozione di una prospettiva probabilistica per la modellazione conduce all’idea che i modelli generano dati. Se i modelli generano dati, possiamo creare modelli adatti per i nostri dati solo pensando a come i dati potrebbero essere stati generati. Inoltre, questa idea non è solo un concetto astratto. Assume una concreta nella forma della distribuzione predittiva a priori. Se la distribuzione predittiva a priori non ha senso, come abbiamo detto sopra, diventa necessario riformulare il modello. "],["distribuzione-predittiva-a-posteriori.html", "12.10 Distribuzione predittiva a posteriori", " 12.10 Distribuzione predittiva a posteriori Un’altra quantità utile da calcolare è la distribuzione predittiva a posteriori: \\[\\begin{equation} p(\\tilde{y} \\mid y) = \\int_\\Theta p(\\tilde{y} \\mid \\theta) p(\\theta \\mid y) \\,\\operatorname {d}\\!\\theta . \\tag{12.6} \\end{equation}\\] Questa è la distribuzione dei dati attesi futuri \\(\\tilde{y}\\) alla luce della distribuzione a posteriori \\(p(\\theta \\mid y)\\), che a sua volta è una conseguenza del modello (distribuzione a priori e verosimiglianza) e dei dati osservati. In altre parole, questi sono i dati che il modello si aspetta dopo aver osservato i dati \\(y\\). Dalla (12.6) possiamo vedere che le previsioni sui dati attesi futuri sono calcolate integrando (o marginalizzando) sulla distribuzione a posteriori dei parametri. Di conseguenza, le previsioni calcolate in questo modo incorporano l’incertezza relativa alla stima dei parametri del modello. "],["considerazioni-conclusive-6.html", "Considerazioni conclusive", " Considerazioni conclusive Questo Capitolo ha brevemente passato in rassegna alcuni concetti di base dell’inferenza statistica bayesiana. In base all’approccio bayesiano, invece di dire che il parametro di interesse di un modello statistico ha un valore vero ma sconosciuto, diciamo che, prima di eseguire l’esperimento, è possibile assegnare una distribuzione di probabilità, che chiamano stato di credenza, a quello che è il vero valore del parametro. Questa distribuzione a priori può essere nota (per esempio, sappiamo che la distribuzione dei punteggi del QI è normale con media 100 e deviazione standard 15) o può essere del tutto arbitraria. L’inferenza bayesiana procede poi nel modo seguente: si raccolgono alcuni dati e si calcola la probabilità dei possibili valori del parametro alla luce dei dati osservati e delle credenze a priori. Questa nuova distribuzione di probabilità è chiamata “distribuzione a posteriori” e riassume l’incertezza dell’inferenza. I concetti importanti che abbiamo appreso in questo Capitolo sono quelli di distribuzione a priori, verosimiglianza, verosimiglianza marginale e distribuzione a posteriori. Questi sono i concetti fondamentali della statistica bayesiana. "],["chapter-ppc.html", "Capitolo 13 Distribuzione predittiva a posteriori", " Capitolo 13 Distribuzione predittiva a posteriori Oltre ad una sintesi della distribuzione a posteriori attraverso il computo di indici caratteristici e alla verifica di ipotesi, un altro compito dell’analisi bayesiana è la predizione di nuovi dati futuri. Dopo aver osservato i dati di un campione e ottenuto le distribuzioni a posteriori dei parametri, è infatti possibile ottenere una qualche indicazione su come potrebbero essere i dati futuri. L’uso più immediato della stima della distribuzione dei possibili valori futuri della variabile di esito è la verifica del modello. Infatti, il modo più diretto per testare un modello è quello di utilizzare il modello per fare previsioni sui possibili dati futuri per poi confrontare i dati predetti con i dati effettivi. Questa pratica va sotto il nome di controllo predittivo a posteriori. "],["la-distribuzione-dei-possibili-valori-futuri.html", "13.1 La distribuzione dei possibili valori futuri", " 13.1 La distribuzione dei possibili valori futuri La distribuzione dei possibili valori futuri della variabile di esito può essere predetta da un modello statistico sulla base della distribuzione a posteriori dei parametri, \\(p(\\theta \\mid y)\\), avendo già osservato \\(n\\) manifestazioni del fenomeno \\(y\\). Una tale distribuzione va sotto il nome di distribuzione predittiva a posteriori (posterior predictive distribution, PPD). Quando vengono simulate le osservazioni della distribuzione predittiva a posteriori si usa la notazione \\(y^{rep}\\) (dove \\(rep\\) sta per replica) quando, nella simulazione, vengono utilizzate le stesse osservazioni di \\(X\\) che erano state usate per stimare i parametri del modello. Si usa invece la notazione \\(\\tilde{y}\\) per fare riferimento a possibili valori \\(X\\) che non sono contenuti nel campione osservato, ovvero, ad un campione di dati che potrebbe essere osservato in qualche futura occasione. La distribuzione predittiva a posteriori viene usata per fare inferenze predittive. L’idea è che, se il modello ben si adatta bene ai dati del campione allora, sulla base dei parametri stimati, dovremmo essere in grado di generare nuovi dati non osservati \\(y^{rep}\\) che risultano molto simili ai dati osservati \\(y\\). I dati \\(y^{rep}\\) vengono concepiti come stime di \\(\\tilde{y}\\). La distribuzione predittiva a posteriorie è data da: \\[\\begin{equation} p(\\tilde{y} \\mid y) = \\int_{\\theta} p(\\tilde{y}, \\theta \\mid y) d \\theta = \\int_{\\theta} p(\\tilde{y} \\mid \\theta, y) p(\\theta \\mid y) d\\theta.\\notag \\end{equation}\\] Supponendo che le osservazioni passate e future siano condizionalmente indipendenti dato \\(\\theta\\), ovvero che \\(p(\\tilde{y} \\mid \\theta, y) = p(\\tilde{y} \\mid \\theta)\\), possiamo scrivere \\[\\begin{equation} p(\\tilde{y} \\mid y) = \\int_{\\theta} p(\\tilde{y} \\mid \\theta) p(\\theta \\mid y) d\\theta. \\tag{13.1} \\end{equation}\\] La (13.1) descrive la nostra incertezza sulla distribuzione di future osservazioni di dati, data la distribuzione a posteriori di \\(\\theta\\), ovvero tenendo conto della scelta del modello e della stima dei parametri mediante i dati osservati. Si noti che, nella (13.1), \\(\\tilde{y}\\) è condizionato da \\(y\\) ma non da ciò che è incognito, ovvero \\(\\theta\\). La distribuzione predittiva a posteriori è invece ottenuta mediante marginalizzazione sopra le variabili da “scartare”, ovvero sopra i parametri incogniti \\(\\theta\\). Un esempio formulato mediante il codice Stan può chiarire questo concetto. Consideriamo il codice relativo alla distribuzione predittiva a posteriori nel caso di un modello di regressione lineare classico con un solo predittore \\(x\\). Il blocco Model sarà: model { y ~ normal(x * beta + alpha, sigma); } Quello che è di interesse per la discussione presente è il blocco Generated Quantities. Tale blocco avrà questa forma: generated quantities { real y_rep[N]; for (n in 1:N) { y_rep[n] = normal_rng(x[n] * beta + alpha, sigma); } } La variabile y_rep è ciò a cui siamo interessati. Nel codice precedente, x è il vettore che contiene i valori della variabile indipendente nel campione di osservazioni esaminato. I parametri del modello di regressione sono alpha e beta; sigma è la stima dell’errore standard della regressione. Supponiamo che questi tre parametri siano degli scalari. Se lo fossero, per il valore x \\(n\\)-esimo, l’istruzione normal_rng() ritornerebbe un valore a caso dalla distribuzione normale con media \\(\\alpha + \\beta x_n\\) e deviazione standard \\(\\sigma\\). Il ciclo for() ripete questa operazione \\(N\\) volte, ovvero tante volte quanti sono gli elementi del vettore x del campione. Quello che è stato detto sopra ci dà un’idea di quello che succederebbe se alpha, beta e sigma fossero degli scalari. Ma non lo sono. Per ciascuno dei tre paramatri abbiamo un numero molto alto di stime, ovvero l’approssimazione MCMC della distribuzione a posteriori. Poniamo che l’ampiezza campionaria \\(N\\) sia 30. Se alpha, beta e sigma fossero degli scalari, la distribuzione predittiva a posteriori sarebbe costituita da 30 valori \\(y^{rep}\\), ovvero, non sarebbe nient’altro che \\(\\hat{y} = \\hat{\\alpha} + \\hat{\\beta} x\\). Ma alpha, beta e sigma non sono degli scalari: per ciascuno di questi parametri abbiamo un grande numero di stime, diciamo 2000. Dunque, quando normal_rng() estrae un valore a caso dalla distribuzione normale, i parametri della normale non sono fissi: per determinare \\(\\mu\\) prendiamo un valore a caso, chiamiamolo beta', dalla distribuzione dei valori beta e un valore a caso, chiamiamolo alpha', dalla distribuzione dei valori alpha. Avendo questi due valori, calcoliamo il valore \\(\\mu&#39;_n = \\alpha&#39; + \\beta&#39; x_n\\). Lo stesso si può dire per \\(\\sigma&#39;\\). A questo punto possiamo trovare il valore y_n' estraendo un valore a caso dalla distribuzione gaussiana di parametri \\(\\mu&#39;\\) e \\(\\sigma&#39;\\). Per l’\\(n\\)-esimo valore \\(x\\) possiamo ripetere questo processo tante volte. Se lo ripetiamo, ad esempio, 2,000 volte, per tutti e 30 i valori \\(x\\) del campione otterremo una matrice \\(30 \\times 2,000\\). In questo modo possiamo generare le previsioni del modello, ovvero \\(y^{rep}\\), che includono due fonti di incertezza: la variabilità campionaria, ovvero il fatto che abbiamo osservato uno specifico insieme di valori \\((x, y)\\); in un altro campione tali valori saranno diversi; la variabilità a posteriori della distribuzione dei parametri, ovvero il fatto che di ciascun parametro non conosciamo il “valore vero” ma solo una distribuzione (a posteriori) di valori. Nel caso dell’esempio presente, l’integrale della (13.1) può essere interpretato dicendo che, nell’esempio della matrice di dimensioni \\(30 \\times 2,000\\), noi marginalizziamo rispetto alle colonne, ovvero, per ciascuna riga facciamo la media dei valori colonna. Otteniamo così un vettore di 30 osservazioni, ovvero \\(y^{rep}\\). Quando, con metodi grafici, vengono esaminati i valori della distribuzione predittiva a posteriori, possiamo esaminare un numero arbitrario di previsioni. Per esempio, possiamo rappresentare graficamente 50 rette di regressione predette – o un qualsiasi altro numero. Questa rappresentazione grafica quantifica la nostra incertezza a posteriori relativamente (in questo esempio) all’orientamento della retta di regressione. Esercizio 13.1 Illustreremo ora il problema di trovare la distribuzione \\(p(\\tilde{y} \\mid y)\\) in un caso semplice, ovvero quello dello schema Beta-Binomiale. Nell’esempio, useremo un’altra volta i dati del campione di pazienti clinici depressi di Zetsche, Bürkner, and Renneberg (2019) – si veda l’Appendice ??. Supponendo di volere esaminare in futuro altri 30 pazienti clinici, ci chiediamo: quanti di essi manifesteranno una depressione grave? Se vogliamo fare predizioni su \\(\\tilde{y}\\) (il numero di “successi” previsti futuri) dobbiamo innanzitutto riconoscere che i possibili valori \\(\\tilde{y} \\in \\{0, 1, \\dots, 30\\}\\) non sono tutti egualmente plausibili. Sappiamo che \\(\\tilde{y}\\) è una v.c. binomiale con distribuzione \\[\\begin{equation} p(\\tilde{y}\\mid \\theta) = \\binom{30}{\\tilde{y}} \\theta^{\\tilde{y}}(1-\\theta)^{30 - \\tilde{y}} \\; . \\tag{13.2} \\end{equation}\\] La v.c. \\(\\tilde{y}\\) dipende da \\(\\theta\\), ma il parametro \\(\\theta\\) è esso stesso una variabile casuale. Avendo osservato \\(y = 23\\) successi in \\(n = 30\\) prove nel campione (laddove la presenza di una depressione grave è stata considerata un “successo”), e avendo assunto come distribuzione a priori per \\(\\theta\\) una \\(\\mbox{Beta}(2, 10)\\) (per continuare con l’esempio precedente), la distribuzione a posteriori di \\(\\theta\\) sarà una \\(\\mbox{Beta}(25, 17)\\): bayesrules::summarize_beta_binomial( alpha = 2, beta = 10, y = 23, n = 30 ) #&gt; model alpha beta mean mode var sd #&gt; 1 prior 2 10 0.1667 0.1 0.010684 0.10336 #&gt; 2 posterior 25 17 0.5952 0.6 0.005603 0.07485 Per trovare la distribuzione sui possibili dati previsti futuri \\(\\tilde{y}\\) dobbiamo applicare la (13.1): \\[\\begin{align} p(\\tilde{y} \\mid y = 23) = \\int_0^1 p(\\tilde{y} \\mid \\theta) p(\\theta \\mid y = 23) d\\theta \\; . \\tag{13.3} \\end{align}\\] Per il modello Beta-Binomiale è possibile trovare una soluzione analitica alla (13.1). Poniamo di avere osservato \\(y\\) successi in \\(n\\) prove e di utilizzare una distribuzione a priori \\(\\mbox{Beta}(a, b)\\). Possiamo scrivere \\[\\begin{align} p(\\tilde{y} \\mid y) &amp;= \\int_0^1 p(\\tilde{y} \\mid \\theta) p(\\theta \\mid y)\\, d\\theta \\notag\\\\ &amp;= \\int_0^1 \\begin{pmatrix}\\tilde{n}\\\\\\tilde{y}\\end{pmatrix} \\theta^{\\tilde{y}} (1-\\theta)^{\\tilde{n}-\\tilde{y}} \\mbox{Beta}(a+y,b+n-y) \\, d\\theta \\notag\\\\ &amp;= \\begin{pmatrix}{\\tilde{n}}\\\\\\tilde{y}\\end{pmatrix} \\int_0^1 \\theta^{\\tilde{y}} (1-\\theta)^{\\tilde{n}-\\tilde{y}} \\frac{1}{B(a+y, b+n-y)}\\theta^{a+y-1}(1-\\theta)^{b+n-y-1}\\notag\\\\ &amp;= \\begin{pmatrix}{\\tilde{n}}\\\\\\tilde{y}\\end{pmatrix} \\frac{1}{B(a+y, b+n-y)}\\int_0^1 \\theta^{\\tilde{y}+a+y-1}(1-\\theta)^{\\tilde{n}-\\tilde{y}+b+n-y-1}\\notag\\\\ &amp;= \\begin{pmatrix}{\\tilde{n}}\\\\\\tilde{y}\\end{pmatrix} \\frac{B(\\tilde{y}+a+y,b+n-y+\\tilde{n}-\\tilde{y})}{B(a+y, b+n-y)} \\; . \\tag{13.4} \\end{align}\\] Svolgendo i calcoli in \\(\\R\\), per i dati dell’esempio otteniamo: beta_binom &lt;- function(rp) { val &lt;- choose(np, rp) * beta(rp + a + y, b + n - y + np - rp) / beta(a + y, b + n - y) val } n &lt;- 30 y &lt;- 23 a &lt;- 2 b &lt;- 10 np &lt;- 30 data.frame( heads = 0:np, pmf = beta_binom(0:np) ) %&gt;% ggplot(aes(x = factor(heads), y = pmf)) + geom_col() + labs( title = &quot;Distribuzione predittiva a posteriori&quot;, x = &quot;y&#39;&quot;, y = &quot;P(Y = y&#39; | Data)&quot; ) È facile vedere come, in questo esempio, la distribuzione predittiva a posteriori \\(p(\\tilde{y} \\mid y)\\) sia diversa dalla binomiale di parametro \\(\\theta = 23/30\\): tibble( heads = 0:np, pmf = dbinom(x = 0:np, size = np, prob = 23 / 30) ) %&gt;% ggplot(aes(x = factor(heads), y = pmf)) + geom_col() + labs( title = &quot;p(y | theta = 0.77)&quot;, x = &quot;y&quot;, y = &quot;Probabilità&quot; ) In particolare, la \\(p(\\tilde{y} \\mid y)\\) ha una varianza maggiore di \\(\\Bin(y \\mid \\theta = 0.77, n = 30)\\). Questa maggiore varianza riflette le due fonti di incertezza che sono presenti nella (13.1): l’incertezza sul valore del parametro (descritta dalla distribuzione a posteriori) e l’incertezza dovuta alla variabilità campionaria (descritta dalla funzione di verosimiglianza). Possiamo concludere la discussione di questo esempio dicendo che, nel caso di 30 nuovi pazienti clinici, alla luce delle nostre credenze precedenti e dei dati osservati nel campione, ci aspettiamo di osservare 18 pazienti con una depressione severa, anche se è ragionevole aspettarci un numero compreso, diciamo, tra 10 e 25. Una volta trovata la distribuzione predittiva a posteriori \\(p(\\tilde{y} \\mid y)\\) diventa possibile rispondere a domande come: qual è la probabilità di depressione grave in almeno 10 dei 30 pazienti futuri? Rispondere a domande di questo tipo è possibile, ma richiede un po’ di lavoro. Tuttavia, non è importante imparare scrivere il codice necessario a risolvere problemi di questo tipo perché, in generale, anche per problemi solo leggermente più complessi di quello discusso qui, non sono disponibili espressioni analitiche della distribuzione predittiva a posteriori. Invece, è possibile trovare una approssimazione numerica della \\(p(\\tilde{y} \\mid y)\\) mediante simulazioni MCMC. Inoltre, se viene utilizzato un tale metodo, risulta facile rispondere a domande simili a quella che abbiamo presentato sopra. References "],["metodi-mcmc-per-la-distribuzione-predittiva-a-posteriori.html", "13.2 Metodi MCMC per la distribuzione predittiva a posteriori", " 13.2 Metodi MCMC per la distribuzione predittiva a posteriori Se svolgiamo l’analisi bayesiana con il metodo MCMC, le repliche \\(p(y^{rep} \\mid y)\\) (ovvero le stime delle possibili osservazioni future \\(p(\\tilde{y} \\mid y)\\)) possono essere ottenute nel modo seguente: campionare \\(\\theta_i \\sim p(\\theta \\mid y)\\), ovvero campionare un valore del parametro dalla distribuzione a posteriori; campionare \\(y^{rep} \\sim p(y^{rep} \\mid \\theta_i)\\), ovvero campionare il valore di un’osservazione dalla funzione di verosimiglianza condizionata al valore del parametro definito nel passo precedente. Se i due passaggi descritti sopra vengono ripetuti un numero sufficiente di volte, l’istogramma risultante approssimerà la distribuzione predittiva a posteriori che, in teoria (ma non in pratica) potrebbe essere ottenuta per via analitica (si veda il Paragrafo ??). Esercizio 13.2 Generiamo ora \\(p(y^{rep} \\mid y)\\) nel caso dell’inferenza su una proporzione. Riportiamo qui sotto il codice Stan — si veda il Capitolo ??. modelString = &quot; data { int&lt;lower=0&gt; N; int&lt;lower=0, upper=1&gt; y[N]; } parameters { real&lt;lower=0, upper=1&gt; theta; } model { theta ~ beta(2, 10); y ~ bernoulli(theta); } generated quantities { int y_rep[N]; real log_lik[N]; for (n in 1:N) { y_rep[n] = bernoulli_rng(theta); log_lik[n] = bernoulli_lpmf(y[n] | theta); } } &quot; writeLines(modelString, con = &quot;code/betabin23-30-2-10.stan&quot;) Si noti che nel nel blocco generated quantities sono state aggiunte le istruzioni necessarie per simulare \\(y^{rep}\\), ovvero, y_rep[n] = bernoulli_rng(theta). I dati dell’esempio sono: data_list &lt;- list( N = 30, y = c(rep(1, 23), rep(0, 7)) ) Compiliamo il codice Stan file &lt;- file.path(&quot;code&quot;, &quot;betabin23-30-2-10.stan&quot;) mod &lt;- cmdstan_model(file) ed eseguiamo il campionamento MCMC: fit &lt;- mod$sample( data = data_list, iter_sampling = 4000L, iter_warmup = 2000L, seed = SEED, cores = 4L, chains = 4L, parallel_chains = 4L, refresh = 0, thin = 1 ) Per comodità, trasformiamo l’oggetto fit in un oggetto di classe stanfit: stanfit &lt;- rstan::read_stan_csv(fit$output_files()) Il contenuto dell’oggetto stanfit può essere esaminato nel modo seguente: list_of_draws &lt;- extract(stanfit) print(names(list_of_draws)) #&gt; [1] &quot;theta&quot; &quot;y_rep&quot; &quot;log_lik&quot; &quot;lp__&quot; Dall’oggetto list_of_draws recuperiamo y_rep: y_bern &lt;- list_of_draws$y_rep dim(y_bern) #&gt; [1] 16000 30 head(y_bern) #&gt; #&gt; iterations [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] #&gt; [1,] 1 1 0 0 1 0 1 0 #&gt; [2,] 0 1 0 1 0 1 1 0 #&gt; [3,] 1 1 0 0 1 1 1 1 #&gt; [4,] 1 0 1 1 0 1 0 1 #&gt; [5,] 1 1 0 1 1 1 0 1 #&gt; [6,] 1 0 1 1 1 0 0 1 #&gt; #&gt; iterations [,9] [,10] [,11] [,12] [,13] [,14] [,15] #&gt; [1,] 0 0 1 0 1 1 1 #&gt; [2,] 1 0 1 1 1 1 1 #&gt; [3,] 1 1 1 0 0 1 1 #&gt; [4,] 1 1 1 1 1 1 0 #&gt; [5,] 1 0 1 0 1 1 1 #&gt; [6,] 1 1 1 1 1 1 1 #&gt; #&gt; iterations [,16] [,17] [,18] [,19] [,20] [,21] [,22] #&gt; [1,] 1 1 0 0 0 0 1 #&gt; [2,] 1 1 0 0 0 1 1 #&gt; [3,] 0 0 1 1 1 1 1 #&gt; [4,] 1 0 1 0 0 0 0 #&gt; [5,] 0 1 1 1 1 0 1 #&gt; [6,] 1 0 1 1 0 0 0 #&gt; #&gt; iterations [,23] [,24] [,25] [,26] [,27] [,28] [,29] #&gt; [1,] 0 1 1 0 1 0 1 #&gt; [2,] 1 1 0 1 0 0 1 #&gt; [3,] 1 1 1 0 1 0 1 #&gt; [4,] 1 0 1 1 0 1 0 #&gt; [5,] 0 1 1 1 1 1 1 #&gt; [6,] 1 0 1 1 1 0 1 #&gt; #&gt; iterations [,30] #&gt; [1,] 1 #&gt; [2,] 1 #&gt; [3,] 1 #&gt; [4,] 1 #&gt; [5,] 0 #&gt; [6,] 1 Dato che il codice Stan definisce un modello per i dati grezzi (ovvero, per ciascuna singola prova Bernoulliana del campione), ogni riga di y_bern include 30 colonne, ciascuna delle quali corrisponde ad un campione (\\(n\\) = 16000 in questa simulazione) di possibili valori futuri \\(y_i \\in \\{0, 1\\}\\). Per ottenere una stima della distribuzione predittiva a posteriori p(y_rep), ovvero, una stima della probabilità associata a ciascuno dei possibili numeri di “successi” in \\(N = 30\\) nuove prove future, è sufficiente calcolare la proporzione di valori 1 in ciascuna riga: tibble(y_rep = rowSums(y_bern)) %&gt;% ggplot(aes(x = y_rep, after_stat(density))) + geom_histogram(binwidth = 1) "],["posterior-predictive-checks.html", "13.3 Posterior predictive checks", " 13.3 Posterior predictive checks La distribuzione predittiva a posteriori viene utilizzata per eseguire i cosiddetti controlli predittivi a posteriori (Posterior Predictive Checks, PPC). Ricordiamo che la distribuzione predittiva a posteriori corrisponde alla simulazione di un campione di dati generati utilizzando le proprietà del modello adattato. Nei PPC si realizza un confronto grafico tra \\(p(y^{rep} \\mid y)\\) e i dati osservati \\(y\\). Confrontando visivamente gli aspetti chiave dei dati previsti futuri \\(y^{rep}\\) e dei dati osservati \\(y\\) possiamo determinare se il modello è adeguato. Oltre al confronto tra le distribuzioni \\(p(y)\\) e \\(p(y^{rep})\\) è anche possibile un confronto tra la distribuzione di varie statistiche descrittive, i cui valori sono calcolati su diversi campioni \\(y^{rep}\\), e le corrispondenti statistiche descrittive calcolate sui dati osservati. Vengono solitamente considerate statistiche descrittive quali la media, la varianza, la deviazione standard, il minimo o il massimo. Ma confronti di questo tipo sono possibili per qualunque statistica descrittiva. Questi confronti sono chiamati PPC. Esercizio 13.3 Esaminiamo ora un set di dati che non seguono la distribuzione normale (Gelman, Hill, and Vehtari 2020). I dati corrispondono ad una serie di misurazioni prese da Simon Newcomb nel 1882 come parte di un esperimento per stimare la velocità della luce. A questi dati verrà (inappropriatamente) adattata una distribuzione normale. L’obiettivo dell’esempio è quello di mostrare come i PPC possono rivelare la mancanza di adattamento di un modello ai dati. I PPC mostrano che il modo più semplice per verificare l’adattamento del modello è quello di visualizzare \\(y^{rep}\\) insieme ai dati effettivi. Iniziamo a caricare i dati: library(&quot;MASS&quot;) data(&quot;newcomb&quot;) Visualizziamo la distribuzione dei dati con un istogramma: tibble(newcomb) %&gt;% ggplot(aes(x = newcomb, after_stat(density))) + geom_histogram(binwidth = 1) Creiamo un oggetto di tipo list dove inserire i dati: data_list &lt;- list( y = newcomb, N = length(newcomb) ) Il codice Stan per il modello normale è il seguente: modelString &lt;- &quot; data { int&lt;lower=0&gt; N; vector[N] y; } parameters { real mu; real&lt;lower=0&gt; sigma; } model { mu ~ normal(25, 10); sigma ~ cauchy(0, 10); y ~ normal(mu, sigma); } generated quantities { vector[N] y_rep; for (n in 1:N) { y_rep[n] = normal_rng(mu, sigma); } } &quot; writeLines(modelString, con = &quot;code/newcomb.stan&quot;) Adattando il modello ai dati file &lt;- file.path(&quot;code&quot;, &quot;newcomb.stan&quot;) mod &lt;- cmdstan_model(file) fit &lt;- mod$sample( data = data_list, iter_sampling = 4000L, iter_warmup = 2000L, seed = SEED, chains = 4L, cores = 4L, refresh = 0, thin = 1 ) otteniamo le seguenti stime dei parametri \\(\\mu\\) e \\(\\sigma\\): fit$summary(c(&quot;mu&quot;, &quot;sigma&quot;)) #&gt; # A tibble: 2 × 10 #&gt; variable mean median sd mad q5 q95 rhat #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 mu 26.2 26.2 1.33 1.30 24.0 28.4 1.00 #&gt; 2 sigma 10.9 10.8 0.958 0.943 9.40 12.5 1.00 #&gt; # … with 2 more variables: ess_bulk &lt;dbl&gt;, #&gt; # ess_tail &lt;dbl&gt; Trasformiamo fit in un oggetto stanfit: stanfit &lt;- rstan::read_stan_csv(fit$output_files()) La distribuzione a posteriori di \\(\\mu\\) è mu_draws &lt;- as.matrix(stanfit, pars = &quot;mu&quot;) mcmc_areas(mu_draws, prob = 0.95) # color 95% interval Confrontiamo \\(\\mu\\) con la media di \\(y\\): mean(newcomb) #&gt; [1] 26.21 Anche se trova la media giusta, il modello non è comunque adeguato a prevedere le altre proprietà della \\(y\\). Estraiamo \\(y^{rep}\\) dall’oggetto stanfit: y_rep &lt;- as.matrix(stanfit, pars = &quot;y_rep&quot;) dim(y_rep) #&gt; [1] 16000 66 I valori y_rep sono i dati della distribuzione predittiva a posteriori che sono stati simulati usando gli stessi valori \\(X\\) dei predittori utilizzati per adattare il modello. Il confronto tra l’istogramma della \\(y\\) e gli istogrammi di diversi campioni \\(y^{rep}\\) mostra una scarsa corrispondenza tra i due: ppc_hist(data_list$y, y_rep[1:8, ], binwidth = 1) Alla stessa conclusione si giunge tramite un confronto tra la funzione di densità empirica della \\(y\\) e quella di diversi campioni \\(y^{rep}\\): ppc_dens_overlay(data_list$y, y_rep[1:50, ]) Generiamo ora i PPC per la media e il minimo della distribuzione: ppc_stat_2d(data_list$y, y_rep, stat = c(&quot;mean&quot;, &quot;min&quot;)) Mentre la media viene riprodotta accuratamente dal modello (come abbiamo visto sopra), ciò non è vero per il minimo dela distribuzione. L’origine di questa mancanza di adattamento è il fatto che la distribuzione delle misurazioni della velocità della luce è asimmetrica negativa. Dato che ci sono poche osservazioni nella coda negativa della distribuzione, solo per fare un esempio, utilizzeremo ora un secondo modello che ipotizza una distribuzione \\(t\\) di Student: modelString = &quot; data { int&lt;lower=0&gt; N; vector[N] y; } parameters { real mu; real&lt;lower=0&gt; sigma; real&lt;lower=0&gt; nu; } model { mu ~ normal(25, 10); sigma ~ cauchy(0, 10); nu ~ cauchy(0, 10); y ~ student_t(nu, mu, sigma); } generated quantities { vector[N] y_rep; for (n in 1:N) { y_rep[n] = student_t_rng(nu, mu, sigma); } } &quot; writeLines(modelString, con = &quot;code/newcomb2.stan&quot;) Adattiamo questo secondo modello ai dati. file &lt;- file.path(&quot;code&quot;, &quot;newcomb2.stan&quot;) mod &lt;- cmdstan_model(file) fit &lt;- mod$sample( data = data_list, iter_sampling = 4000L, iter_warmup = 2000L, seed = SEED, chains = 4L, cores = 4L, parallel_chains = 2L, refresh = 0, thin = 1 ) #&gt; Running MCMC with 4 parallel chains... #&gt; #&gt; Chain 1 finished in 0.3 seconds. #&gt; Chain 3 finished in 0.3 seconds. #&gt; Chain 2 finished in 0.3 seconds. #&gt; Chain 4 finished in 0.3 seconds. #&gt; #&gt; All 4 chains finished successfully. #&gt; Mean chain execution time: 0.3 seconds. #&gt; Total execution time: 0.5 seconds. Per questo secondo modello il confronto tra la funzione di densità empirica della \\(y\\) e quella di diversi campioni \\(y^{rep}\\) risulta adeguato: stanfit &lt;- rstan::read_stan_csv(fit$output_files()) y_rep &lt;- as.matrix(stanfit, pars = &quot;y_rep&quot;) ppc_dens_overlay(data_list$y, y_rep[1:50, ]) Inoltre, anche la statistica “minimo della distribuzione” viene ben predetta dal modello. ppc_stat_2d(data_list$y, y_rep, stat = c(&quot;mean&quot;, &quot;min&quot;)) In conclusione, per le misurazioni della velocità della luce di Newcomb l’accuratezza predittiva del modello basato sulla distribuzione \\(t\\) di Student è chiaramente migliore di quella del modello normale. References "],["considerazioni-conclusive-7.html", "Considerazioni conclusive", " Considerazioni conclusive Questo capitolo presenta i controlli predittivi a posteriori. A questo proposito è necessario notare un punto importante: i controlli predittivi a posteriori, quando suggeriscono un buon adattamento del modello alle caratterische dei dati previsti futuri \\(y^{rep}\\), non forniscono necessariamente una forte evidenza della capacità del modello di generalizzarsi a nuovi campioni di dati. Una tale evidenza sulla generalizzabilità del modello può solo essere fornita da studi di holdout validation, ovvero da studi nei quali viene utilizzato un nuovo campione di dati. Se i PPC mostrano un cattivo adattamento del modello ai dati previsti futuri, però, questo controllo fornisce una forte evidenza di una errata specificazione del modello. "],["normal-normal-mod-stan.html", "Capitolo 14 Modello Normale-Normale ", " Capitolo 14 Modello Normale-Normale "],["distribuzione-normale-normale-con-varianza-nota.html", "14.1 Distribuzione Normale-Normale con varianza nota", " 14.1 Distribuzione Normale-Normale con varianza nota Per \\(\\sigma^2\\) nota, la v.c. gaussiana è distribuzione a priori coniugata della v.c. gaussiana. Siano \\(Y_1, \\dots, Y_n\\) \\(n\\) variabili casuali i.i.d. che seguono la distribuzione gaussiana: \\[ Y_1, \\dots, Y_n \\stackrel{iid}{\\sim} \\mathcal{N}(\\mu, \\sigma). \\] Si vuole stimare \\(\\mu\\) sulla base di \\(n\\) osservazioni \\(y_1, \\dots, y_n\\). Considereremo qui solamente il caso in cui \\(\\sigma^2\\) sia supposta perfettamente nota. Ricordiamo che la densità di una gaussiana è \\[ p(y_i \\mid \\mu, \\sigma) = \\frac{1}{{\\sigma \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(y_i - \\mu)^2}{2\\sigma^2}}\\right\\}. \\] Essendo le variabili i.i.d., possiamo scrivere la densità congiunta come il prodotto delle singole densità e quindi si ottiene \\[ p(y \\mid \\mu) = \\, \\prod_{i=1}^n p(y_i \\mid \\mu). \\] Una volta osservati i dati \\(y\\), la verosimiglianza diventa \\[\\begin{align} \\mathcal{L}(\\mu \\mid y) =&amp; \\, \\prod_{i=1}^n p(y_i \\mid \\mu) = \\notag\\\\ &amp; \\frac{1}{{\\sigma \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(y_1 - \\mu)^2}{2\\sigma^2}}\\right\\} \\times \\notag\\\\ &amp; \\frac{1}{{\\sigma \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(y_2 - \\mu)^2}{2\\sigma^2}}\\right\\} \\times \\notag\\\\ &amp; \\vdots \\notag\\\\ &amp; \\frac{1}{{\\sigma \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(y_n - \\mu)^2}{2\\sigma^2}}\\right\\}. \\end{align}\\] Se viene scelta una densità a priori gaussiana, ciò fa sì che anche la densità a posteriori sia gaussiana. Supponiamo che \\[\\begin{equation} p(\\mu) = \\frac{1}{{\\tau_0 \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(\\mu - \\mu_0)^2}{2\\tau_0^2}}\\right\\}, \\tag{14.1} \\end{equation}\\] ovvero che la distribuzione a priori di \\(\\mu\\) sia gaussiana con media \\(\\mu_0\\) e varianza \\(\\tau_0^2\\). Possiamo dire che \\(\\mu_0\\) rappresenta il valore ritenuto più probabile per \\(\\mu\\) e \\(\\tau_0^2\\) il grado di incertezza che abbiamo rispetto a tale valore. Svolgendo una serie di passaggi algebrici, si arriva a \\[\\begin{equation} p(\\mu \\mid y) = \\frac{1}{{\\tau_p \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(\\mu - \\mu_p)^2}{2\\tau_p^2}}\\right\\}, \\tag{14.2} \\end{equation}\\] dove \\[\\begin{equation} \\mu_p = \\frac{\\frac{1}{\\tau_0^2}\\mu_0+ \\frac{n}{\\sigma^2}\\bar{y}}{\\frac {1}{\\tau_0^2} + \\frac{n}{\\sigma^2}} \\tag{14.3} \\end{equation}\\] e \\[\\begin{equation} \\tau_p^2 = \\frac{1}{\\frac {1}{\\tau_0^2}+ \\frac{n}{\\sigma^2}}. \\tag{14.4} \\end{equation}\\] In altri termini, se la distribuzione a priori per \\(\\mu\\) è gaussiana, la distribuzione a posteriori è anch’essa gaussiana con valore atteso (a posteriori) \\(\\mu_p\\) e varianza (a posteriori) \\(\\tau_p^2\\) date dalle espressioni precedenti. In conclusione, il risultato trovato indica che: il valore atteso a posteriori è una media pesata fra il valore atteso a priori \\(\\mu_0\\) e la media campionaria \\(\\bar{y}\\); il peso della media campionaria è tanto maggiore tanto più è grande \\(n\\) (il numero di osservazioni) e \\(\\tau_0^2\\) (l’incertezza iniziale); l’incertezza (varianza) a posteriori \\(\\tau_p^2\\) è sempre più piccola dell’incertezza a priori \\(\\tau_0^2\\) e diminuisce al crescere di \\(n\\). "],["il-modello-normale-con-stan.html", "14.2 Il modello Normale con Stan", " 14.2 Il modello Normale con Stan Per esaminare un esempio pratico, consideriamo i 30 valori BDI-II dei soggetti clinici di Zetsche, Bürkner, and Renneberg (2019): df &lt;- data.frame( y = c( 26.0, 35.0, 30, 25, 44, 30, 33, 43, 22, 43, 24, 19, 39, 31, 25, 28, 35, 30, 26, 31, 41, 36, 26, 35, 33, 28, 27, 34, 27, 22 ) ) Calcoliamo le statistiche descrittive del campione di dati: df %&gt;% summarise( sample_mean = mean(y), sample_sd = sd(y) ) #&gt; sample_mean sample_sd #&gt; 1 30.93 6.607 Nella discussione seguente assumeremo che \\(\\mu\\) e \\(\\sigma\\) siano indipendenti. Assegneremo a \\(\\mu\\) una distribuzione a priori \\(\\mathcal{N}(25, 2)\\) e a \\(\\sigma\\) una distribuzione a priori \\(Cauchy(0, 3)\\). Il modello statistico diventa: \\[\\begin{align} Y_i &amp;\\sim \\mathcal{N}(\\mu, \\sigma) \\notag\\\\ \\mu &amp;\\sim \\mathcal{N}(\\mu_{\\mu} = 25, \\sigma_{\\mu} = 2) \\notag\\\\ \\sigma &amp;\\sim \\Cauchy(0, 3) \\notag \\end{align}\\] In base al modello definito, la variabile casuale \\(Y\\) segue la distribuzione Normale di parametri \\(\\mu\\) e \\(\\sigma\\). Il parametro \\(\\mu\\) è sconosciuto e abbiamo deciso di descrivere la nostra incertezza relativa ad esso mediante una distribuzione a priori Normale con media uguale a 25 e deviazione standard pari a 2. L’incertezza relativa a \\(\\sigma\\) è quantificata da una distribuzione a priori half-Cauchy(0, 5), come indicato nella figura seguente: data.frame(x = c(0, 20)) %&gt;% ggplot(aes(x)) + stat_function( fun = dcauchy, n = 1e3, args = list(location = 0, scale = 3) ) + ylab(&quot;P(x)&quot;) + theme(legend.position = &quot;none&quot;) Dato che il modello è Normale-Normale, è possibile una soluzione analitica, come descritto in precedenza per il caso in cui \\(\\sigma\\) è noto. In tali condizioni, la distribuzione a posteriori per \\(\\mu\\) può essere trovata con la funzione bayesrules:::summarize_normal_normal(): bayesrules:::summarize_normal_normal( mean = 25, sd = 2, sigma = sd(df$y), y_bar = mean(df$y), n = 30 ) #&gt; model mean mode var sd #&gt; 1 prior 25.00 25.00 4.000 2.000 #&gt; 2 posterior 29.35 29.35 1.067 1.033 La rappresentazione grafica della funzione a priori, della verosimiglianza e della distribuzione a posteriori per \\(\\mu\\) è fornita da: bayesrules:::plot_normal_normal( mean = 25, sd = 2, sigma = sd(df$y), y_bar = mean(df$y), n = 30 ) La procedura MCMC utilizzata da Stan è basata su un campionamento Monte Carlo Hamiltoniano che non richiede l’uso di distribuzioni a priori coniugate. Pertanto per i parametri è possibile scegliere una qualunque distribuzione a priori arbitraria. Per continuare con l’esempio, poniamoci il problema di trovare le distribuzioni a posteriori dei parametri \\(\\mu\\) e \\(\\sigma\\) usando le funzioni del pacchetto cmdstanr. Il modello statistico descritto sopra si può scrivere in Stan nel modo seguente: modelString = &quot; data { int&lt;lower=0&gt; N; vector[N] y; } parameters { real mu; real&lt;lower=0&gt; sigma; } model { mu ~ normal(25, 2); sigma ~ cauchy(0, 3); y ~ normal(mu, sigma); } &quot; writeLines(modelString, con = &quot;code/normalmodel.stan&quot;) Si noti che, nel modello, il parametro \\(\\sigma\\) è considerato incognito. Sistemiamo i dati nel formato appropriato per potere essere letti da Stan: data_list &lt;- list( N = length(df$y), y = df$y ) Leggiamo il file in cui abbiamo salvato il codice Stan file &lt;- file.path(&quot;code&quot;, &quot;normalmodel.stan&quot;) compiliamo il modello mod &lt;- cmdstan_model(file) ed eseguiamo il campionamento MCMC: fit &lt;- mod$sample( data = data_list, iter_sampling = 4000L, iter_warmup = 2000L, seed = SEED, chains = 4L, parallel_chains = 2L, refresh = 0, thin = 1 ) Le stime a posteriori dei parametri si ottengono con: fit$summary(c(&quot;mu&quot;, &quot;sigma&quot;)) #&gt; # A tibble: 2 × 10 #&gt; variable mean median sd mad q5 q95 rhat #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 mu 29.3 29.3 1.11 1.10 27.4 31.0 1.00 #&gt; 2 sigma 6.89 6.78 0.959 0.910 5.52 8.63 1.00 #&gt; # … with 2 more variables: ess_bulk &lt;dbl&gt;, #&gt; # ess_tail &lt;dbl&gt; oppure, dopo avere trasformato l’oggetto fit nel formato stanfit, stanfit &lt;- rstan::read_stan_csv(fit$output_files()) con out &lt;- rstantools::posterior_interval(as.matrix(stanfit), prob = 0.95) out #&gt; 2.5% 97.5% #&gt; mu 26.990 31.349 #&gt; sigma 5.321 9.079 #&gt; lp__ -77.914 -74.276 Possiamo dunque concludere, con un grado di certezza soggettiva del 95%, che siamo sicuri che la media della popolazione da cui abbiamo tratto i dati è compresa nell’intervallo [26.99, 31.35]. References "],["il-modello-normale-con-quap.html", "14.3 Il modello normale con quap()", " 14.3 Il modello normale con quap() Ripetiamo l’analisi precedente usando le funzioni del pacchetto rethinking per trovare le distribuzioni a posteriori dei parametri \\(\\mu\\) e \\(\\sigma\\). Definiamo il modello statistico mediante la funzione alist(): flist &lt;- alist( y ~ dnorm(mu, sigma), mu ~ dnorm(25, 2), sigma ~ dcauchy(0, 3) ) Le precedenti istruzioni R specificano una variabile casuale \\(Y\\) che si distribuisce come una Normale di parametri \\(\\mu\\) e \\(\\sigma\\); questa è la verosimiglianza. La distribuzione a priori del parametro \\(\\mu\\) è una Normale di media 25 e deviazione standard 2. La distribuzione a priori del parametro \\(\\sigma\\) è una half-Cauchy di parametri location = 0 e scale = 3. Usiamo la funzione quap() per ottenere l’approssimazione quadratica delle distribuzioni a posteriori di \\(\\mu\\) e \\(\\sigma\\): set.seed(123) m &lt;- quap( flist, data = df ) L’intervallo di credibilità al 95% è dato dalla funzione precis(): out &lt;- precis(m, prob = 0.95) out #&gt; mean sd 2.5% 97.5% #&gt; mu 29.388 1.0633 27.30 31.472 #&gt; sigma 6.501 0.8473 4.84 8.162 I risultati sono simili a quelli trovati in precedenza. "],["il-modello-normale-con-brmsbrm.html", "14.4 Il modello normale con brms::brm()", " 14.4 Il modello normale con brms::brm() Stimiamo ora la distribuzione a posteriori di \\(\\mu\\) usando la funzione brms::brm(). In questo caso non è necessario scrivere il modello in forma esplicita, come abbiamo fatto usando linguaggio Stan. La sintassi specifiata di seguito viene trasformata in maniera automatica nel linguaggio Stan prima di adattare il modello ai dati: fit3 &lt;- brm( data = df, family = gaussian(), y ~ 1, prior = c( prior(normal(25, 2), class = Intercept), prior(cauchy(0, 3), class = sigma) ), iter = 4000, refresh = 0, chains = 4, backend = &quot;cmdstanr&quot; ) #&gt; Running MCMC with 4 chains, at most 8 in parallel... #&gt; #&gt; Chain 1 finished in 0.1 seconds. #&gt; Chain 2 finished in 0.1 seconds. #&gt; Chain 3 finished in 0.1 seconds. #&gt; Chain 4 finished in 0.1 seconds. #&gt; #&gt; All 4 chains finished successfully. #&gt; Mean chain execution time: 0.1 seconds. #&gt; Total execution time: 0.2 seconds. I trace-plot si ottengono con l’istruzione seguente: plot(fit3) Le stime della distribuzione a posteriori si ottengono con la funzione summary(): summary(fit3) #&gt; Family: gaussian #&gt; Links: mu = identity; sigma = identity #&gt; Formula: y ~ 1 #&gt; Data: df (Number of observations: 30) #&gt; Draws: 4 chains, each with iter = 2000; warmup = 0; thin = 1; #&gt; total post-warmup draws = 8000 #&gt; #&gt; Population-Level Effects: #&gt; Estimate Est.Error l-95% CI u-95% CI Rhat #&gt; Intercept 29.26 1.09 27.08 31.34 1.00 #&gt; Bulk_ESS Tail_ESS #&gt; Intercept 4559 4987 #&gt; #&gt; Family Specific Parameters: #&gt; Estimate Est.Error l-95% CI u-95% CI Rhat #&gt; sigma 6.88 0.94 5.27 9.01 1.00 #&gt; Bulk_ESS Tail_ESS #&gt; sigma 4366 4638 #&gt; #&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS #&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential #&gt; scale reduction factor on split chains (at convergence, Rhat = 1). Nuovamente, i risultati sono molto simili a quelli ottenuti in precedenza. "],["considerazioni-conclusive-8.html", "Considerazioni conclusive", " Considerazioni conclusive Questo esempio ci mostra come calcolare l’intervallo di credibilità per la media di una v.c. Normale. La domanda più ovvia di analisi dei dati, dopo avere visto come creare l’intervallo di credibilità per la media di un gruppo, riguarda il confronto tra le medie di due gruppi. Questo però è un caso speciale di una tecnica di analisi dei dati più generale, chiamate analisi di regressione lineare. Prima di discutere il problema del confronto tra le medie di due gruppi è dunque necessario esaminare il modello statistico di regressione lineare. "],["regr-models-intro.html", "Capitolo 15 Introduzione al modello lineare", " Capitolo 15 Introduzione al modello lineare Lo scopo della ricerca è trovare le associazioni tra le variabili e fare confronti fra le condizioni sperimentali. Nel caso della psicologia, il ricercatore vuole scoprire le leggi generali che descrivono le relazioni tra i costrutti psicologici e le relazioni che intercorrono tra i fenomeni psicologici e quelli non psicologici (sociali, economici, storici, …). Abbiamo già visto come la correlazione di Pearson sia uno strumento adatto a questo scopo. Infatti, essa ci informa sulla direzione e sull’intensità della relazione lineare tra due variabili. Tuttavia, la correlazione non è sufficiente, in quanto il ricercatore ha a disposizione solo i dati di un campione, mentre vorrebbe descrivere la relazione tra le variabili nella popolazione. A causa della variabilità campionaria, le proprietà dei campioni sono necessariamente diverse da quelle della popolazione: ciò che si può osservare nella popolazione potrebbe non emergere nel campione e, al contrario, il campione manifesta caratteristiche che non sono necessariamente presenti nella popolazione. È dunque necessario chiarire, dal punto di vista statistico, il legame che intercorre tra le proprietà del campione e le proprietà della popolazione da cui esso è stato estratto. Il modello lineare utilizza la funzione matematica più semplice per descrivere la relazione fra due variabili, ovvero la funzione lineare. In questo Capitolo vedremo come si possa fare inferenza sulla relazione tra due variabili mediante il modello lineare bayesiano. Inizieremo a descrivere le proprietà geometriche della funzione lineare per poi utilizzare questa semplice funzione per costruire un modello statistico secondo un approccio bayesiano. "],["la-funzione-lineare.html", "15.1 La funzione lineare", " 15.1 La funzione lineare Iniziamo con un ripasso sulla funzione di lineare. Si chiama funzione lineare una funzione del tipo \\[\\begin{equation} f(x) = a + b x, \\end{equation}\\] dove \\(a\\) e \\(b\\) sono delle costanti. Il grafico di tale funzione è una retta di cui il parametro \\(b\\) è detto coefficiente angolare e il parametro \\(a\\) è detto intercetta con l’asse delle \\(y\\) [infatti, la retta interseca l’asse \\(y\\) nel punto \\((0,a)\\), se \\(b \\neq 0\\)]. Per assegnare un’interpretazione geometrica alle costanti \\(a\\) e \\(b\\) si consideri la funzione \\[\\begin{equation} y = b x. \\end{equation}\\] Tale funzione rappresenta un caso particolare, ovvero quello della proporzionalità diretta tra \\(x\\) e \\(y\\). Il caso generale della linearità \\[\\begin{equation} y = a + b x \\end{equation}\\] non fa altro che sommare una costante \\(a\\) a ciascuno dei valori \\(y = b x\\). Nella funzione lineare \\(y = a + b x\\), se \\(b\\) è positivo allora \\(y\\) aumenta al crescere di \\(x\\); se \\(b\\) è negativo allora \\(y\\) diminuisce al crescere di \\(x\\); se \\(b=0\\) la retta è orizzontale, ovvero \\(y\\) non muta al variare di \\(x\\). Consideriamo ora il coefficiente \\(b\\). Si consideri un punto \\(x_0\\) e un incremento arbitrario \\(\\varepsilon\\) come indicato nella figura 15.1. Le differenze \\(\\Delta x = (x_0 + \\varepsilon) - x_0\\) e \\(\\Delta y = f(x_0 + \\varepsilon) - f(x_0)\\) sono detti incrementi di \\(x\\) e \\(y\\). Il coefficiente angolare \\(b\\) è uguale al rapporto \\[\\begin{equation} b = \\frac{\\Delta y}{\\Delta x} = \\frac{f(x_0 + \\varepsilon) - f(x_0)}{(x_0 + \\varepsilon) - x_0}, \\end{equation}\\] indipendentemente dalla grandezza degli incrementi \\(\\Delta x\\) e \\(\\Delta y\\). Il modo più semplice per assegnare un’interpretazione geometrica al coefficiente angolare (o pendenza) della retta è dunque quello di porre \\(\\Delta x = 1\\). In tali circostanze infatti \\(b = \\Delta y\\). FIGURA 15.1: La funzione lineare \\(y = a + bx\\). "],["lerrore-di-misurazione.html", "15.2 L’errore di misurazione", " 15.2 L’errore di misurazione Per descrivere l’associazione tra due variabili, tuttavia, la funzione lineare non è sufficiente. Nel mondo empirico, infatti, la relazione tra variabili non è mai perfettamente lineare. È dunque necessario includere nel modello lineare anche una componente d’errore, ovvero una componente della \\(y\\) che non può essere spiegata dal modello lineare. Nel caso di due sole variabili, questo ci conduce alla seguente formulazione del modello lineare: \\[\\begin{equation} y = \\alpha + \\beta x + \\varepsilon, \\tag{15.1} \\end{equation}\\] laddove i parametri \\(\\alpha\\) e \\(\\beta\\) descrivono l’associazione tra le variabili casuali \\(y\\) e \\(x\\), e il termine d’errore \\(\\varepsilon\\) specifica quant’è grande la porzione della variabile \\(y\\) che non può essere predetta nei termini di una relazione lineare con la \\(x\\). Si noti che la (15.1) consente di formulare una predizione, nei termini di un modello lineare, del valore atteso della \\(y\\) conoscendo \\(x\\), ovvero \\[\\begin{equation} \\hat{y} = \\mathbb{E}(y \\mid x) = \\alpha + \\beta x. \\tag{15.2} \\end{equation}\\] In altri termini, se i parametri del modello (\\(\\alpha\\) e \\(\\beta\\)) sono noti, allora è possibile predire la \\(y\\) sulla base della nostra conoscenza della \\(x\\). Per esempio, se conosciamo la relazione lineare tra quoziente di intelligenza ed aspettativa di vita, allora possiamo prevedere quanto a lungo vivrà una persona sulla base del suo QI. Sì, c’è una relazione lineare tra intelligenza e aspettativa di vita (Hambrick 2015)! Ma quando è accurata la previsione? Ciò dipende dal termine d’errore della (15.1). Il modello lineare fornisce un metodo per rispondere a domande di questo tipo20. References "],["una-media-per-ciascuna-osservazione.html", "15.3 Una media per ciascuna osservazione", " 15.3 Una media per ciascuna osservazione In precedenza abbiamo visto come sia possibile stimare i parametri di un modello bayesiano Normale nel quale le osservazioni sono indipendenti e identicamente distribuite secondo una densità Normale, \\[\\begin{equation} Y_i \\stackrel{i.i.d.}{\\sim} \\mathcal{N}(\\mu, \\sigma), \\quad i = 1, \\dots, n. \\tag{15.3} \\end{equation}\\] Il modello (15.3) assume che ogni \\(Y_i\\) sia una realizzazione della stessa \\(\\mathcal{N}(\\mu, \\sigma^2)\\). Da un punto di vista bayesiano21, si assegnano distribuzioni a priori ai parametri \\(\\mu\\) e \\(\\sigma\\), si genera la verosimiglianza in base ai dati osservati e, con queste informazioni, si generano le distribuzione a posteriori dei parametri (Gelman, Hill, and Vehtari 2020): \\[\\begin{align} Y_i \\mid \\mu, \\sigma &amp; \\stackrel{iid}{\\sim} \\mathcal{N}(\\mu, \\sigma^2)\\notag\\\\ \\mu &amp; \\sim \\mathcal{N}(\\mu_0, \\tau^2) \\notag\\\\ \\sigma &amp; \\sim \\Cauchy(x_0, \\gamma) \\notag \\end{align}\\] È comune però che vengano però registrate altre variabili \\(x_i\\) che possono essere associate alla risposta di interesse \\(y_i\\). La variabile \\(x_i\\) viene chiamata predittore (o variabile indipendente) in quanto il ricercatore è tipicamente interessato a predire il valore \\(y_i\\) a partire da \\(x_i\\). Come si può estende il modello Normale della (15.3) per lo studio della possibile relazione tra \\(y_i\\) e \\(x_i\\)? Il modello (15.3) assume una media \\(\\mu\\) comune per ciascuna osservazione \\(Y_i\\). Dal momento che desideriamo introdurre una nuova variabile \\(x_i\\) che assume un valore specifico per ciascuna osservazione \\(y_i\\), il modello (15.3) può essere modificato in modo che la media comune \\(\\mu\\) venga sostituita da una media \\(\\mu_i\\) specifica a ciascuna \\(i\\)-esima osservazione: \\[\\begin{equation} Y_i \\mid \\mu_i, \\sigma \\stackrel{ind}{\\sim} \\mathcal{N}(\\mu_i, \\sigma), \\quad i = 1, \\dots, n. \\tag{15.4} \\end{equation}\\] Si noti che le osservazioni \\(Y_1, \\dots, Y_n\\) non sono più identicamente distribuite poiché hanno medie diverse, ma sono ancora indipendenti come indicato dalla notazione ind posta sopra il simbolo \\(\\sim\\) nella (15.4) 15.3.1 Relazione lineare tra la media \\(y \\mid x\\) e il predittore L’approccio che consente di mettere in relazione un predittore \\(x_i\\) con la risposta \\(Y_i\\) è quello di assumere che la media di ciascuna \\(Y_i\\), ovvero \\(\\mu_i\\), sia una funzione lineare del predittore \\(x_i\\). Una tale relazione lineare è scritta come \\[\\begin{equation} \\mu_i = \\beta_0 + \\beta_ 1 x_i, \\quad i = 1, \\dots, n. \\tag{15.5} \\end{equation}\\] Nella (15.5), ciascuna \\(x_i\\) è una costante nota (ecco perché viene usata una lettera minuscola per la \\(x\\)) e \\(\\beta_0\\) e \\(\\beta_ 1\\) sono parametri incogniti. Questi parametri che rappresentano l’intercetta e la pendenza della retta di regressione sono variabili casuali. Si assegna una distribuzione a priori a \\(\\beta_0\\) e a \\(\\beta_ 1\\) e si esegue l’inferenza riassumendo la distribuzione a posteriori di questi parametri. In questo modello, la funzione lineare \\(\\beta_0 + \\beta_ 1 x_i\\) è interpretata come il valore atteso della \\(Y_i\\) per ciascun valore \\(x_i\\), mentre l’intercetta \\(\\beta_0\\) rappresenta il valore atteso della \\(Y_i\\) quando \\(x_i = 0\\). Il parametro \\(\\beta_ 1\\) (pendenza) rappresenta invece l’aumento medio della \\(Y_i\\) quando \\(x_i\\) aumenta di un’unità. È importante notare che la relazione lineare (15.4) di parametri \\(\\beta_0\\) e \\(\\beta_ 1\\) descrive l’associazione tra la media \\(\\mu_i\\) e il predittore \\(x_i\\). In altri termini, tale relazione lineare ci fornisce una predizione sul valore medio \\(\\mu_i\\), non sul valore effettivo \\(Y_i\\). 15.3.2 Il modello lineare Sostituendo la (15.5) nella (15.4) otteniamo il modello lineare: \\[\\begin{equation} Y_i \\mid \\beta_0, \\beta_ 1, \\sigma \\stackrel{ind}{\\sim} \\mathcal{N}(\\beta_0 + \\beta_ 1 x_i, \\sigma), \\quad i = 1, \\dots, n. \\tag{15.6} \\end{equation}\\] Questo è un caso speciale del modello di campionamento Normale, dove le \\(Y_i\\) seguono indipendentemente una densità Normale con una media (\\(\\beta_0 + \\beta_ 1 x_i\\)) specifica per ciascuna osservazione e con una deviazione standard (\\(\\sigma\\)) comune a tutte le osservazioni. Poiché include un solo predittore (\\(x\\)), questo modello è comunemente chiamato modello di regressione lineare semplice. In maniera equivalente, il modello (15.6) può essere formulato come \\[\\begin{equation} Y_i = \\mu_i + \\varepsilon_i, \\quad i = 1, \\dots, n, \\tag{15.7} \\end{equation}\\] dove la risposta media è \\(\\mu_i = \\beta_0 + \\beta_ 1 x_i\\) e i residui \\(\\varepsilon_1, \\dots, \\varepsilon_n\\) sono i.i.d. da una Normale con media 0 e deviazione standard \\(\\sigma\\). Nel modello lineare, l’osservazione \\(Y_i\\) è una variabile casuale, il predittore \\(x_i\\) è una costante fissa, e \\(\\beta_0\\), \\(\\beta_1\\) e \\(\\sigma\\) sono parametri incogniti. Utilizzando il paradigma bayesiano, viene assegnata una distribuzione a priori congiunta a \\((\\beta_0, \\beta_1, \\sigma)\\). Dopo avere osservato le risposte \\(Y_i, i = 1, \\dots, n\\), l’inferenza procede stimando la distribuzione a posteriori dei parametri. Remark. Nella costruzione di un modello di regressione bayesiano, è importante iniziare dalle basi e procedere un passo alla volta. Sia \\(Y\\) una variabile di risposta e sia \\(x\\) un predittore o un insieme di predittori. È possibile costruire un modello di regressione di \\(Y\\) su \\(x\\) applicando i seguenti principi generali: Stabilire se \\(Y\\) è discreto o continuo. Di conseguenza, identificare l’appropriata struttura dei dati (per esempio, Normale, di Poisson, o Binomiale). Esprimere la media di \\(Y\\) come funzione dei predittori \\(x\\) (per esempio, \\(\\mu = \\beta_0 + \\beta_1 x\\)). Identificare tutti i parametri incogniti del modello (per esempio, \\(\\mu, \\beta_1, \\beta_2\\)). Valutare quali valori che ciascuno di questi parametri potrebbe assumere. Di conseguenza, identificare le distribuzioni a priori appropriate per questi parametri. Nel caso di una variabile \\(Y\\) continua che segue la legge gaussiana e un solo predittore, ad esempio, il modello diventa: \\[\\begin{align} Y_i \\mid \\beta_0, \\beta_1, \\sigma &amp;\\stackrel{ind}{\\sim} \\mathcal{N}\\left(\\mu_i, \\sigma^2\\right) \\;\\; \\text{ con } \\;\\; \\mu_i = \\beta_0 + \\beta_1 x_i \\notag\\\\ \\beta_0 &amp;\\sim \\mathcal{N}\\left(\\mu_0, \\sigma_0^2 \\right) \\notag\\\\ \\beta_1 &amp; \\sim \\mathcal{N}\\left(\\mu_1, \\sigma_1^2 \\right) \\notag\\\\ \\sigma &amp; \\sim \\text{Cauchy}(x_0, \\gamma) \\; .\\notag \\end{align}\\] Un algoritmo MCMC viene usato per simulare i campioni dalle distribuzioni a posteriori e, mediante tali campioni, si fanno inferenze sulla risposta attesa \\(\\beta_0 + \\beta_1 x\\) per ciascuno specifico valore del predittore \\(x\\). Inoltre, è possibile valutare le dimensioni degli errori di previsione mediante un indice sintetico della densità a posteriori della deviazione standard \\(\\sigma\\). References "],["considerazioni-conclusive-9.html", "Considerazioni conclusive", " Considerazioni conclusive Il modello lineare semplice viene usato per descrivere la relazione tra due variabili e per determinare il segno e l’intensità di tale relazione. Inoltre, il modello lineare ci consente di prevedere il valore della variabile dipendente in base ai valori della variabile indipendente. Il modello lineare semplice è in realtà molto limitato, in quanto descrive soltanto la relazione tra la variabile dipendente \\(y\\) e una sola variabile esplicativa \\(x\\). Esso diventa molto più utile quando incorpora più variabili indipendenti. In questo secondo caso, però, i calcoli per la stima dei coefficienti del modello diventano più complicati. Abbiamo deciso di iniziare considerando il modello lineare semplice perché, in questo caso, sia la logica dell’inferenza sia le procedure di calcolo sono facilmente maneggiabili. Nel caso più generale, quello del modello lineare multiplo (ovvero, con più di un predittore), la logica dell’inferenza rimane identica a quella discussa qui, ma le procedure di calcolo richiedono l’uso dell’algebra matriciale. Il modello lineare multiplo può includere sia regressori quantitativi, sia regressori qualitativi, utilizzando un opportuno schema di codifica. È interessante notare come un modello lineare multiplo che include una sola variabile esplicativa qualitativa corrisponde all’analisi della varianza ad una via; un modello lineare multiplo che include più di una variabile esplicativa qualitativa corrisponde all’analisi della varianza più vie. Possiamo qui concludere dicendo che il modello lineare, nelle sue varie forme e varianti, costituisce la tecnica di analisi dei dati maggiormente usata in psicologia. "],["simbologia-di-base.html", "Appendice A Simbologia di base", " Appendice A Simbologia di base Per una scrittura più sintetica possono essere utilizzati alcuni simboli matematici. \\(\\log(x)\\): il logaritmo naturale di \\(x\\). L’operatore logico booleano \\(\\land\\) significa “e” (congiunzione forte) mentre il connettivo di disgiunzione \\(\\lor\\) significa “o” (oppure) (congiunzione debole). Il quantificatore esistenziale \\(\\exists\\) vuol dire “esiste almeno un” e indica l’esistenza di almeno una istanza del concetto/oggetto indicato. Il quantificatore esistenziale di unicità \\(\\exists!\\) (“esiste soltanto un”) indica l’esistenza di esattamente una istanza del concetto/oggetto indicato. Il quantificatore esistenziale \\(\\nexists\\) nega l’esistenza del concetto/oggetto indicato. Il quantificatore universale \\(\\forall\\) vuol dire “per ogni.” \\(\\mathcal{A, S}\\): insiemi. \\(x \\in A\\): \\(x\\) è un elemento dell’insieme \\(A\\). L’implicazione logica “\\(\\Rightarrow\\)” significa “implica” (se …allora). \\(P \\Rightarrow Q\\) vuol dire che \\(P\\) è condizione sufficiente per la verità di \\(Q\\) e che \\(Q\\) è condizione necessaria per la verità di \\(P\\). L’equivalenza matematica “\\(\\iff\\)” significa “se e solo se” e indica una condizione necessaria e sufficiente, o corrispondenza biunivoca. Il simbolo \\(\\vert\\) si legge “tale che.” Il simbolo \\(\\triangleq\\) (o \\(:=\\)) si legge “uguale per definizione.” Il simbolo \\(\\Delta\\) indica la differenza fra due valori della variabile scritta a destra del simbolo. Il simbolo \\(\\propto\\) si legge “proporzionale a.” Il simbolo \\(\\approx\\) si legge “circa.” Il simbolo \\(\\in\\) della teoria degli insiemi vuol dire “appartiene” e indica l’appartenenza di un elemento ad un insieme. Il simbolo \\(\\notin\\) vuol dire “non appartiene.” Il simbolo \\(\\subseteq\\) si legge “è un sottoinsieme di” (può coincidere con l’insieme stesso). Il simbolo \\(\\subset\\) si legge “è un sottoinsieme proprio di.” Il simbolo \\(\\#\\) indica la cardinalità di un insieme. Il simbolo \\(\\cap\\) indica l’intersezione di due insiemi. Il simbolo \\(\\cup\\) indica l’unione di due insiemi. Il simbolo \\(\\emptyset\\) indica l’insieme vuoto o evento impossibile. In matematica, \\(\\mbox{argmax}\\) identifica l’insieme dei punti per i quali una data funzione raggiunge il suo massimo. In altre parole, \\(\\mbox{argmax}_x f(x)\\) è l’insieme dei valori di \\(x\\) per i quali \\(f(x)\\) raggiunge il valore più alto. \\(a, c, \\alpha, \\gamma\\): scalari. \\(\\boldsymbol{x}, \\boldsymbol{y}\\): vettori. \\(\\boldsymbol{X}, \\boldsymbol{Y}\\): matrici. \\(X \\sim p\\): la variabile casuale \\(X\\) si distribuisce come \\(p\\). \\(p(\\cdot)\\): distribuzione di massa o di densità di probabilità. \\(p(y \\mid \\boldsymbol{x})\\): la probabilità o densità di \\(y\\) dato \\(\\boldsymbol{x}\\), ovvero \\(p(y = \\boldsymbol{Y} \\mid x = \\boldsymbol{X})\\). \\(f(x)\\): una funzione arbitraria di \\(x\\). \\(f(\\boldsymbol{X}; \\theta, \\gamma)\\): \\(f\\) è una funzione di \\(\\boldsymbol{X}\\) con parametri \\(\\theta, \\gamma\\). Questa notazione indica che \\(\\boldsymbol{X}\\) sono i dati che vengono passati ad un modello di parametri \\(\\theta, \\gamma\\). \\(\\mathcal{N}(\\mu, \\sigma^2)\\): distribuzione gaussiana di media \\(\\mu\\) e varianza \\(sigma^2\\). \\(\\mbox{Beta}(\\alpha, \\beta)\\): distribuzione Beta di parametri \\(\\alpha\\) e \\(\\beta\\). \\(\\mathcal{U}(a, b)\\): distribuzione uniforme con limite inferiore \\(a\\) e limite superiore \\(b\\). \\(\\mbox{Cauchy}(\\alpha, \\beta)\\): distribuzione di Cauchy di parametri \\(\\alpha\\) (posizione: media) e \\(\\beta\\) (scala: radice quadrata della varianza). \\(\\mathcal{B}(p)\\): distribuzione di Bernoulli di parametro \\(p\\) (probabilità di successo). \\(\\mbox{Bin}(n, p)\\): distribuzione binomiale di parametri \\(n\\) (numero di prove) e \\(p\\) (probabilità di successo). \\(\\mathbb{KL} (p \\mid\\mid q)\\): la divergenza di Kullback-Leibler da \\(p\\) a \\(q\\). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
