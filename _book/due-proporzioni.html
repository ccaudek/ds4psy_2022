<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 Due proporzioni | Data Science per psicologi</title>
  <meta name="description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 Due proporzioni | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="github-repo" content="ccaudek/ds4psy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 Due proporzioni | Data Science per psicologi" />
  
  <meta name="twitter:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2022-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="la-critica-di-hulme_2020.html"/>
<link rel="next" href="commenti-e-considerazioni-finali-1.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> mainfont: “Palatino nova W1G”</a>
<ul>
<li class="chapter" data-level="" data-path="la-psicologia-e-la-data-science.html"><a href="la-psicologia-e-la-data-science.html"><i class="fa fa-check"></i>La psicologia e la Data science</a></li>
<li class="chapter" data-level="" data-path="come-studiare.html"><a href="come-studiare.html"><i class="fa fa-check"></i>Come studiare</a></li>
<li class="chapter" data-level="" data-path="sviluppare-un-metodo-di-studio-efficace.html"><a href="sviluppare-un-metodo-di-studio-efficace.html"><i class="fa fa-check"></i>Sviluppare un metodo di studio efficace</a></li>
</ul></li>
<li class="part"><span><b>I Inferenza bayesiana</b></span></li>
<li class="chapter" data-level="2" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html"><i class="fa fa-check"></i><b>2</b> Flusso di lavoro bayesiano</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modellizzazione-bayesiana.html"><a href="modellizzazione-bayesiana.html"><i class="fa fa-check"></i><b>2.1</b> Modellizzazione bayesiana</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="modellizzazione-bayesiana.html"><a href="modellizzazione-bayesiana.html#notazione"><i class="fa fa-check"></i><b>2.1.1</b> Notazione</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html"><i class="fa fa-check"></i><b>2.2</b> Distribuzioni a priori</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#tipologie-di-distribuzioni-a-priori"><i class="fa fa-check"></i><b>2.2.1</b> Tipologie di distribuzioni a priori</a></li>
<li class="chapter" data-level="2.2.2" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#selezione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>2.2.2</b> Selezione della distribuzione a priori</a></li>
<li class="chapter" data-level="2.2.3" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#unapplicazione-empirica"><i class="fa fa-check"></i><b>2.2.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html"><i class="fa fa-check"></i><b>2.3</b> La funzione di verosimiglianza</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#notazione-1"><i class="fa fa-check"></i><b>2.3.1</b> Notazione</a></li>
<li class="chapter" data-level="2.3.2" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#la-log-verosimiglianza"><i class="fa fa-check"></i><b>2.3.2</b> La log-verosimiglianza</a></li>
<li class="chapter" data-level="2.3.3" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#unapplicazione-empirica-1"><i class="fa fa-check"></i><b>2.3.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sec:const-normaliz-bino23.html"><a href="sec:const-normaliz-bino23.html"><i class="fa fa-check"></i><b>2.4</b> La verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sec:const-normaliz-bino23.html"><a href="sec:const-normaliz-bino23.html#unapplicazione-empirica-2"><i class="fa fa-check"></i><b>2.4.1</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="distribuzione-a-posteriori.html"><a href="distribuzione-a-posteriori.html"><i class="fa fa-check"></i><b>2.5</b> Distribuzione a posteriori</a></li>
<li class="chapter" data-level="2.6" data-path="distribuzione-predittiva-a-priori.html"><a href="distribuzione-predittiva-a-priori.html"><i class="fa fa-check"></i><b>2.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="2.7" data-path="distribuzione-predittiva-a-posteriori.html"><a href="distribuzione-predittiva-a-posteriori.html"><i class="fa fa-check"></i><b>2.7</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="" data-path="commenti-e-considerazioni-finali.html"><a href="commenti-e-considerazioni-finali.html"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html"><i class="fa fa-check"></i><b>3</b> Il modello beta-binomiale in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="3.1" data-path="il-presidente-trump-e-lidrossiclorochina.html"><a href="il-presidente-trump-e-lidrossiclorochina.html"><i class="fa fa-check"></i><b>3.1</b> Il presidente Trump e l’idrossiclorochina</a></li>
<li class="chapter" data-level="3.2" data-path="una-proporzione.html"><a href="una-proporzione.html"><i class="fa fa-check"></i><b>3.2</b> Una proporzione</a></li>
<li class="chapter" data-level="3.3" data-path="cmdstanr-gautret.html"><a href="cmdstanr-gautret.html"><i class="fa fa-check"></i><b>3.3</b> Interfaccia <code>cmdstanr</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="cmdstanr-gautret.html"><a href="cmdstanr-gautret.html#fase-1"><i class="fa fa-check"></i><b>3.3.1</b> Fase 1</a></li>
<li class="chapter" data-level="3.3.2" data-path="cmdstanr-gautret.html"><a href="cmdstanr-gautret.html#fase-2"><i class="fa fa-check"></i><b>3.3.2</b> Fase 2</a></li>
<li class="chapter" data-level="3.3.3" data-path="cmdstanr-gautret.html"><a href="cmdstanr-gautret.html#burn-in"><i class="fa fa-check"></i><b>3.3.3</b> Burn-in</a></li>
<li class="chapter" data-level="3.3.4" data-path="cmdstanr-gautret.html"><a href="cmdstanr-gautret.html#inferenza"><i class="fa fa-check"></i><b>3.3.4</b> Inferenza</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="la-critica-di-hulme_2020.html"><a href="la-critica-di-hulme_2020.html"><i class="fa fa-check"></i><b>3.4</b> La critica di <span class="citation">Hulme et al. (<span>2020</span>)</span></a></li>
<li class="chapter" data-level="3.5" data-path="due-proporzioni.html"><a href="due-proporzioni.html"><i class="fa fa-check"></i><b>3.5</b> Due proporzioni</a></li>
<li class="chapter" data-level="" data-path="commenti-e-considerazioni-finali-1.html"><a href="commenti-e-considerazioni-finali-1.html"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>II Appendici</b></span></li>
<li class="appendix"><span><b>Appendici</b></span></li>
<li class="chapter" data-level="A" data-path="appendix:intro-stan.html"><a href="appendix:intro-stan.html"><i class="fa fa-check"></i><b>A</b> Programmare in Stan</a>
<ul>
<li class="chapter" data-level="A.1" data-path="interfacce-e-pacchetti.html"><a href="interfacce-e-pacchetti.html"><i class="fa fa-check"></i><b>A.1</b> Interfacce e pacchetti</a></li>
<li class="chapter" data-level="A.2" data-path="interfaccia-cmdstanr.html"><a href="interfaccia-cmdstanr.html"><i class="fa fa-check"></i><b>A.2</b> Interfaccia <code>cmdstanr</code></a></li>
<li class="chapter" data-level="A.3" data-path="codice-stan.html"><a href="codice-stan.html"><i class="fa fa-check"></i><b>A.3</b> Codice Stan</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="codice-stan.html"><a href="codice-stan.html#hello-world-stan"><i class="fa fa-check"></i><b>A.3.1</b> “Hello, world” – Stan</a></li>
<li class="chapter" data-level="A.3.2" data-path="codice-stan.html"><a href="codice-stan.html#blocco-data"><i class="fa fa-check"></i><b>A.3.2</b> Blocco <code>data</code></a></li>
<li class="chapter" data-level="A.3.3" data-path="codice-stan.html"><a href="codice-stan.html#blocco-parameters"><i class="fa fa-check"></i><b>A.3.3</b> Blocco <code>parameters</code></a></li>
<li class="chapter" data-level="A.3.4" data-path="codice-stan.html"><a href="codice-stan.html#blocco-model"><i class="fa fa-check"></i><b>A.3.4</b> Blocco <code>model</code></a></li>
<li class="chapter" data-level="A.3.5" data-path="codice-stan.html"><a href="codice-stan.html#blocchi-opzionali"><i class="fa fa-check"></i><b>A.3.5</b> Blocchi opzionali</a></li>
<li class="chapter" data-level="A.3.6" data-path="codice-stan.html"><a href="codice-stan.html#sintassi"><i class="fa fa-check"></i><b>A.3.6</b> Sintassi</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>A.4</b> Workflow</a></li>
<li class="chapter" data-level="A.5" data-path="ciao-stan.html"><a href="ciao-stan.html"><i class="fa fa-check"></i><b>A.5</b> Ciao, Stan</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="due-proporzioni" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Due proporzioni</h2>
<p>Svolgiamo ora l’analisi statistica considerando tutti i dati, come suggerito da <span class="citation">Hulme et al. (<a href="#ref-Hulme_2020" role="doc-biblioref">2020</a>)</span>. Per fare questo verrà creato un modello bayesiano per fare inferenza sulla differenza tra due proporzioni. Dopo avere generato le distribuzioni a posteriori per le proporzioni di “successi” nei due gruppi, calcoleremo la quantità</p>
<p><span class="math display">\[
\omega = \frac{\theta_2 / (1-\theta_2)}{\theta_1 / (1-\theta_1)},
\]</span></p>
<p>ovvero il rapporto tra gli Odds di positività tra i pazienti del gruppo di controllo e gli Odds di positività tra i pazienti del gruppo sperimentale. Se il valore dell’OR è uguale a 1, significa che l’Odds di positività nel gruppo di controllo è uguale all’Odds di positività nel gruppo sperimentale, cioè il fattore in esame (somministrazione dell’idrossiclorochina) è ininfluente sulla comparsa della malattia. L’inferenza statistica sull’efficacia dell’idrossiclorochina come terapia per il Covid-19 può dunque essere effettuata esaminando l’intervallo di credibilità al 95% per l’OR: se tale intervallo include il valore 1, allora non vi è evidenza che l’idrossiclorochina sia efficace come terapia per il Covid-19.</p>
<p>Nell’implementazione di questo modello, la quantità di interesse è dunque l’odds ratio; tale quantità viene calcolata nel blocco <code>generated quantities</code> del programma Stan. Per i parametri <span class="math inline">\(\theta_1\)</span> e <span class="math inline">\(\theta_2\)</span> useremo delle distribuzioni a priori debolmente informative il cui unico scopo è la regolarizzazione dei dati.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="due-proporzioni.html#cb17-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-2"><a href="due-proporzioni.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N1 =</span> <span class="dv">18</span>, </span>
<span id="cb17-3"><a href="due-proporzioni.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y1 =</span> <span class="dv">10</span>, </span>
<span id="cb17-4"><a href="due-proporzioni.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">N2 =</span> <span class="dv">16</span>, </span>
<span id="cb17-5"><a href="due-proporzioni.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y2 =</span> <span class="dv">14</span></span>
<span id="cb17-6"><a href="due-proporzioni.html#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="due-proporzioni.html#cb18-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb18-2"><a href="due-proporzioni.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="st">//  Comparison of two groups with Binomial</span></span>
<span id="cb18-3"><a href="due-proporzioni.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb18-4"><a href="due-proporzioni.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N1;              // number of experiments in group 1</span></span>
<span id="cb18-5"><a href="due-proporzioni.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; y1;              // number of deaths in group 1</span></span>
<span id="cb18-6"><a href="due-proporzioni.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N2;              // number of experiments in group 2</span></span>
<span id="cb18-7"><a href="due-proporzioni.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; y2;              // number of deaths in group 2</span></span>
<span id="cb18-8"><a href="due-proporzioni.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb18-9"><a href="due-proporzioni.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb18-10"><a href="due-proporzioni.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0,upper=1&gt; theta1; // probability of death in group 1</span></span>
<span id="cb18-11"><a href="due-proporzioni.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0,upper=1&gt; theta2; // probability of death in group 2</span></span>
<span id="cb18-12"><a href="due-proporzioni.html#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb18-13"><a href="due-proporzioni.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb18-14"><a href="due-proporzioni.html#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">  theta1 ~ beta(2, 2);          // prior</span></span>
<span id="cb18-15"><a href="due-proporzioni.html#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">  theta2 ~ beta(2, 2);          // prior</span></span>
<span id="cb18-16"><a href="due-proporzioni.html#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">  y1 ~ binomial(N1, theta1);    // observation model / likelihood</span></span>
<span id="cb18-17"><a href="due-proporzioni.html#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~ binomial(N2, theta2);    // observation model / likelihood</span></span>
<span id="cb18-18"><a href="due-proporzioni.html#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb18-19"><a href="due-proporzioni.html#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb18-20"><a href="due-proporzioni.html#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="st">  // generated quantities are computed after sampling</span></span>
<span id="cb18-21"><a href="due-proporzioni.html#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="st">  real oddsratio = (theta2/(1-theta2))/(theta1/(1-theta1));</span></span>
<span id="cb18-22"><a href="due-proporzioni.html#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb18-23"><a href="due-proporzioni.html#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb18-24"><a href="due-proporzioni.html#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/twoprop1.stan&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="due-proporzioni.html#cb19-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;twoprop1.stan&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="due-proporzioni.html#cb20-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="due-proporzioni.html#cb21-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb21-2"><a href="due-proporzioni.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb21-3"><a href="due-proporzioni.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb21-4"><a href="due-proporzioni.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb21-5"><a href="due-proporzioni.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb21-6"><a href="due-proporzioni.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb21-7"><a href="due-proporzioni.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 4L,</span>
<span id="cb21-8"><a href="due-proporzioni.html#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb21-9"><a href="due-proporzioni.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb21-10"><a href="due-proporzioni.html#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="due-proporzioni.html#cb22-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="due-proporzioni.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb23-2"><a href="due-proporzioni.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  stanfit,</span>
<span id="cb23-3"><a href="due-proporzioni.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta1&quot;</span>, <span class="st">&quot;theta2&quot;</span>, <span class="st">&quot;oddsratio&quot;</span>),</span>
<span id="cb23-4"><a href="due-proporzioni.html#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits_summary =</span> 3L</span>
<span id="cb23-5"><a href="due-proporzioni.html#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-6"><a href="due-proporzioni.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Inference for Stan model: twoprop1-202201280714-1-5cc062.</span></span>
<span id="cb23-7"><a href="due-proporzioni.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter=6000; warmup=2000; thin=1; </span></span>
<span id="cb23-8"><a href="due-proporzioni.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; post-warmup draws per chain=4000, total post-warmup draws=16000.</span></span>
<span id="cb23-9"><a href="due-proporzioni.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-10"><a href="due-proporzioni.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            mean se_mean    sd  2.5%   25%   50%   75%  97.5% n_eff Rhat</span></span>
<span id="cb23-11"><a href="due-proporzioni.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta1    0.546   0.001 0.103 0.344 0.475 0.546 0.620  0.740 12795    1</span></span>
<span id="cb23-12"><a href="due-proporzioni.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta2    0.798   0.001 0.087 0.601 0.744 0.808 0.862  0.937 14193    1</span></span>
<span id="cb23-13"><a href="due-proporzioni.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; oddsratio 4.721   0.043 4.411 0.906 2.166 3.514 5.698 15.558 10400    1</span></span>
<span id="cb23-14"><a href="due-proporzioni.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-15"><a href="due-proporzioni.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Ven Gen 28 07:14:20 2022.</span></span>
<span id="cb23-16"><a href="due-proporzioni.html#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb23-17"><a href="due-proporzioni.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span id="cb23-18"><a href="due-proporzioni.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>L’intervallo di credibilità del 95% per l’OR include il valore di 1.0 (ovvero, il valore che indica che gli Odds di positività sono uguali nei due gruppi). In base agli standard correnti, un risultato di questo tipo non viene considerato come evidenza sufficiente per potere concludere che il parametro <span class="math inline">\(\theta\)</span> assume un valore diverso nei due gruppi. In conclusione, se consideriamo tutti i dati, e non solo quelli selezionati da <span class="citation">Gautret et al. (<a href="#ref-Gautret_2020" role="doc-biblioref">2020</a>)</span>, non vi sono evidenze sull’efficacia dell’idrossiclorochina come terapia per i casi di Covid-19.</p>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gautret_2020" class="csl-entry">
Gautret, P., J. C. Lagier, P. Parola, L. Meddeb, M. Mailhe, B. Doudier, and S. Honoré. 2020. <span>“Hydroxychloroquine and Azithromycin as a Treatment of COVID-19: Results of an Open-Label Non-Randomized Clinical Trial.”</span> <em>International Journal of Antimicrobial Agents</em>.
</div>
<div id="ref-Hulme_2020" class="csl-entry">
Hulme, O. J., E. J. Wagenmakers, P. Damkier, C. F. Madelung, H. R. Siebner, J. Helweg-Larsen, and K. H. Madsen. 2020. <span>“Reply to Gautret Et Al. 2020: A Bayesian Reanalysis of the Effects of Hydroxychloroquine and Azithromycin on Viral Carriage in Patients with COVID-19.”</span> <em>medRxiv</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="la-critica-di-hulme_2020.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="commenti-e-considerazioni-finali-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ccaudek/ds4psy/edit/master/040_beta_binomial_mod.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ds4psy.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
