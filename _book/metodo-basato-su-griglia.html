<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Metodo basato su griglia | Data Science per psicologi</title>
  <meta name="description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Metodo basato su griglia | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="github-repo" content="ccaudek/ds4psy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Metodo basato su griglia | Data Science per psicologi" />
  
  <meta name="twitter:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2022-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch:metropolis.html"/>
<link rel="next" href="chapter-simulazioneMC.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefazione</a>
<ul>
<li class="chapter" data-level="" data-path="la-psicologia-e-la-data-science.html"><a href="la-psicologia-e-la-data-science.html"><i class="fa fa-check"></i>La psicologia e la Data science</a></li>
<li class="chapter" data-level="" data-path="come-studiare.html"><a href="come-studiare.html"><i class="fa fa-check"></i>Come studiare</a></li>
<li class="chapter" data-level="" data-path="sviluppare-un-metodo-di-studio-efficace.html"><a href="sviluppare-un-metodo-di-studio-efficace.html"><i class="fa fa-check"></i>Sviluppare un metodo di studio efficace</a></li>
</ul></li>
<li class="part"><span><b>I Inferenza bayesiana</b></span></li>
<li class="chapter" data-level="1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html"><i class="fa fa-check"></i><b>1</b> Flusso di lavoro bayesiano</a>
<ul>
<li class="chapter" data-level="1.1" data-path="modellizzazione-bayesiana.html"><a href="modellizzazione-bayesiana.html"><i class="fa fa-check"></i><b>1.1</b> Modellizzazione bayesiana</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="modellizzazione-bayesiana.html"><a href="modellizzazione-bayesiana.html#notazione"><i class="fa fa-check"></i><b>1.1.1</b> Notazione</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html"><i class="fa fa-check"></i><b>1.2</b> Distribuzioni a priori</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#tipologie-di-distribuzioni-a-priori"><i class="fa fa-check"></i><b>1.2.1</b> Tipologie di distribuzioni a priori</a></li>
<li class="chapter" data-level="1.2.2" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#selezione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>1.2.2</b> Selezione della distribuzione a priori</a></li>
<li class="chapter" data-level="1.2.3" data-path="distribuzioni-a-priori.html"><a href="distribuzioni-a-priori.html#unapplicazione-empirica"><i class="fa fa-check"></i><b>1.2.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html"><i class="fa fa-check"></i><b>1.3</b> La funzione di verosimiglianza</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#notazione-1"><i class="fa fa-check"></i><b>1.3.1</b> Notazione</a></li>
<li class="chapter" data-level="1.3.2" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#la-log-verosimiglianza"><i class="fa fa-check"></i><b>1.3.2</b> La log-verosimiglianza</a></li>
<li class="chapter" data-level="1.3.3" data-path="la-funzione-di-verosimiglianza.html"><a href="la-funzione-di-verosimiglianza.html#unapplicazione-empirica-1"><i class="fa fa-check"></i><b>1.3.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sec:const-normaliz-bino23.html"><a href="sec:const-normaliz-bino23.html"><i class="fa fa-check"></i><b>1.4</b> La verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sec:const-normaliz-bino23.html"><a href="sec:const-normaliz-bino23.html#unapplicazione-empirica-2"><i class="fa fa-check"></i><b>1.4.1</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="distribuzione-a-posteriori.html"><a href="distribuzione-a-posteriori.html"><i class="fa fa-check"></i><b>1.5</b> Distribuzione a posteriori</a></li>
<li class="chapter" data-level="1.6" data-path="distribuzione-predittiva-a-priori.html"><a href="distribuzione-predittiva-a-priori.html"><i class="fa fa-check"></i><b>1.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="1.7" data-path="distribuzione-predittiva-a-posteriori.html"><a href="distribuzione-predittiva-a-posteriori.html"><i class="fa fa-check"></i><b>1.7</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="" data-path="commenti-e-considerazioni-finali.html"><a href="commenti-e-considerazioni-finali.html"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch:metropolis.html"><a href="ch:metropolis.html"><i class="fa fa-check"></i><b>2</b> Approssimazione della distribuzione a posteriori</a>
<ul>
<li class="chapter" data-level="2.1" data-path="metodo-basato-su-griglia.html"><a href="metodo-basato-su-griglia.html"><i class="fa fa-check"></i><b>2.1</b> Metodo basato su griglia</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="metodo-basato-su-griglia.html"><a href="metodo-basato-su-griglia.html#modello-beta-binomiale"><i class="fa fa-check"></i><b>2.1.1</b> Modello Beta-Binomiale</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html"><i class="fa fa-check"></i><b>2.2</b> Metodo Monte Carlo</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#integration-mc"><i class="fa fa-check"></i><b>2.2.1</b> Integrazione di Monte Carlo</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#descrizione-intuitiva"><i class="fa fa-check"></i><b>2.2.2</b> Descrizione intuitiva</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#unapplicazione-empirica-3"><i class="fa fa-check"></i><b>2.2.3</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="2.2.4" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#una-passeggiata-casuale-sui-numeri-naturali"><i class="fa fa-check"></i><b>2.2.4</b> Una passeggiata casuale sui numeri naturali</a></li>
<li class="chapter" data-level="2.2.5" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#lalgoritmo-di-metropolis"><i class="fa fa-check"></i><b>2.2.5</b> L’algoritmo di Metropolis</a></li>
<li class="chapter" data-level="2.2.6" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#unapplicazione-empirica-4"><i class="fa fa-check"></i><b>2.2.6</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="2.2.7" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#gibbs-sampling"><i class="fa fa-check"></i><b>2.2.7</b> Gibb’s sampling</a></li>
<li class="chapter" data-level="2.2.8" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#input"><i class="fa fa-check"></i><b>2.2.8</b> Input</a></li>
<li class="chapter" data-level="2.2.9" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#stazionarietà"><i class="fa fa-check"></i><b>2.2.9</b> Stazionarietà</a></li>
<li class="chapter" data-level="2.2.10" data-path="chapter-simulazioneMC.html"><a href="chapter-simulazioneMC.html#test-di-convergenza"><i class="fa fa-check"></i><b>2.2.10</b> Test di convergenza</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="commenti-e-considerazioni-finali-1.html"><a href="commenti-e-considerazioni-finali-1.html"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metodo-basato-su-griglia" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Metodo basato su griglia</h2>
<p>Il metodo basato su griglia (<em>grid-based</em>) è un metodo numerico esatto basato su una griglia di punti uniformemente spaziati. Anche se la maggior parte dei parametri è continua (ovvero, in linea di principio ciascun parametro può assumere un numero infinito di valori), possiamo ottenere un’eccellente approssimazione della distribuzione a posteriori considerando solo una griglia finita di valori dei parametri. In un tale metodo, la densità di probabilità a posteriori può dunque essere approssimata tramite le densità di probabilità calcolate in ciascuna cella della griglia.</p>
<p>Il metodo basato su griglia si sviluppa in quattro fasi:</p>
<ul>
<li>fissare una griglia discreta di possibili valori <span class="math inline">\(\theta\)</span>;</li>
<li>valutare la distribuzione a priori <span class="math inline">\(p(\theta)\)</span> e la funzione di verosimiglianza <span class="math inline">\(p(y \mid \theta)\)</span> in corrispondenza di ciascun valore <span class="math inline">\(\theta\)</span> della griglia;</li>
<li>ottenere un’approssimazione discreta della densità a posteriori:
<ul>
<li>per ciascun valore <span class="math inline">\(\theta\)</span> della griglia, calcolare il prodotto <span class="math inline">\(p(\theta) p(y \mid \theta)\)</span>;</li>
<li>normalizzare i prodotti così ottenuti in modo tale che la loro somma sia 1;</li>
</ul></li>
<li>selezionare <span class="math inline">\(N\)</span> valori casuali della griglia in modo tale da ottenere un campione casuale delle densità a posteriori normalizzate.</li>
</ul>
<p>Possiamo migliorare l’approssimazione aumentando il numero di punti della griglia. Infatti utilizzando un numero infinito di punti si otterrebbe la descrizione esatta della distribuzione a posteriori, dovendo però pagare il costo dell’utilizzo di infinite risorse di calcolo. Il limite maggiore dell’approccio basato su griglia è che, al crescere della dimensionalità <span class="math inline">\(N\)</span> dello spazio dei parametri, i punti della griglia necessari per avere una buona stima crescerebbero esponenzialmente con <span class="math inline">\(N\)</span>, rendendo questo metodo inattuabile.</p>
<div id="modello-beta-binomiale" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Modello Beta-Binomiale</h3>
<p>Per fare un esempio, consideriamo lo schema beta-binomiale di cui conosciamo la soluzione esatta. Utilizziamo nuovamente i dati di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>: 23 “successi” in 30 prove Bernoulliane indipendenti.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Imponiamo alla distribuzione a priori su <span class="math inline">\(\theta\)</span> (probabilità di successo in una singola prova, laddove per “successo” si intende una aspettativa distorta negativamente dell’umore futuro) una <span class="math inline">\(\mbox{Beta}(2, 10)\)</span> per descrivere la nostra incertezza sul parametro prima di avere osservato i dati. Dunque, il modello diventa:</p>
<p><span class="math display">\[\begin{align}
Y \mid \theta &amp; \sim \mbox{Bin}(n = 30, \theta), \notag\\
\theta &amp; \sim \mbox{Beta}(2, 10).\notag
\end{align}\]</span></p>
<p>In queste circostanze, l’aggiornamento bayesiano produce una distribuzione a posteriori Beta di parametri 25 (<span class="math inline">\(y + \alpha\)</span> = 23 + 2) e 17 (<span class="math inline">\(n - y + \beta\)</span> = 30 - 23 + 10):</p>
<p><span class="math display">\[\begin{equation}
\theta \mid (y = 23) \sim \mbox{Beta}(25, 17).\notag
\end{equation}\]</span></p>
<p>Per approssimare la distribuzione a posteriori, fissiamo una griglia di <span class="math inline">\(n = 11\)</span> valori equispaziati: <span class="math inline">\(\theta \in \{0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1\}\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="metodo-basato-su-griglia.html#cb1-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-2"><a href="metodo-basato-su-griglia.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">11</span>)</span>
<span id="cb1-3"><a href="metodo-basato-su-griglia.html#cb1-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-4"><a href="metodo-basato-su-griglia.html#cb1-4" aria-hidden="true" tabindex="-1"></a>grid_data</span>
<span id="cb1-5"><a href="metodo-basato-su-griglia.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 11 × 1</span></span>
<span id="cb1-6"><a href="metodo-basato-su-griglia.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   theta_grid</span></span>
<span id="cb1-7"><a href="metodo-basato-su-griglia.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span id="cb1-8"><a href="metodo-basato-su-griglia.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0  </span></span>
<span id="cb1-9"><a href="metodo-basato-su-griglia.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.1</span></span>
<span id="cb1-10"><a href="metodo-basato-su-griglia.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.2</span></span>
<span id="cb1-11"><a href="metodo-basato-su-griglia.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.3</span></span>
<span id="cb1-12"><a href="metodo-basato-su-griglia.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.4</span></span>
<span id="cb1-13"><a href="metodo-basato-su-griglia.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.5</span></span>
<span id="cb1-14"><a href="metodo-basato-su-griglia.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        0.6</span></span>
<span id="cb1-15"><a href="metodo-basato-su-griglia.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        0.7</span></span>
<span id="cb1-16"><a href="metodo-basato-su-griglia.html#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 3 more rows</span></span></code></pre></div>
<p>In corrispondenza di ciascun valore della griglia, valutiamo la distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span> e la verosimiglianza <span class="math inline">\(\mbox{Bin}(y = 23, n = 30)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="metodo-basato-su-griglia.html#cb2-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="metodo-basato-su-griglia.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-3"><a href="metodo-basato-su-griglia.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">dbeta</span>(theta_grid, <span class="dv">2</span>, <span class="dv">10</span>),</span>
<span id="cb2-4"><a href="metodo-basato-su-griglia.html#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">23</span>, <span class="dv">30</span>, theta_grid)</span>
<span id="cb2-5"><a href="metodo-basato-su-griglia.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>In ciascuna cella della griglia calcoliamo poi il prodotto della verosimiglianza e della distribuzione a priori. Troviamo così un’approssimazione discreta e non normalizzata della distribuzione a posteriori (<code>unnormalized</code>). Normalizziamo questa approssimazione dividendo ciascun valore <code>unnormalized</code> per la somma di tutti i valori del vettore:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="metodo-basato-su-griglia.html#cb3-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="metodo-basato-su-griglia.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="metodo-basato-su-griglia.html#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb3-4"><a href="metodo-basato-su-griglia.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized)</span>
<span id="cb3-5"><a href="metodo-basato-su-griglia.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Verifichiamo:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="metodo-basato-su-griglia.html#cb4-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="metodo-basato-su-griglia.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb4-3"><a href="metodo-basato-su-griglia.html#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(unnormalized),</span>
<span id="cb4-4"><a href="metodo-basato-su-griglia.html#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(posterior)</span>
<span id="cb4-5"><a href="metodo-basato-su-griglia.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-6"><a href="metodo-basato-su-griglia.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb4-7"><a href="metodo-basato-su-griglia.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   `sum(unnormalized)` `sum(posterior)`</span></span>
<span id="cb4-8"><a href="metodo-basato-su-griglia.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb4-9"><a href="metodo-basato-su-griglia.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            0.000869                1</span></span></code></pre></div>
<p>Abbiamo dunque ottenuto la seguente distribuzione a posteriori discretizzata <span class="math inline">\(p(\theta \mid y)\)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="metodo-basato-su-griglia.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(grid_data, <span class="dv">2</span>)</span>
<span id="cb5-2"><a href="metodo-basato-su-griglia.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 11 × 5</span></span>
<span id="cb5-3"><a href="metodo-basato-su-griglia.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   theta_grid prior likelihood unnormalized posterior</span></span>
<span id="cb5-4"><a href="metodo-basato-su-griglia.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb5-5"><a href="metodo-basato-su-griglia.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0    0          0               0      0   </span></span>
<span id="cb5-6"><a href="metodo-basato-su-griglia.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        0.1  4.26       0               0      0   </span></span>
<span id="cb5-7"><a href="metodo-basato-su-griglia.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        0.2  2.95       0               0      0   </span></span>
<span id="cb5-8"><a href="metodo-basato-su-griglia.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.3  1.33       0               0      0   </span></span>
<span id="cb5-9"><a href="metodo-basato-su-griglia.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        0.4  0.44       0               0      0.02</span></span>
<span id="cb5-10"><a href="metodo-basato-su-griglia.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.5  0.11       0               0      0.23</span></span>
<span id="cb5-11"><a href="metodo-basato-su-griglia.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        0.6  0.02       0.03            0      0.52</span></span>
<span id="cb5-12"><a href="metodo-basato-su-griglia.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        0.7  0          0.12            0      0.21</span></span>
<span id="cb5-13"><a href="metodo-basato-su-griglia.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 3 more rows</span></span></code></pre></div>
<p>La figura <a href="metodo-basato-su-griglia.html#fig:grid-method-6points-posterior-plot">2.1</a> mostra un grafico della distribuzione a posteriori discretizzata così ottenuta:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="metodo-basato-su-griglia.html#cb6-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="metodo-basato-su-griglia.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb6-3"><a href="metodo-basato-su-griglia.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> theta_grid, <span class="at">y =</span> posterior)</span>
<span id="cb6-4"><a href="metodo-basato-su-griglia.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-5"><a href="metodo-basato-su-griglia.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="metodo-basato-su-griglia.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-7"><a href="metodo-basato-su-griglia.html#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb6-8"><a href="metodo-basato-su-griglia.html#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> theta_grid,</span>
<span id="cb6-9"><a href="metodo-basato-su-griglia.html#cb6-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> theta_grid,</span>
<span id="cb6-10"><a href="metodo-basato-su-griglia.html#cb6-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb6-11"><a href="metodo-basato-su-griglia.html#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> posterior</span>
<span id="cb6-12"><a href="metodo-basato-su-griglia.html#cb6-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-13"><a href="metodo-basato-su-griglia.html#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grid-method-6points-posterior-plot"></span>
<img src="ds4psy_files/figure-html/grid-method-6points-posterior-plot-1.png" alt="Distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per $y$ = 23 successi in 30 prove Bernoulliane, con distribuzione a priori $\mbox{Beta}(2, 10)$. È stata utilizzata una griglia di solo $n$ = 11 punti." width="576" />
<p class="caption">
FIGURA 2.1: Distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per <span class="math inline">\(y\)</span> = 23 successi in 30 prove Bernoulliane, con distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. È stata utilizzata una griglia di solo <span class="math inline">\(n\)</span> = 11 punti.
</p>
</div>
<p>L’ultimo passo della simulazione è il campionamento dalla distribuzione a posteriori discretizzata:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="metodo-basato-su-griglia.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84735</span>)</span>
<span id="cb7-2"><a href="metodo-basato-su-griglia.html#cb7-2" aria-hidden="true" tabindex="-1"></a>post_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(</span>
<span id="cb7-3"><a href="metodo-basato-su-griglia.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  grid_data,</span>
<span id="cb7-4"><a href="metodo-basato-su-griglia.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1e5</span>,</span>
<span id="cb7-5"><a href="metodo-basato-su-griglia.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> posterior,</span>
<span id="cb7-6"><a href="metodo-basato-su-griglia.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb7-7"><a href="metodo-basato-su-griglia.html#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>La figura <a href="metodo-basato-su-griglia.html#fig:grid-method-6points-posterior-plot-sampling">2.2</a> mostra che, con una griglia così sparsa abbiamo ottenuto una versione approssimata della vera distribuzione a posteriori (all’istogramma è stata sovrapposta l’esatta distribuzione a posteriori <span class="math inline">\(\mbox{Beta}(25, 17)\)</span>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="metodo-basato-su-griglia.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(post_sample, <span class="fu">aes</span>(<span class="at">x =</span> theta_grid)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="metodo-basato-su-griglia.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="metodo-basato-su-griglia.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">25</span>, <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="metodo-basato-su-griglia.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grid-method-6points-posterior-plot-sampling"></span>
<img src="ds4psy_files/figure-html/grid-method-6points-posterior-plot-sampling-1.png" alt="Campionamento dalla  distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per $y$ = 23 successi in 30 prove Bernoulliane, con distribuzione a priori $\mbox{Beta}(2, 10)$. È stata utilizzata una griglia di solo $n$ = 11 punti." width="576" />
<p class="caption">
FIGURA 2.2: Campionamento dalla distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per <span class="math inline">\(y\)</span> = 23 successi in 30 prove Bernoulliane, con distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. È stata utilizzata una griglia di solo <span class="math inline">\(n\)</span> = 11 punti.
</p>
</div>
<p>Possiamo ottenere un risultato migliore con una griglia più fine, come indicato nella figura <a href="metodo-basato-su-griglia.html#fig:grid-method-100points-posterior-plot-sampling">2.3</a>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="metodo-basato-su-griglia.html#cb9-1" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-2"><a href="metodo-basato-su-griglia.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb9-3"><a href="metodo-basato-su-griglia.html#cb9-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-4"><a href="metodo-basato-su-griglia.html#cb9-4" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="metodo-basato-su-griglia.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-6"><a href="metodo-basato-su-griglia.html#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">dbeta</span>(theta_grid, <span class="dv">2</span>, <span class="dv">10</span>),</span>
<span id="cb9-7"><a href="metodo-basato-su-griglia.html#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">23</span>, <span class="dv">30</span>, theta_grid)</span>
<span id="cb9-8"><a href="metodo-basato-su-griglia.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-9"><a href="metodo-basato-su-griglia.html#cb9-9" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="metodo-basato-su-griglia.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-11"><a href="metodo-basato-su-griglia.html#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb9-12"><a href="metodo-basato-su-griglia.html#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized)</span>
<span id="cb9-13"><a href="metodo-basato-su-griglia.html#cb9-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-14"><a href="metodo-basato-su-griglia.html#cb9-14" aria-hidden="true" tabindex="-1"></a>grid_data <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="metodo-basato-su-griglia.html#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb9-16"><a href="metodo-basato-su-griglia.html#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> theta_grid, <span class="at">y =</span> posterior)</span>
<span id="cb9-17"><a href="metodo-basato-su-griglia.html#cb9-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-18"><a href="metodo-basato-su-griglia.html#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-19"><a href="metodo-basato-su-griglia.html#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb9-20"><a href="metodo-basato-su-griglia.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb9-21"><a href="metodo-basato-su-griglia.html#cb9-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> theta_grid,</span>
<span id="cb9-22"><a href="metodo-basato-su-griglia.html#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> theta_grid,</span>
<span id="cb9-23"><a href="metodo-basato-su-griglia.html#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb9-24"><a href="metodo-basato-su-griglia.html#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> posterior</span>
<span id="cb9-25"><a href="metodo-basato-su-griglia.html#cb9-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-26"><a href="metodo-basato-su-griglia.html#cb9-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grid-method-100points-posterior-plot-sampling"></span>
<img src="ds4psy_files/figure-html/grid-method-100points-posterior-plot-sampling-1.png" alt="Distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per $y$ = 23 successi in 30 prove Bernoulliane, con distribuzione a priori $\mbox{Beta}(2, 10)$. È stata utilizzata una griglia di $n$ = 100 punti." width="576" />
<p class="caption">
FIGURA 2.3: Distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per <span class="math inline">\(y\)</span> = 23 successi in 30 prove Bernoulliane, con distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. È stata utilizzata una griglia di <span class="math inline">\(n\)</span> = 100 punti.
</p>
</div>
<p>Campioniamo ora 10000 punti:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="metodo-basato-su-griglia.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the seed</span></span>
<span id="cb10-2"><a href="metodo-basato-su-griglia.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84735</span>)</span>
<span id="cb10-3"><a href="metodo-basato-su-griglia.html#cb10-3" aria-hidden="true" tabindex="-1"></a>post_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(</span>
<span id="cb10-4"><a href="metodo-basato-su-griglia.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  grid_data,</span>
<span id="cb10-5"><a href="metodo-basato-su-griglia.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1e4</span>,</span>
<span id="cb10-6"><a href="metodo-basato-su-griglia.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> posterior,</span>
<span id="cb10-7"><a href="metodo-basato-su-griglia.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb10-8"><a href="metodo-basato-su-griglia.html#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Con il campionamento dalla distribuzione a posteriori discretizzata costruita mediante una griglia più densa (<span class="math inline">\(n = 100\)</span>) otteniamo un risultato soddisfacente (figura <a href="metodo-basato-su-griglia.html#fig:grid-method-100points-posterior-plot-and-correct-posterior">2.4</a>): ora la distribuzione dei valori prodotti dalla simulazione approssima molto bene la corretta distribuzione a posteriori <span class="math inline">\(p(\theta \mid y) = \mbox{Beta}(25, 17)\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="metodo-basato-su-griglia.html#cb11-1" aria-hidden="true" tabindex="-1"></a>post_sample <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="metodo-basato-su-griglia.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta_grid)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="metodo-basato-su-griglia.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb11-4"><a href="metodo-basato-su-griglia.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb11-5"><a href="metodo-basato-su-griglia.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb11-6"><a href="metodo-basato-su-griglia.html#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">50</span></span>
<span id="cb11-7"><a href="metodo-basato-su-griglia.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-8"><a href="metodo-basato-su-griglia.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">25</span>, <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="metodo-basato-su-griglia.html#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grid-method-100points-posterior-plot-and-correct-posterior"></span>
<img src="ds4psy_files/figure-html/grid-method-100points-posterior-plot-and-correct-posterior-1.png" alt="Campionamento dalla  distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per $y$ = 23 successi in 30 prove Bernoulliane, con distribuzione a priori $\mbox{Beta}(2, 10)$. È stata utilizzata una griglia di $n$ = 100 punti. All'istogramma è stata sovrapposta la corretta distribuzione a posteriori, ovvero la densità $\mbox{Beta}(25, 17)$." width="576" />
<p class="caption">
FIGURA 2.4: Campionamento dalla distribuzione a posteriori discretizzata ottenuta con il metodo grid-based per <span class="math inline">\(y\)</span> = 23 successi in 30 prove Bernoulliane, con distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. È stata utilizzata una griglia di <span class="math inline">\(n\)</span> = 100 punti. All’istogramma è stata sovrapposta la corretta distribuzione a posteriori, ovvero la densità <span class="math inline">\(\mbox{Beta}(25, 17)\)</span>.
</p>
</div>
<p>In conclusione, il metodo basato su griglia è molto intuitivo e non richiede particolari competenze di programmazione per essere implementato. Inoltre, fornisce un risultato che, per tutti gli scopi pratici, può essere considerato come un campione casuale estratto da <span class="math inline">\(p(\theta \mid y)\)</span>. Tuttavia, anche se tale metodo fornisce risultati accuratissimi, esso ha un uso limitato. A causa della <em>maledizione della dimensionalità</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, tale metodo può solo essere solo nel caso di semplici modelli statistici, con non più di due parametri. Nella pratica concreta tale metodo viene dunque sostituito da altre tecniche più efficienti in quanto, anche nei più comuni modelli utilizzati in psicologia, vengono solitamente stimati centinaia se non migliaia di parametri.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Johnson2022bayesrules" class="csl-entry">
Johnson, Alicia A., Miles Ott, and Mine Dogucu. 2022. <em><span class="nocase">Bayes Rules! An Introduction to Bayesian Modeling with R</span></em>. CRC Press.
</div>
<div id="ref-zetschefuture2019" class="csl-entry">
Zetsche, Ulrike, Paul-Christian Bürkner, and Babette Renneberg. 2019. <span>“Future Expectations in Clinical Depression: <span>Biased</span> or Realistic?”</span> <em>Journal of Abnormal Psychology</em> 128 (7): 678–88.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Nel presente esempio useremo lo stesso codice <span class="math inline">\(\textsf{R}\)</span> utilizzato da <span class="citation">Johnson, Ott, and Dogucu (<a href="#ref-Johnson2022bayesrules" role="doc-biblioref">2022</a>)</span>.<a href="metodo-basato-su-griglia.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Per capire cosa sia la maledizione della dimensionalità, supponiamo di utilizzare una griglia di 100 punti equispaziati. Nel caso di un solo parametro, è necessario calcolare 100 valori. Per due parametri devono essere calcolari <span class="math inline">\(100^2\)</span> valori. Ma già per 10 parametri è necessario calcolare <span class="math inline">\(10^{10}\)</span> valori – è facile capire che una tale quantità di calcoli è troppo grande anche per un computer molto potente. Per modelli che richiedono la stima di un numero non piccolo di parametri è dunque necessario procedere in un altro modo.<a href="metodo-basato-su-griglia.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch:metropolis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-simulazioneMC.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ccaudek/ds4psy/edit/master/036_posterior_sim.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ds4psy.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
