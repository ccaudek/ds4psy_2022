<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capitolo 3 Variabili e distribuzioni di frequenza | Data Science per psicologi</title>
<meta name="author" content="Corrado Caudek">
<meta name="description" content="Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad...">
<meta name="generator" content="bookdown 0.24.4 with bs4_book()">
<meta property="og:title" content="Capitolo 3 Variabili e distribuzioni di frequenza | Data Science per psicologi">
<meta property="og:type" content="book">
<meta property="og:description" content="Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capitolo 3 Variabili e distribuzioni di frequenza | Data Science per psicologi">
<meta name="twitter:description" content="Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs/header-attrs.js"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science per psicologi</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefazione</a></li>
<li class="book-part">Nozioni preliminari</li>
<li><a class="" href="concetti-chiave.html"><span class="header-section-number">1</span> Concetti chiave</a></li>
<li><a class="" href="chapter-misurazione.html"><span class="header-section-number">2</span> La misurazione in psicologia</a></li>
<li class="book-part">Analisi esplorativa dei dati</li>
<li><a class="active" href="ch:freq-distr.html"><span class="header-section-number">3</span> Variabili e distribuzioni di frequenza</a></li>
<li><a class="" href="ch:loc-scale.html"><span class="header-section-number">4</span> Indici di posizione e di scala</a></li>
<li><a class="" href="ch:correlation.html"><span class="header-section-number">5</span> Le relazioni tra variabili</a></li>
<li><a class="" href="ch:metropolis.html"><span class="header-section-number">6</span> Approssimazione della distribuzione a posteriori</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ch:freq-distr" class="section level1" number="3">
<h1>
<span class="header-section-number">Capitolo 3</span> Variabili e distribuzioni di frequenza<a class="anchor" aria-label="anchor" href="#ch:freq-distr"><i class="fas fa-link"></i></a>
</h1>
<p>Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad individuare le osservazioni anomale e gli errori di tabulazione. Consentono di riassumere le distribuzioni dei dati mediante indici sintetici. Consentono di visualizzare e di studiare le relazioni tra le variabili. In questo Capitolo, dopo avere presentato gli obiettivi dell’analisi esplorative dei dati, discuteremo il problema della descrizione numerica e della rappresentazione grafica delle distribuzioni di frequenza.</p>
<div id="chapter-descript" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Introduzione all’esplorazione dei dati<a class="anchor" aria-label="anchor" href="#chapter-descript"><i class="fas fa-link"></i></a>
</h2>
<p>Le analisi esplorative dei dati sono indispensabili per condurre in modo corretto una qualsiasi analisi statistica, dal livello base a quello avanzato. Si parla di analisi descrittiva se l’obiettivo è quello di descrivere le caratteristiche di un campione. Si parla di analisi esplorativa dei dati (<em>Exploratory Data Analysis</em> o EDA) se l’obiettivo è quello di esplorare i dati alla ricerca di nuove informazioni e relazioni tra variabili. Questa distinzione, seppur importante a livello teorico, nella pratica è più fumosa perché spesso entrambe le situazioni si verificano contemporaneamente nella stessa indagine statistica e le metodologie di analisi che si utilizzano sono molto simili.</p>
<p>Né il calcolo delle statistiche descrittive né l’analisi esplorativa dei dati possono essere condotte senza utilizzare un software. Le descrizioni dei concetti di base della EDA saranno dunque fornite di pari passo alla spiegazione di come le quantità discusse possono essere calcolate in pratica utilizzando .</p>
</div>
<div id="un-excursus-storico" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Un excursus storico<a class="anchor" aria-label="anchor" href="#un-excursus-storico"><i class="fas fa-link"></i></a>
</h2>
<p>Nel 1907 Francis Galton, cugino di Charles Darwin, matematico e
statistico autodidatta, geografo, esploratore, teorico della
dattiloscopia (ovvero, dell’uso delle impronte digitali a fini
identificativi) e dell’eugenetica, scrisse una lettera alla rivista
scientifica Nature sulla sua visita alla <em>Fat Stock and Poultry
Exhibition</em> di Plymouth. Lì vide alcuni membri del pubblico partecipare
ad un gioco il cui scopo era quello di indovinare il peso della carcassa
di un grande bue che era appena stato scuoiato. Galton si procurò i 787
dei biglietti che erano stati compilati dal pubblico e considerò il
valore medio di 547 kg come la “scelta democratica” dei partecipanti, in
quanto “ogni altra stima era stata giudicata troppo alta o troppo bassa
dalla maggioranza dei votanti”. Il punto interessante è che il peso
corretto di 543 kg si dimostrò essere molto simile alla “scelta
democratica” basata sulle stime dei 787 partecipanti. Galton intitolò la
sua lettera a Nature <em>Vox Populi</em> (voce del popolo), ma questo processo
decisionale è ora meglio conosciuto come la “saggezza delle folle”
(<em>wisdom of crowds</em>). Possiamo dire che, nel suo articolo del 1907,
Galton effettuò quello che ora chiamiamo un riepilogo dei dati, ovvero
calcolò un indice sintetico a partire da un insieme di dati. In questo
capitolo esamineremo le tecniche che sono state sviluppate nel secolo
successivo per riassumere le grandi masse di dati con cui sempre più
spesso ci dobbiamo confrontare. Vedremo come calcolare e interpretare
gli indici di posizione e di dispersione, discuteremo le distribuzioni
di frequenze e le relazioni tra variabili. Vedremo inoltre quali sono le
tecniche di visualizzazione che ci consentono di rappresentare questi
sommari dei dati mediante dei grafici. Ma prima di entrare nei dettagli, prendiamoci un momento per capire perché abbiamo bisogno della statistica e, per ciò che stiamo discutendo qui, della statistica descrittiva.</p>
<p>In generale, che cos’è la statistica? Ci sono molte definizioni. Fondamentalmente, la statistica è un insieme di tecniche che ci consentono di dare un senso al mondo attraverso i dati. Ciò avviene tramite il processo di analisi statistica. L’analisi statistica traduce le domande che abbiamo a proposito del mondo in modelli matematici, utilizza i dati per scegliere i modelli matematici che sono apppropriati per descrivere il mondo e, infine, applica tali modelli per trovare una risposta alle domande che ci siamo posti. La statistica consente quindi di collegare le nostre domande a proposito del mondo ai dati, di utilizzare i dati per trovare le risposte alle domande che ci siamo posti e di valutare l’impatto delle risposte che abbiamo trovato.</p>
</div>
<div id="riassumere-i-dati" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Riassumere i dati<a class="anchor" aria-label="anchor" href="#riassumere-i-dati"><i class="fas fa-link"></i></a>
</h2>
<p>Iniziamo a porci una domanda. Quando riassumiamo i dati, necessariamente buttiamo via delle informazioni; ma è una buona idea procedere in questo modo? Non sarebbe meglio conservare le informazioni specifiche di ciascun soggetto che partecipa ad un esperimento psicologico, al di là di ciò che viene trasmesso dagli indici riassuntivi della statistica descrittiva? Che dire delle informazioni che descrivono come sono stati raccolti i dati, come l’ora del giorno o l’umore del partecipante? Tutte queste informazioni vengono perdute quando riassumiamo i dati. La risposta alla domanda che ci siamo posti è che, in generale, non è una buona idea conservare tutti i dettagli di ciò che sappiamo. È molto più utile riassumere le informazioni perché la semplificazione risultante consente i processi di <em>generalizzazione</em>.</p>
<p>In un contesto letterario, l’importanza della generalizzazione è stata
sottolineata da Jorge Luis Borges nel suo racconto “Funes o della
memoria”, che descrive un individuo che perde la capacità di
dimenticare. Borges si concentra sulla relazione tra generalizzazione e
pensiero: <em>“Pensare è dimenticare una differenza, generalizzare, astrarre. Nel mondo troppo pieno di Funes, c’erano solo dettagli.”</em></p>
<p>Come possiamo ben capire, la vita di Funes non è facile. Se facciamo
riferimento alla psicologia possiamo dire che gli psicologi hanno
studiato a lungo l’utilità della generalizzazione per il pensiero. Un
esempio è fornito dal fenomeno della formazione dei concetti e lo
psicologo che viene in mente a questo proposito è sicuramente Eleanor
Rosch, la quale ha studiato i principi di base della categorizzazione. I
concetti ci forniscono uno strumento potente per organizzare le
conoscenze. Noi siamo in grado di riconoscere facilmente i diversi
esemplare di un concetto – per esempio, “gli uccelli” – anche se i
singoli esemplari che fanno parte di una categoria sono molto diversi
tra loro (l’aquila, il gabbiano, il pettirosso). L’uso dei concetti, cioè
la generalizzazione, è utile perché ci consente di fare previsioni sulle
proprietà dei singoli esemplari che appartengono ad una categoria, anche
se non abbiamo mai avuto esperienza diretta con essi – per esempio,
possiamo fare la predizione che tutti gli uccelli possono volare e
mangiare vermi, ma non possono guidare un’automobile o parlare in
inglese. Queste previsioni non sono sempre corrette, ma sono utili.</p>
<p>Le statistiche descrittive, in un certo senso, ci fornisco l’analogo dei
“prototipi” che, secondo Eleanor Rosch, stanno alla base del processo
psicologico di creazione dei concetti. Un prototipo è l’esemplare più
rappresentativo di una categoria. In maniera simile, una statistica
descrittiva come la media, ad esempio, potrebbe essere intesa come
l’osservazione “tipica”.</p>
<p>La statistica descrittiva ci fornisce gli strumenti per riassumere i
dati che abbiamo a disposizione in una forma visiva o numerica. Le
rappresentazioni grafiche più usate della statistica descrittiva sono
gli istogrammi, i diagrammi a dispersione o i box-plot, e gli indici
sintetici più comuni sono la media, la mediana, la varianza e la
deviazione standard.</p>
</div>
<div id="i-dati-grezzi" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> I dati grezzi<a class="anchor" aria-label="anchor" href="#i-dati-grezzi"><i class="fas fa-link"></i></a>
</h2>
<p>Per introdurre i principali strumenti della statistica descrittiva considereremo qui i dati raccolti da <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>. Questi ricercatori hanno studiato le aspettative negative quale meccanismo chiave nel mantenimento e nella reiterazione della depressione. Nello studio, <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> si sono chiesti se individui depressi maturino delle aspettative accurate sul loro umore futuro, oppure se tali aspettative sono distorte negativamente.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Si veda l’Appendice &lt;a href="#es-pratico-zetsche"&gt;&lt;strong&gt;??&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;'><sup>3</sup></a>. In uno studio viene esaminato un campione costituito da 30 soggetti con almeno un episodio depressivo maggiore e da 37 controlli sani. Gli autori hanno misurato il livello depressivo con il <em>Beck Depression Inventory</em> (BDI-II). Questi sono i dati che considereremo qui.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-8" class="exercise"><strong>Esercizio 3.1  </strong></span>Qual è la la gravità della depressione riportata dai soggetti nel campione esaminato da <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>?</p>
<p>Per rispondere a questa domanda, iniziamo a leggere in <span class="math inline">\(\R\)</span> i dati, assumendo che il file <code>data.mood.csv</code> si trovi nella cartella <code>data</code> contenuta nella <em>working directory</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/leeper/rio">"rio"</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span>
  <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"data.mood.csv"</span><span class="op">)</span>,
  header <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p>C’è un solo valore BDI-II per ciascun soggetto ma tale valore viene ripetuto tante volte quante volte sono le righe del <code>data.frame</code> associate ad ogni soggetto (ciascuna riga corrispondente ad una prova diversa). È dunque necessario trasformare il <code>data.frame</code> in modo tale da avere un’unica riga per ciascun soggetto, ovvero un unico valore BDI-II per soggetto.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">esm_id</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>
    bdi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bdi</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Ci sono dunque 66 soggetti i quali hanno ottenuto i valori sulla scala del BDI-II stampati di seguito. Per semplicità, li presentiamo ordinati dal più piccolo al più grande.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">bysubj</span><span class="op">$</span><span class="va">bdi</span><span class="op">)</span>
<span class="co">#&gt;  [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [18]  1  1  1  1  1  1  1  1  2  2  2  2  3  3  3  5  7</span>
<span class="co">#&gt; [35]  9 12 19 22 22 24 25 25 26 26 26 27 27 28 28 30 30</span>
<span class="co">#&gt; [52] 30 31 31 33 33 34 35 35 35 36 39 41 43 43 44</span></code></pre></div>
</div>
</div>
<div id="distribuzioni-di-frequenze" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Distribuzioni di frequenze<a class="anchor" aria-label="anchor" href="#distribuzioni-di-frequenze"><i class="fas fa-link"></i></a>
</h2>
<p>È chiaro che i dati grezzi sono di difficile lettura. Poniamoci dunque il problema di creare una rappresentazione sintetica e comprensibile di questo insieme di valori. Uno dei modi che ci consentono di effettuare una sintesi dei dati è quello di generare una <em>distribuzione di frequenze</em>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-9" class="definition"><strong>Definizione 3.1  </strong></span>Una distribuzione di frequenze è un riepilogo del conteggio della frequenza con cui le modalità osservate in un insieme di dati si verificano in un intervallo di valori.</p>
</div>
<p>Per creare una distribuzione di frequenze possiamo procedere effettuando una partizione delle modalità della variabile di interesse in <span class="math inline">\(m\)</span> classi (denotate con <span class="math inline">\(\Delta_i\)</span>) tra loro disgiunte. In tale partizione, la classe <span class="math inline">\(i\)</span>-esima coincide con un intervallo di valori aperto a destra <span class="math inline">\([a_i, b_i)\)</span> o aperto a sinistra <span class="math inline">\((a_i, b_i]\)</span>. Ad ogni classe <span class="math inline">\(\Delta_i\)</span> avente <span class="math inline">\(a_i\)</span> e <span class="math inline">\(b_i\)</span> come limite inferiore e superiore associamo l’ampiezza <span class="math inline">\(b_i - a_i\)</span> (non necessariamente uguale per ogni
classe) e il valore centrale <span class="math inline">\(\bar{x}_i\)</span>. La scelta delle classi è arbitraria, ma è buona norma non definire classi con un numero troppo piccolo (&lt; 5) di osservazioni. Poiché ogni elemento dell’insieme <span class="math inline">\(\{x_i\}_{i=1}^n\)</span> appartiene ad una ed una sola classe <span class="math inline">\(\Delta_i\)</span>, possiamo calcolare le quantità elencate di seguito.</p>
<ul>
<li>
<p>La <em>frequenza assoluta</em> <span class="math inline">\(n_i\)</span> di ciascuna classe, ovvero il numero di osservazioni che ricadono nella classe <span class="math inline">\(\Delta_i\)</span>.</p>
<ul>
<li>Proprietà: <span class="math inline">\(n_1 + n_2 + \dots + n_m = n\)</span>.</li>
</ul>
</li>
<li>
<p>La <em>frequenza relativa</em> <span class="math inline">\(f_i = n_i/n\)</span> di ciascuna classe.</p>
<ul>
<li>Proprietà: <span class="math inline">\(f_1+f_2+\dots+f_m =1\)</span>.</li>
</ul>
</li>
<li><p>La <em>frequenza cumulata</em> <span class="math inline">\(N_i\)</span>, ovvero il numero totale delle osservazioni che ricadono nelle classi fino alla <span class="math inline">\(i\)</span>-esima compresa: <span class="math inline">\(N_i = \sum_{i=1}^m n_i.\)</span></p></li>
<li><p>La <em>frequenza cumulata relativa</em> <span class="math inline">\(F_i\)</span>, ovvero
<span class="math inline">\(F_i = f_1+f_2+\dots+f_m = \frac{N_i}{n} = \frac{1}{n} \sum_{i=1}^m f_i.\)</span></p></li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-10" class="exercise"><strong>Esercizio 3.2  </strong></span>Si calcoli la distribuzione di frequenza assoluta e la distribuzione di frequenza relativa per i valori del BDI-II del campione clinico di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>Per costruire una distribuzione di frequenza è innanzitutto necessario scegliere gli intervalli delle classi. Facendo riferimento ai cut-off usati per l’interpretazione del BDI-II, definiamo i seguenti <em>intervalli aperti a destra</em>:</p>
<ul>
<li>depressione minima: [0, 13.5),</li>
<li>depressione lieve: [13.5, 19.5),</li>
<li>depressione moderata: [19.5, 28.5),</li>
<li>depressione severa: [28.5, 63).</li>
</ul>
<p>Esaminando i dati, possiamo notare che 36 soggetti cadono nella prima classe, uno nella seconda classe, e così via. La distribuzione di frequenza della variabile <code>bdi2</code> è riportata nella tabella seguente. Questa distribuzione di frequenza ci aiuta a capire meglio cosa sta succedendo. Se consideriamo la frequenza relativa, ad esempio, possiamo notare che ci sono due valori maggiormente ricorrenti e tali valori corrispondono alle due classi più estreme. Questo ha senso nel caso presente, in quanto il campione esaminato da <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> includeva due gruppi di soggetti: soggetti sani (con valori BDI-II bassi) e soggetti depressi (con valori BDI-II alti).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;In una sezione successiva di questo capitolo discuteremo i principi che, secondo Edward Tufte, devono guidare la Data Science. Parlando delle rappresentazioni grafiche dei dati, Edward Tufte ci dice che la prima cosa da fare è “mostrare i dati”. Questa può sembrare una tautologia, considerato che questo è lo scopo della statistica descrittiva: trasformare i dati attraverso vari indici riassuntivi o rappresentazioni grafiche, in modo tale da renderli &lt;em&gt;comprensibili&lt;/em&gt;. Tuttavia, spesso le tecniche statistiche vengono usate per &lt;em&gt;nascondere&lt;/em&gt; e non per &lt;em&gt;mostrare&lt;/em&gt; i dati. L’uso delle frequenze relative offre un chiaro esempio di questo. Di questi tempi capita spesso di incontrare, sulla stampa, notizie a proposito un nuovo farmaco che, in una prova clinica, ha mostrato risultati incoraggianti che suggeriscono la sua efficacia come possibile trattamento del COVID-19. Alle volte i risultati della sperimentazione clinica sono riportati nei termini di una &lt;em&gt;frequenza relativa&lt;/em&gt;. Ad esempio, potremmo leggere che l’uso del farmaco ha portato ad una riduzione del 21% dei ricoveri o dei decessi. Sembra tanto. Ma è necessario guardare i dati! Ovvero, molto spesso, quello che &lt;em&gt;non&lt;/em&gt; viene riportato dai comunicati stampa. Infatti, una riduzione del 21% può corrispondere ad un cambiamento dal 5% al 4%. E una riduzione del 44% può corrispondere ad una differenza di 10 contro 18, o di 5 contro 9, o di 15 contro 27. In altri termini, una proporzione, anche grande, può corrispondere ad una differenza &lt;em&gt;assoluta&lt;/em&gt; piuttosto piccola: un piccolo passo in avanti, ma non ad un balzo! Per questa ragione, per capire cosa i dati significano, è necessario guardare i dati da diversi punti di vista, utilizzando diverse statistiche descrittive, senza limitarci alla statistica descrittiva che racconta la storia che piace di più. Perché la scelta della statistica descrittiva da utilizzare per riassumere i dati dipende dagli scopi di chi esegue l’analisi statisica: il nostro scopo è quelloi di capire se il farmaco funziona; lo scopo delle compagnie farmaceutiche è quello di vendere il farmaco. Sono obiettivi molto diversi.&lt;/p&gt;"><sup>4</sup></a> In una distribuzione di frequenza tali valori tipici vanno sotto il nome di <em>mode</em> della distribuzione.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Lim. classi</th>
<th align="center">Fr. ass.</th>
<th align="center">Fr. rel.</th>
<th align="center">Fr. ass. cum.</th>
<th align="center">Fr. rel. cum.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\([0, 13.5)\)</span></td>
<td align="center">36</td>
<td align="center">36/66</td>
<td align="center">36</td>
<td align="center">36/66</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\([13.5, 19.5)\)</span></td>
<td align="center">1</td>
<td align="center">1/66</td>
<td align="center">37</td>
<td align="center">37/66</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\([19.5, 28.5)\)</span></td>
<td align="center">12</td>
<td align="center">12/66</td>
<td align="center">49</td>
<td align="center">49/66</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\([28.5, 63)\)</span></td>
<td align="center">17</td>
<td align="center">17/66</td>
<td align="center">66</td>
<td align="center">66/66</td>
</tr>
</tbody>
</table></div>
<p>Poniamoci ora il problema di costruire la tabella precedente utilizzando . Usando la funzione <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code>, dividiamo il <em>campo di variazione</em> (ovvero, la differenza tra il valore massimo di una distribuzione ed il valore minimo) di una variabile continua <code>x</code> in intervalli e codifica ciascun valore <code>x</code> nei termini dell’intervallo a cui appartiene. Così facendo otteniamo:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span><span class="op">$</span><span class="va">bdi_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>
  <span class="va">bysubj</span><span class="op">$</span><span class="va">bdi</span>,
  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13.5</span>, <span class="fl">19.5</span>, <span class="fl">28.5</span>, <span class="fl">63</span><span class="op">)</span>,
  include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"minimal"</span>, <span class="st">"mild"</span>, <span class="st">"moderate"</span>, <span class="st">"severe"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">bysubj</span><span class="op">$</span><span class="va">bdi_level</span>
<span class="co">#&gt;  [1] moderate severe   severe   moderate severe  </span>
<span class="co">#&gt;  [6] severe   severe   severe   moderate severe  </span>
<span class="co">#&gt; [11] moderate mild     severe   minimal  minimal </span>
<span class="co">#&gt; [16] minimal  severe   moderate minimal  minimal </span>
<span class="co">#&gt; [21] minimal  minimal  minimal  moderate minimal </span>
<span class="co">#&gt; [26] minimal  minimal  minimal  minimal  minimal </span>
<span class="co">#&gt; [31] minimal  severe   minimal  minimal  severe  </span>
<span class="co">#&gt; [36] minimal  moderate minimal  minimal  minimal </span>
<span class="co">#&gt; [41] severe   minimal  minimal  severe   severe  </span>
<span class="co">#&gt; [46] moderate severe   severe   minimal  moderate</span>
<span class="co">#&gt; [51] minimal  moderate severe   moderate moderate</span>
<span class="co">#&gt; [56] minimal  minimal  minimal  minimal  minimal </span>
<span class="co">#&gt; [61] minimal  minimal  minimal  minimal  minimal </span>
<span class="co">#&gt; [66] minimal </span>
<span class="co">#&gt; Levels: minimal mild moderate severe</span></code></pre></div>
<p>
Possiamo ora usare la funzione <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> la quale ritorna un elenco che associa la frequenza assoluta a ciascuna modalità della variabile – ovvero, ritorna la distribuzione di frequenza assoluta.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bysubj</span><span class="op">$</span><span class="va">bdi_level</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  minimal     mild moderate   severe </span>
<span class="co">#&gt;       36        1       12       17</span></code></pre></div>
<p>
La distribuzione di frequenza relativa si ottiene dividendo ciascuna frequenza assoluta per il numero totale di osservazioni:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bysubj</span><span class="op">$</span><span class="va">bdi_level</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bysubj</span><span class="op">$</span><span class="va">bdi_level</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  minimal     mild moderate   severe </span>
<span class="co">#&gt;  0.54545  0.01515  0.18182  0.25758</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Limiti delle classi</th>
<th>Frequenza assoluta</th>
<th>Frequenza relativa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>[0, 13.5)</td>
<td>36</td>
<td>36/66</td>
</tr>
<tr class="even">
<td>[13.5, 19.5)</td>
<td>1</td>
<td>1/66</td>
</tr>
<tr class="odd">
<td>[19.5, 28.5)</td>
<td>12</td>
<td>12/66</td>
</tr>
<tr class="even">
<td>[28.5, 63]</td>
<td>17</td>
<td>17/66</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="istogramma" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Istogramma<a class="anchor" aria-label="anchor" href="#istogramma"><i class="fas fa-link"></i></a>
</h2>
<p>I dati che sono stati sintetizzati in una distribuzione di frequenze
possono essere rappresentati graficamente in un istogramma.
Un istogramma si costruisce riportando sulle ascisse i limiti delle
classi <span class="math inline">\(\Delta_i\)</span> e sulle ordinate i valori della funzione costante a
tratti</p>
<p><span class="math display">\[
\varphi_n(x)= \frac{f_i}{b_i-a_i}, \quad x\in \Delta_i,\, i=1, \dots, m
\]</span>
che misura la <em>densità della frequenza relativa</em> della variabile <span class="math inline">\(X\)</span>
nella classe <span class="math inline">\(\Delta_i\)</span>, ovvero il rapporto fra la frequenza relativa
<span class="math inline">\(f_i\)</span> e l’ampiezza (<span class="math inline">\(b_i - a_i\)</span>) della classe. In questo modo il
rettangolo dell’istogramma associato alla classe <span class="math inline">\(\Delta_i\)</span> avrà un’area
proporzionale alla frequenza relativa <span class="math inline">\(f_i\)</span>. Si noti che l’area totale
dell’istogramma delle frequenze relative è data della somma delle aree
dei singoli rettangoli e quindi vale 1.0.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-11" class="exercise"><strong>Esercizio 3.3  </strong></span>Si utilizzi <span class="math inline">\(\R\)</span> per costruire un istogramma per i valori BDI-II riportati da <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>Con i quattro intervalli individuati dai cut-off del BDI-II otteniamo la
rappresentazione riportata nella figura <a href="ch:freq-distr.html#fig:hist1zetsche">3.1</a>. Per chiarezza, precisiamo che <code>ggplot()</code> utilizza intervalli aperti a destra. Nel caso della prima barra dell’istogramma, l’ampiezza dell’intervallo è pari a 13.5 e l’area della barra (ovvero, la frequenza relativa) è uguale a 36/66. Dunque l’altezza della barra è uguale a <span class="math inline">\((36 / 66) / 13.5 = 0.040\)</span>. Lo stesso procedimento si applica per il calcolo dell’altezza degli altri rettangoli.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13.5</span>, <span class="fl">19.5</span>, <span class="fl">28.5</span>, <span class="fl">44.1</span><span class="op">)</span>
    <span class="co"># il valore BDI-II massimo è 44</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13.5</span>, <span class="fl">19.5</span>, <span class="fl">28.5</span>, <span class="fl">44.1</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"BDI-II"</span>,
    y <span class="op">=</span> <span class="st">"Densità di frequenza"</span>
  <span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist1zetsche"></span>
<img src="ds4psy_files/figure-html/hist1zetsche-1.png" alt="Istogramma per i valori BDI-II riportati da Zetsche et al. (2019)." width="576"><p class="caption">
FIGURA 3.1: Istogramma per i valori BDI-II riportati da Zetsche et al. (2019).
</p>
</div>
<p>Anche se nel caso presente è sensato usare ampiezze diverse per gli intervalli delle classi, in generale gli istogrammi si costruiscono utilizzando intervalli riportati sulle ascisse con un’ampiezza uguale. Questo è il caso dell’istogramma della figura <a href="ch:freq-distr.html#fig:hist2zetsche">3.2</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">44.1</span>, length.out <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.00</span>, <span class="fl">7.35</span>, <span class="fl">14.70</span>, <span class="fl">22.05</span>, <span class="fl">29.40</span>, <span class="fl">36.75</span>, <span class="fl">44.10</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"BDI-II"</span>,
    y <span class="op">=</span> <span class="st">"Densità di frequanza"</span>
  <span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist2zetsche"></span>
<img src="ds4psy_files/figure-html/hist2zetsche-1.png" alt="Una rappresentazione più comune per l'istogramma dei valori BDI-II nella quale gli intervalli delle classi hanno ampiezze uguali." width="576"><p class="caption">
FIGURA 3.2: Una rappresentazione più comune per l’istogramma dei valori BDI-II nella quale gli intervalli delle classi hanno ampiezze uguali.
</p>
</div>
</div>
</div>
<div id="kernel-density-plot" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Kernel density plot<a class="anchor" aria-label="anchor" href="#kernel-density-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Il confronto tra le figure <a href="ch:freq-distr.html#fig:hist1zetsche">3.1</a> e <a href="ch:freq-distr.html#fig:hist2zetsche">3.2</a> rende chiaro il limite dell’istogramma: il profilo dell’istogramma è arbitrario, in quanto dipende dal numero e dall’ampiezza delle classi. Questo rende difficile l’interpretazione.</p>
<p>Il problema precedente può essere alleviato utilizzando una rappresentazione alternativa della distribuzione di frequenza, ovvero la stima della densità della frequenza dei dati (detta anche stima <em>kernel di densità</em>). Un modo semplice per pensare a tale rappresentazione, che in inglese va sotto il nome di <em>kernel density plot</em> (cioè i grafici basati sulla stima kernel di densità), è quello di immaginare un grande campione di dati, in modo che diventi possibile definire un enorme numero di classi di equivalenza di ampiezza molto piccola, le quali non risultino vuote. In tali circostanze, la funzione di densità empirica non è altro che il profilo <em>lisciato</em> dell’istogramma. La stessa idea si applica anche quando il campione è piccolo. In tali circostanze, invece di raccogliere le osservazioni in barre come negli istogrammi, lo stimatore di densità kernel colloca una piccola “gobba” (<em>bump</em>), determinata da un fattore <span class="math inline">\(K\)</span> (kernel) e da un parametro <span class="math inline">\(h\)</span> di smussamento detto ampiezza di banda (<em>bandwidth</em>), in corrispondenza di ogni osservazione, quindi somma le gobbe risultanti generando una curva smussata.</p>
<p>L’interpretazione che possiamo attribuire al kernel density plot è simile a quella che viene assegnata agli istogrammi: l’area sottesa al kernel density plot in un certo intervallo rappresenta la proporzione di casi della distribuzione che hanno valori compresi in quell’intervallo.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-12" class="exercise"><strong>Esercizio 3.4  </strong></span>All’istogramma dei valori BDI-II di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> si sovrapponga un kernel density plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">44.1</span>, length.out <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_density</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span>,
    adjust <span class="op">=</span> <span class="fl">0.5</span>,
    size <span class="op">=</span> <span class="fl">0.8</span>,
    <span class="co"># fill = colors[2],</span>
    alpha <span class="op">=</span> <span class="fl">0.5</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"BDI-II"</span>,
    y <span class="op">=</span> <span class="st">"Densità di frequenza"</span>
  <span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:zetschehist3"></span>
<img src="ds4psy_files/figure-html/zetschehist3-1.png" alt="Kernel density plot e corrispondente istogramma per i valori BDI-II." width="576"><p class="caption">
FIGURA 3.3: Kernel density plot e corrispondente istogramma per i valori BDI-II.
</p>
</div>
</div>
</div>
<div id="forma-di-una-distribuzione" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Forma di una distribuzione<a class="anchor" aria-label="anchor" href="#forma-di-una-distribuzione"><i class="fas fa-link"></i></a>
</h2>
<p>In generale, la forma di una distribuzione descrive come i dati si distribuiscono intorno ai valori centrali. Distinguiamo tra distribuzioni simmetriche e asimmetriche, e tra distribuzioni unimodali o multimodali. Un’illustrazione grafica è fornita nella figura <a href="ch:freq-distr.html#fig:distrib-shapes">3.4</a>. Nel pannello 1 la distribuzione è unimodale con asimmetria negativa; nel pannello 2 la distribuzione è unimodale con asimmetria positiva; nel pannello 3 la distribuzione è simmetrica e unimodale; nel pannello 4 la distribuzione è bimodale.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distrib-shapes"></span>
<img src="ds4psy_files/figure-html/distrib-shapes-1.png" alt="1: Asimmetria negativa. 2: Asimmetria positiva. 3: Distribuzione unimodale. 4: Distribuzione bimodale." width="576"><p class="caption">
FIGURA 3.4: 1: Asimmetria negativa. 2: Asimmetria positiva. 3: Distribuzione unimodale. 4: Distribuzione bimodale.
</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-13" class="exercise"><strong>Esercizio 3.5  </strong></span>Il kernel density plot della figura <a href="ch:freq-distr.html#fig:zetschehist3">3.3</a> indica che la distribuzione dei valori del BDI-II nel campione di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> è bimodale. Ciò indica che le osservazioni della distribuzione si addensano in due cluster ben distinti: un gruppo di osservazioni tende ad avere valori BDI-II bassi, mentre l’altro gruppo tende ad avere BDI-II alti. Questi due cluster di osservazioni corrispondono al gruppo di controllo e al gruppo clinico nel campione di dati esaminato da <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>.</p>
</div>
</div>
<div id="indici-di-posizione" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> Indici di posizione<a class="anchor" aria-label="anchor" href="#indici-di-posizione"><i class="fas fa-link"></i></a>
</h2>
<p>Nuovamente, se preferite un’introduzione “soft” alla nozione di “tendenza centrale” di una distribuzione statistica, vi rimando nuovamentew al <a href="https://tinystats.github.io/teacups-giraffes-and-statistics/03_mean.html">link</a> che ho già suggerito in precedenza.</p>
<div id="quantili" class="section level3" number="3.9.1">
<h3>
<span class="header-section-number">3.9.1</span> Quantili<a class="anchor" aria-label="anchor" href="#quantili"><i class="fas fa-link"></i></a>
</h3>
<p>La descrizione della distribuzione dei valori BDI-II di
<span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> può essere facilitata dalla determinazione di
alcuni valori caratteristici che sintetizzano le informazioni contenute
nella distribuzione di frequenze. Si dicono <em>quantili</em> (o <em>frattili</em>)
quei valori caratteristici che hanno le seguenti proprietà. I <em>quartili</em>
sono quei valori che ripartiscono i dati <span class="math inline">\(x_i\)</span> in quattro parti
ugualmente numerose (pari ciascuna al 25% del totale). Il primo
quartile, <span class="math inline">\(q_1\)</span>, lascia alla sua sinistra il 25% del campione pensato
come una fila ordinata (a destra quindi il 75%). Il secondo quartile
<span class="math inline">\(q_2\)</span> lascia a sinistra il 50% del campione (a destra quindi il 50%).
Esso viene anche chiamato <em>mediana</em>. Il terzo quartile lascia a sinistra
il 75% del campione (a destra quindi il 25%). Secondo lo stesso
criterio, si dicono <em>decili</em> i quantili di ordine <span class="math inline">\(p\)</span> multiplo di 0.10 e
<em>percentili</em> i quantili di ordine <span class="math inline">\(p\)</span> multiplo di 0.01.</p>
<p>Come si calcolano i quantili? Consideriamo la definizione di quantile <em>non interpolato</em> di ordine <span class="math inline">\(p\)</span> <span class="math inline">\((0 &lt; p &lt; 1)\)</span>. Si procede innanzitutto
ordinando i dati in ordine crescente, <span class="math inline">\(\{x_1, x_2, \dots, x_n\}\)</span>. Ci
sono poi due possibilità. Se il valore <span class="math inline">\(np\)</span> non è intero, sia <span class="math inline">\(k\)</span>
l’intero tale che <span class="math inline">\(k &lt; np &lt; k + 1\)</span> – ovvero, la parte intera di <span class="math inline">\(np\)</span>.
Allora <span class="math inline">\(q_p = x_{k+1}.\)</span> Se <span class="math inline">\(np = k\)</span> con <span class="math inline">\(k\)</span> intero, allora
<span class="math inline">\(q_p = \frac{1}{2}(x_{k} + x_{k+1}).\)</span> Se vogliamo calcolare il primo
quartile <span class="math inline">\(q_1\)</span>, ad esempio, utilizziamo <span class="math inline">\(p = 0.25\)</span>. Dovendo calcolare
gli altri quantili basta sostituire a <span class="math inline">\(p\)</span> il valore appropriato.</p>
<p>Gli indici di posizione, tra le altre cose, hanno un ruolo importante,
ovvero vengono utilizzati per creare una rappresentazione grafica di una
distribuzione di valori che è molto popolare e può essere usata in
alternativa ad un istogramma (in realtà vedremo poi come possa essere
combinata con un istogramma). Tale rappresentazione va sotto il nome di
box-plot.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-14" class="exercise"><strong>Esercizio 3.6  </strong></span>Per fare un esempio, consideriamo i nove soggetti del campione clinico di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> che hanno riportato un unico episodio di depressione maggiore. Per tali soggetti i valori ordinati del BDI-II (per semplicità li chiameremo <span class="math inline">\(x\)</span>) sono i seguenti: 19, 26, 27, 28, 28, 33, 33, 41, 43.
Per il calcolo del secondo quartile (non interpolato), ovvero per il calcolo della mediana, dobbiamo considerare la quantità <span class="math inline">\(np = 9 \cdot 0.5 = 4.5\)</span>, non intero. Quindi, <span class="math inline">\(q_1 = x_{4 + 1} = 27\)</span>.
Per il calcolo del quantile (non interpolato) di ordine <span class="math inline">\(p = 2/3\)</span> dobbiamo considerare la quantità <span class="math inline">\(np = 9 \cdot 2/3 = 6\)</span>, intero. Quindi, <span class="math inline">\(q_{\frac{2}{3}} = \frac{1}{2} (x_{6} + x_{7}) = \frac{1}{2} (33 + 33) = 33\)</span>.</p>
</div>
</div>
<div id="diagramma-a-scatola" class="section level3" number="3.9.2">
<h3>
<span class="header-section-number">3.9.2</span> Diagramma a scatola<a class="anchor" aria-label="anchor" href="#diagramma-a-scatola"><i class="fas fa-link"></i></a>
</h3>
<p>Il <em>diagramma a scatola</em> (o box plot) è uno strumento grafico utile al
fine di ottenere informazioni circa la dispersione e l’eventuale
simmetria o asimmetria di una distribuzione. Per costruire un box-plot
si rappresenta sul piano cartesiano un rettangolo (cioè la “scatola”) di
altezza arbitraria la cui base corrisponde alla dist intanza
interquartile (IQR = <span class="math inline">\(q_{0.75} - q_{0.25}\)</span>). La linea interna alla
scatola rappresenta la mediana <span class="math inline">\(q_{0.5}\)</span>. Si tracciano poi ai lati della
scatola due segmenti di retta i cui estremi sono detti “valore
adiacente” inferiore e superiore. Il valore adiacente inferiore è il
valore più piccolo tra le osservazioni che risulta maggiore o uguale al
primo quartile meno la distanza corrispondente a 1.5 volte la distanza
interquartile. Il valore adiacente superiore è il valore più grande tra le osservazioni che risulta minore o uguale a <span class="math inline">\(Q_3+1.5\)</span> IQR. I valori esterni ai valori adiacenti (chiamati <em>valori anomali</em>) vengono rappresentati individualmente nel box-plot per meglio evidenziarne la presenza e la posizione.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="ds4psy_files/figure-html/unnamed-chunk-10-1.png" alt="Box-plot: $M$ è la mediana, $\bar{x}$ è la media aritmetica e IQR è la distanza interquartile (~$Q_3 - Q_1$~)." width="576"><p class="caption">
FIGURA 3.5: Box-plot: <span class="math inline">\(M\)</span> è la mediana, <span class="math inline">\(\bar{x}\)</span> è la media aritmetica e IQR è la distanza interquartile (<sub><span class="math inline">\(Q_3 - Q_1\)</span></sub>).
</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-15" class="exercise"><strong>Esercizio 3.7  </strong></span>Per i dati di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>, si utilizzi un box-plot per rappresentare graficamente la distribuzione dei punteggi BDI-II nel gruppo dei pazienti e nel gruppo di controllo.</p>
<p>Nella figura <a href="ch:freq-distr.html#fig:violin-zetsche">3.6</a> sinistra sono rappresentati i dati grezzi. La linea curva che circonda (simmetricamente) le osservazioni è l’<em>istogramma lisciato</em> (kernel density plot) che abbiamo descritto in precedenza. Nella figura <a href="ch:freq-distr.html#fig:violin-zetsche">3.6</a> destra sono rappresentanti gli stessi dati: il kernel density plot è lo stesso di prima, ma al suo interno è stato collocato un box-plot. Entrambe le rappresentazioni suggeriscono che la distribuzione dei dati è all’incirca simmetrica nel gruppo clinico. Il gruppo di controllo mostra invece un’asimmetria positiva.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bysubj</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">esm_id</span>, <span class="va">group</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>
    bdi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bdi</span><span class="op">)</span>,
    nr_of_episodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">nr_of_episodes</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span>

<span class="va">bysubj</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span>
  <span class="va">bysubj</span><span class="op">$</span><span class="va">group</span>,
  <span class="st">"Controlli\n sani"</span> <span class="op">=</span> <span class="st">"ctl"</span>,
  <span class="st">"Depressione\n maggiore"</span> <span class="op">=</span> <span class="st">"mdd"</span>
<span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_dotplot</span><span class="op">(</span>binaxis <span class="op">=</span> <span class="st">"y"</span>, stackdir <span class="op">=</span> <span class="st">"center"</span>, dotsize <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"BDI-II"</span>
  <span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">bdi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"BDI-II"</span>
  <span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:violin-zetsche"></span>
<img src="ds4psy_files/figure-html/violin-zetsche-1.png" alt="Due versioni di un violin plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019)." width="576"><p class="caption">
FIGURA 3.6: Due versioni di un violin plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019).
</p>
</div>
</div>
</div>
<div id="sina-plot" class="section level3" number="3.9.3">
<h3>
<span class="header-section-number">3.9.3</span> Sina plot<a class="anchor" aria-label="anchor" href="#sina-plot"><i class="fas fa-link"></i></a>
</h3>
<p>Si noti che i box plot non sono necessariamente la rappresentazione migliore della distribuzione di una variabile. Infatti, richiedono la comprensione di concetti complessi (quali i quantili e la differenza interquantile) che non sono necessari se vogliamo presentare in maniera grafica la distribuzione della variabile e, in generale, non sono compresi da un pubblico di non specialisti. Inoltre, i box plot nascondono informazioni che di solito sono cruciali da vedere. È dunque preferibile presentare direttamente i dati.</p>
<p>Nella figura <a href="ch:freq-distr.html#fig:sina-zetsche">3.7</a> viene presentato un cosiddetto “sina plot”. In tale rappresentazione grafica vengono mostrate le singole osservazioni divise in classi. Ai punti viene aggiunto un jitter, così da evitare sovrapposizioni. L’ampiezza del jitter lungo l’asse <span class="math inline">\(x\)</span> è determinata dalla distribuzione della densità dei dati all’interno di ciascuna classe; quindi il grafico mostra lo stesso contorno di un <em>violin plot</em>, ma trasmette informazioni sia sul numero di punti dati, sia sulla distribuzione della densità, sui valori anomali e sulla distribuzione dei dati in un formato molto semplice, comprensibile e sintetico.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-16" class="exercise"><strong>Esercizio 3.8  </strong></span>Si generi un sina plot per i dati della figura <a href="ch:freq-distr.html#fig:violin-zetsche">3.6</a>. Si aggiunga alla figura una rappresentazione della mediana.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">zetsche_summary</span> <span class="op">&lt;-</span> <span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarize</span><span class="op">(</span>
    bdi_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bdi</span><span class="op">)</span>,
    bdi_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bdi</span><span class="op">)</span>,
    bdi_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">bdi</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span>

<span class="va">bysubj</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">bdi</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggforce</span><span class="fu">::</span><span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_sina.html">geom_sina</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">group</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">bdi_median</span>, ymin <span class="op">=</span> <span class="va">bdi_median</span>, ymax <span class="op">=</span> <span class="va">bdi_median</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">zetsche_summary</span>, width <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"BDI-II"</span>,
    color <span class="op">=</span> <span class="st">"Gruppo"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_colour_grey</span><span class="op">(</span>start <span class="op">=</span> <span class="fl">0.7</span>, end <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sina-zetsche"></span>
<img src="ds4psy_files/figure-html/sina-zetsche-1.png" alt="Sina plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019) con l'indicazione della mediana per ciascun gruppo." width="576"><p class="caption">
FIGURA 3.7: Sina plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019) con l’indicazione della mediana per ciascun gruppo.
</p>
</div>
<p>Per un esempio in una recente pubblicazione, possiamo considerare le figure 3 e 6 di <span class="citation">Lazic, Semenova, and Williams (<a href="ch:metropolis.html#ref-lazic2020determining" role="doc-biblioref">2020</a>)</span>.</p>
</div>
</div>
<div id="leccellenza-grafica" class="section level3" number="3.9.4">
<h3>
<span class="header-section-number">3.9.4</span> L’eccellenza grafica<a class="anchor" aria-label="anchor" href="#leccellenza-grafica"><i class="fas fa-link"></i></a>
</h3>
<p>Non c’è un unico modo “corretto” per la rappresentazione grafica dei dati. Ciascuno dei grafici che abbiamo discusso in precedenza ha i suoi pregi e i suoi difetti. Un ricercatore che ha molto influenzato il modo in cui viene realizzata la visualizzazione dei dati scientifici è Edward Tufte, soprannominato dal New York Times il “Leonardo da Vinci dei dati.” Secondo Tufte, “l’eccellenza nella grafica consiste nel comunicare idee complesse in modo chiaro, preciso ed efficiente”. Nella visualizzazione delle informazioni, l’“eccellenza grafica” ha l’obiettivo di comunicare al lettore il maggior numero di idee nella maniera più diretta e semplice possibile. Secondo <span class="citation">Tufte (<a href="ch:metropolis.html#ref-tufte_visual_display" role="doc-biblioref">2001</a>)</span>, le rappresentazioni grafiche dovrebbero:</p>
<ol style="list-style-type: decimal">
<li>mostrare i dati;</li>
<li>indurre l’osservatore a riflettere sulla sostanza piuttosto che
sulla progettazione grafica, o qualcos’altro;</li>
<li>evitare di distorcere quanto i dati stanno comunicando (“integrità
grafica”);</li>
<li>presentare molte informazioni in forma succinta;</li>
<li>rivelare la coerenza tra le molte dimensioni dei dati;</li>
<li>incoraggiare l’osservatore a confrontare differenti sottoinsiemi di dati;</li>
<li>rivelare i dati a diversi livelli di dettaglio, da una visione ampia
alla struttura di base;</li>
<li>servire ad uno scopo preciso (descrizione, esplorazione, o la
risposta a qualche domanda);</li>
<li>essere fortemente integrate con le descrizioni statistiche e verbali
dei dati fornite nel testo.</li>
</ol>
<p>In base a questi principi, figura <a href="ch:freq-distr.html#fig:sina-zetsche">3.7</a> sembra fornire la
rappresentazione migliore dei dati di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="ch:metropolis.html#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>. Il seguente <a href="https://www.biostat.wisc.edu/~kbroman/presentations/graphs2018.pdf">link</a> fornisce diverse interessanti illustrazioni dei principi elencati sopra.</p>
</div>
</div>
<div id="commenti-e-considerazioni-finali-1" class="section level2 unnumbered">
<h2>Commenti e considerazioni finali<a class="anchor" aria-label="anchor" href="#commenti-e-considerazioni-finali-1"><i class="fas fa-link"></i></a>
</h2>
<p>Una distribuzione è una rappresentazione del modo in cui le diverse modalità di una variabile si distribuiscono nelle unità statistiche che compongono il campione o la popolazione oggetto di studio. Il modo più diretto per trasmettere descrivere le proprietà della distribuzione di una variabile discreta è quello di fornire una rappresentazione grafica della distribuzione di frequenza. In seguito vedremo la corrispondente rappresentazione che viene usata nel caso delle variabili continue.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chapter-misurazione.html"><span class="header-section-number">2</span> La misurazione in psicologia</a></div>
<div class="next"><a href="ch:loc-scale.html"><span class="header-section-number">4</span> Indici di posizione e di scala</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ch:freq-distr"><span class="header-section-number">3</span> Variabili e distribuzioni di frequenza</a></li>
<li><a class="nav-link" href="#chapter-descript"><span class="header-section-number">3.1</span> Introduzione all’esplorazione dei dati</a></li>
<li><a class="nav-link" href="#un-excursus-storico"><span class="header-section-number">3.2</span> Un excursus storico</a></li>
<li><a class="nav-link" href="#riassumere-i-dati"><span class="header-section-number">3.3</span> Riassumere i dati</a></li>
<li><a class="nav-link" href="#i-dati-grezzi"><span class="header-section-number">3.4</span> I dati grezzi</a></li>
<li><a class="nav-link" href="#distribuzioni-di-frequenze"><span class="header-section-number">3.5</span> Distribuzioni di frequenze</a></li>
<li><a class="nav-link" href="#istogramma"><span class="header-section-number">3.6</span> Istogramma</a></li>
<li><a class="nav-link" href="#kernel-density-plot"><span class="header-section-number">3.7</span> Kernel density plot</a></li>
<li><a class="nav-link" href="#forma-di-una-distribuzione"><span class="header-section-number">3.8</span> Forma di una distribuzione</a></li>
<li>
<a class="nav-link" href="#indici-di-posizione"><span class="header-section-number">3.9</span> Indici di posizione</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quantili"><span class="header-section-number">3.9.1</span> Quantili</a></li>
<li><a class="nav-link" href="#diagramma-a-scatola"><span class="header-section-number">3.9.2</span> Diagramma a scatola</a></li>
<li><a class="nav-link" href="#sina-plot"><span class="header-section-number">3.9.3</span> Sina plot</a></li>
<li><a class="nav-link" href="#leccellenza-grafica"><span class="header-section-number">3.9.4</span> L’eccellenza grafica</a></li>
</ul>
</li>
<li><a class="nav-link" href="#commenti-e-considerazioni-finali-1">Commenti e considerazioni finali</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science per psicologi</strong>" was written by Corrado Caudek. It was last built on 2022-02-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
